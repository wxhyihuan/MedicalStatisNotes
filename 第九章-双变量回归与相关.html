<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 第九章 双变量回归与相关 | MedicalStatisNotes.utf8</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content=" 第九章 双变量回归与相关 | MedicalStatisNotes.utf8" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 第九章 双变量回归与相关 | MedicalStatisNotes.utf8" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="第八章-秩转换的非参数检验.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://wxhyihuan.github.io/">医学统计学笔记与R语言</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> 简介与传送门</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#简介"><i class="fa fa-check"></i><b>1.1</b> 简介</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#软件准备"><i class="fa fa-check"></i><b>1.1.1</b> 软件准备</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#传送门"><i class="fa fa-check"></i><b>1.2</b> 传送门</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#致谢"><i class="fa fa-check"></i><b>1.3</b> 致谢</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#声明"><i class="fa fa-check"></i><b>1.4</b> 声明</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html"><i class="fa fa-check"></i><b>2</b> 第二章 计量资料的统计描述</a><ul>
<li class="chapter" data-level="2.1" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#描述统计"><i class="fa fa-check"></i><b>2.1</b> 描述统计</a></li>
<li class="chapter" data-level="2.2" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#测试数据"><i class="fa fa-check"></i><b>2.2</b> 测试数据</a></li>
<li class="chapter" data-level="2.3" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#数据输入和频率统计"><i class="fa fa-check"></i><b>2.3</b> 数据输入和频率统计</a><ul>
<li class="chapter" data-level="2.3.1" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#读取数据并将数据转换成单列形式"><i class="fa fa-check"></i><b>2.3.1</b> 读取数据，并将数据转换成单列形式</a></li>
<li class="chapter" data-level="2.3.2" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#计算极差-maxminrange"><i class="fa fa-check"></i><b>2.3.2</b> 计算极差, max()/min()/range()</a></li>
<li class="chapter" data-level="2.3.3" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#确定组段数和组距"><i class="fa fa-check"></i><b>2.3.3</b> 确定组段数和组距</a></li>
<li class="chapter" data-level="2.3.4" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#计算频数分布"><i class="fa fa-check"></i><b>2.3.4</b> 计算频数分布</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#描述性统计的度量"><i class="fa fa-check"></i><b>2.4</b> 描述性统计的度量</a><ul>
<li class="chapter" data-level="2.4.1" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#算术平均值"><i class="fa fa-check"></i><b>2.4.1</b> 算术平均值</a></li>
<li class="chapter" data-level="2.4.2" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#几何平均值"><i class="fa fa-check"></i><b>2.4.2</b> 几何平均值</a></li>
<li class="chapter" data-level="2.4.3" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#中位数与百分位数"><i class="fa fa-check"></i><b>2.4.3</b> 中位数与百分位数</a></li>
<li class="chapter" data-level="2.4.4" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#极差"><i class="fa fa-check"></i><b>2.4.4</b> 极差</a></li>
<li class="chapter" data-level="2.4.5" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#四分位间距"><i class="fa fa-check"></i><b>2.4.5</b> 四分位间距</a></li>
<li class="chapter" data-level="2.4.6" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#方差与标准差"><i class="fa fa-check"></i><b>2.4.6</b> 方差与标准差</a></li>
<li class="chapter" data-level="2.4.7" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#变异系数"><i class="fa fa-check"></i><b>2.4.7</b> 变异系数</a></li>
<li class="chapter" data-level="2.4.8" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#其他的描述统计"><i class="fa fa-check"></i><b>2.4.8</b> 其他的描述统计</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#正态分布和标准正态分布"><i class="fa fa-check"></i><b>2.5</b> 正态分布和标准正态分布</a><ul>
<li class="chapter" data-level="2.5.1" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#概率密度函数dnorm"><i class="fa fa-check"></i><b>2.5.1</b> 概率密度函数dnorm()</a></li>
<li class="chapter" data-level="2.5.2" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#概率累积分布函数pnorm"><i class="fa fa-check"></i><b>2.5.2</b> 概率累积分布函数pnorm()</a></li>
<li class="chapter" data-level="2.5.3" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#正态分位函数qnorm"><i class="fa fa-check"></i><b>2.5.3</b> 正态分位函数qnorm()</a></li>
<li class="chapter" data-level="2.5.4" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#生成正态分布函数rnorm"><i class="fa fa-check"></i><b>2.5.4</b> 生成正态分布函数rnorm()</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#正态分布检验"><i class="fa fa-check"></i><b>2.6</b> 正态分布检验</a><ul>
<li class="chapter" data-level="2.6.1" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#直方图"><i class="fa fa-check"></i><b>2.6.1</b> 直方图</a></li>
<li class="chapter" data-level="2.6.2" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#概率密度图"><i class="fa fa-check"></i><b>2.6.2</b> 概率密度图</a></li>
<li class="chapter" data-level="2.6.3" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#qq-plot"><i class="fa fa-check"></i><b>2.6.3</b> QQ-plot</a></li>
<li class="chapter" data-level="2.6.4" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#正态检验"><i class="fa fa-check"></i><b>2.6.4</b> 正态检验</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html"><i class="fa fa-check"></i><b>3</b> 第三章 总体均数的估计与假设检验</a><ul>
<li class="chapter" data-level="3.1" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#推论统计"><i class="fa fa-check"></i><b>3.1</b> 推论统计</a><ul>
<li class="chapter" data-level="3.1.1" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#参数估计与假设检验"><i class="fa fa-check"></i><b>3.1.1</b> 参数估计与假设检验</a></li>
<li class="chapter" data-level="3.1.2" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#统计量与标准误"><i class="fa fa-check"></i><b>3.1.2</b> 统计量与标准误</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#t-分布"><i class="fa fa-check"></i><b>3.2</b> <em>t</em> 分布</a><ul>
<li class="chapter" data-level="3.2.1" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#概率密度函数dt"><i class="fa fa-check"></i><b>3.2.1</b> 概率密度函数dt()</a></li>
<li class="chapter" data-level="3.2.2" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#概率累积分布函数pt"><i class="fa fa-check"></i><b>3.2.2</b> 概率累积分布函数pt()</a></li>
<li class="chapter" data-level="3.2.3" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#求置信区间的qt"><i class="fa fa-check"></i><b>3.2.3</b> 求置信区间的qt()</a></li>
<li class="chapter" data-level="3.2.4" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#指定t分布函数rt"><i class="fa fa-check"></i><b>3.2.4</b> 指定t分布函数rt()</a></li>
<li class="chapter" data-level="3.2.5" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#参数估计"><i class="fa fa-check"></i><b>3.2.5</b> 参数估计</a></li>
<li class="chapter" data-level="3.2.6" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#假设检验"><i class="fa fa-check"></i><b>3.2.6</b> 假设检验</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#t-检验的分类及应用"><i class="fa fa-check"></i><b>3.3</b> <em>t</em> 检验的分类及应用</a><ul>
<li class="chapter" data-level="3.3.1" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#t检验与z检验"><i class="fa fa-check"></i><b>3.3.1</b> <em>t</em>检验与Z检验</a></li>
<li class="chapter" data-level="3.3.2" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#单样本t检验"><i class="fa fa-check"></i><b>3.3.2</b> 单样本<em>t</em>检验</a></li>
<li class="chapter" data-level="3.3.3" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#配对样本t检验"><i class="fa fa-check"></i><b>3.3.3</b> 配对样本<em>t</em>检验</a></li>
<li class="chapter" data-level="3.3.4" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#两种独立样本t检验"><i class="fa fa-check"></i><b>3.3.4</b> 两种独立样本t检验</a></li>
<li class="chapter" data-level="3.3.5" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#两样本方差齐性检验"><i class="fa fa-check"></i><b>3.3.5</b> 两样本方差齐性检验</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#变量转换"><i class="fa fa-check"></i><b>3.4</b> 变量转换</a><ul>
<li class="chapter" data-level="3.4.1" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#对数变换"><i class="fa fa-check"></i><b>3.4.1</b> 对数变换</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html"><i class="fa fa-check"></i><b>4</b> 第四章 多个样本均数比较的方差分析</a><ul>
<li class="chapter" data-level="4.1" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#f分布"><i class="fa fa-check"></i><b>4.1</b> <em>F</em>分布</a></li>
<li class="chapter" data-level="4.2" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#f检验的分类原理及应用"><i class="fa fa-check"></i><b>4.2</b> <em>F</em>检验的分类、原理及应用</a><ul>
<li class="chapter" data-level="4.2.1" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#分类"><i class="fa fa-check"></i><b>4.2.1</b> 分类</a></li>
<li class="chapter" data-level="4.2.2" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#原理"><i class="fa fa-check"></i><b>4.2.2</b> 原理</a></li>
<li class="chapter" data-level="4.2.3" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#单因子方差分析"><i class="fa fa-check"></i><b>4.2.3</b> 单因子方差分析</a></li>
<li class="chapter" data-level="4.2.4" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#双因子方差分析"><i class="fa fa-check"></i><b>4.2.4</b> 双因子方差分析</a></li>
<li class="chapter" data-level="4.2.5" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#拉丁方设计资料的方差分析"><i class="fa fa-check"></i><b>4.2.5</b> 拉丁方设计资料的方差分析</a></li>
<li class="chapter" data-level="4.2.6" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#两阶段交叉设计资料的方差分析"><i class="fa fa-check"></i><b>4.2.6</b> 两阶段交叉设计资料的方差分析</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#方差分析的诊断图"><i class="fa fa-check"></i><b>4.3</b> 方差分析的诊断图</a></li>
<li class="chapter" data-level="4.4" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#多个样本均数间的多重比较"><i class="fa fa-check"></i><b>4.4</b> 多个样本均数间的多重比较</a></li>
<li class="chapter" data-level="4.5" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#多样本方差齐性检验"><i class="fa fa-check"></i><b>4.5</b> 多样本方差齐性检验</a><ul>
<li class="chapter" data-level="4.5.1" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#bartletts-检验"><i class="fa fa-check"></i><b>4.5.1</b> Bartlett’s 检验</a></li>
<li class="chapter" data-level="4.5.2" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#levenes-检验"><i class="fa fa-check"></i><b>4.5.2</b> Levene’s 检验</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html"><i class="fa fa-check"></i><b>5</b> 第五章 计数资料的统计描述</a><ul>
<li class="chapter" data-level="5.1" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#常用相对数"><i class="fa fa-check"></i><b>5.1</b> 常用相对数</a><ul>
<li class="chapter" data-level="5.1.1" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#强度相对数"><i class="fa fa-check"></i><b>5.1.1</b> 强度相对数</a></li>
<li class="chapter" data-level="5.1.2" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#结构相对数"><i class="fa fa-check"></i><b>5.1.2</b> 结构相对数</a></li>
<li class="chapter" data-level="5.1.3" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#相对比"><i class="fa fa-check"></i><b>5.1.3</b> 相对比</a></li>
<li class="chapter" data-level="5.1.4" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#应用相对数的注意点"><i class="fa fa-check"></i><b>5.1.4</b> 应用相对数的注意点</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#率的标准化"><i class="fa fa-check"></i><b>5.2</b> 率的标准化</a><ul>
<li class="chapter" data-level="5.2.1" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#标准化率的计算"><i class="fa fa-check"></i><b>5.2.1</b> 标准化率的计算</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#动态数列及其指标分析"><i class="fa fa-check"></i><b>5.3</b> 动态数列及其指标分析</a><ul>
<li class="chapter" data-level="5.3.1" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#绝对增长量"><i class="fa fa-check"></i><b>5.3.1</b> 绝对增长量</a></li>
<li class="chapter" data-level="5.3.2" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#发展速度与增长速度"><i class="fa fa-check"></i><b>5.3.2</b> 发展速度与增长速度</a></li>
<li class="chapter" data-level="5.3.3" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#平均发展速度与平均增长速度"><i class="fa fa-check"></i><b>5.3.3</b> 平均发展速度与平均增长速度</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html"><i class="fa fa-check"></i><b>6</b> 第六章 计数资料的统计描述</a><ul>
<li class="chapter" data-level="6.1" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#二项分布"><i class="fa fa-check"></i><b>6.1</b> 二项分布</a><ul>
<li class="chapter" data-level="6.1.1" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#二项分布的性质"><i class="fa fa-check"></i><b>6.1.1</b> 二项分布的性质</a></li>
<li class="chapter" data-level="6.1.2" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#二项分布的应用"><i class="fa fa-check"></i><b>6.1.2</b> 二项分布的应用</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#泊松分布"><i class="fa fa-check"></i><b>6.2</b> 泊松分布</a><ul>
<li class="chapter" data-level="6.2.1" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#泊松分布的性质"><i class="fa fa-check"></i><b>6.2.1</b> 泊松分布的性质</a></li>
<li class="chapter" data-level="6.2.2" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#泊松分布的应用"><i class="fa fa-check"></i><b>6.2.2</b> 泊松分布的应用</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#负二项分布"><i class="fa fa-check"></i><b>6.3</b> 负二项分布</a><ul>
<li class="chapter" data-level="6.3.1" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#负二项分布的性质"><i class="fa fa-check"></i><b>6.3.1</b> 负二项分布的性质</a></li>
<li class="chapter" data-level="6.3.2" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#负二项分布的参数估计"><i class="fa fa-check"></i><b>6.3.2</b> 负二项分布的参数估计</a></li>
<li class="chapter" data-level="6.3.3" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#负二项分布的应用"><i class="fa fa-check"></i><b>6.3.3</b> 负二项分布的应用</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html"><i class="fa fa-check"></i><b>7</b> 第七章 <span class="math inline">\(\chi^2\)</span>检验</a><ul>
<li class="chapter" data-level="7.1" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#卡方分布"><i class="fa fa-check"></i><b>7.1</b> 卡方分布</a><ul>
<li class="chapter" data-level="7.1.1" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#概率密度函数"><i class="fa fa-check"></i><b>7.1.1</b> 概率密度函数</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#卡方检验"><i class="fa fa-check"></i><b>7.2</b> 卡方检验</a><ul>
<li class="chapter" data-level="7.2.1" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#卡方独立性检验的基本思想"><i class="fa fa-check"></i><b>7.2.1</b> 卡方独立性检验的基本思想</a></li>
<li class="chapter" data-level="7.2.2" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#四格资料表的卡方检验"><i class="fa fa-check"></i><b>7.2.2</b> 四格资料表的卡方检验</a></li>
<li class="chapter" data-level="7.2.3" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#配对的四格资料表的卡方检验"><i class="fa fa-check"></i><b>7.2.3</b> 配对的四格资料表的卡方检验</a></li>
<li class="chapter" data-level="7.2.4" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#四格资料表的fisher确切概率法"><i class="fa fa-check"></i><b>7.2.4</b> 四格资料表的Fisher确切概率法</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#行列资料表的卡方检验"><i class="fa fa-check"></i><b>7.3</b> 行列资料表的卡方检验</a><ul>
<li class="chapter" data-level="7.3.1" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#多个样本率的比较r-times-2表"><i class="fa fa-check"></i><b>7.3.1</b> 多个样本率的比较(<span class="math inline">\(R \times 2\)</span>表)</a></li>
<li class="chapter" data-level="7.3.2" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#样本构成比的比较2-times-c表"><i class="fa fa-check"></i><b>7.3.2</b> 样本构成比的比较(<span class="math inline">\(2 \times C\)</span>表)</a></li>
<li class="chapter" data-level="7.3.3" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#双向无序分组资料的关联性检验"><i class="fa fa-check"></i><b>7.3.3</b> 双向无序分组资料的关联性检验</a></li>
<li class="chapter" data-level="7.3.4" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#双向有序分组资料的线性趋势检验"><i class="fa fa-check"></i><b>7.3.4</b> 双向有序分组资料的线性趋势检验</a></li>
<li class="chapter" data-level="7.3.5" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#卡方检验的注意事项与选择思路"><i class="fa fa-check"></i><b>7.3.5</b> 卡方检验的注意事项与选择思路</a></li>
<li class="chapter" data-level="7.3.6" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#多个样本率的多重比较"><i class="fa fa-check"></i><b>7.3.6</b> 多个样本率的多重比较</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#cochran-mantel-haenszel卡方统计量检验"><i class="fa fa-check"></i><b>7.4</b> Cochran-Mantel-Haenszel卡方统计量检验</a></li>
<li class="chapter" data-level="7.5" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#频数分布的拟合优度检验"><i class="fa fa-check"></i><b>7.5</b> 频数分布的拟合优度检验</a><ul>
<li class="chapter" data-level="7.5.1" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#观察数据的无分布预期"><i class="fa fa-check"></i><b>7.5.1</b> 观察数据的无分布预期</a></li>
<li class="chapter" data-level="7.5.2" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#观察数据的有预期分布"><i class="fa fa-check"></i><b>7.5.2</b> 观察数据的有预期分布</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html"><i class="fa fa-check"></i><b>8</b> 第八章 秩转换的非参数检验</a><ul>
<li class="chapter" data-level="8.1" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html#wilcoxon符号秩检验"><i class="fa fa-check"></i><b>8.1</b> Wilcoxon符号秩检验</a><ul>
<li class="chapter" data-level="8.1.1" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html#wilcoxon符号秩检验的原理与过程"><i class="fa fa-check"></i><b>8.1.1</b> Wilcoxon符号秩检验的原理与过程</a></li>
<li class="chapter" data-level="8.1.2" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html#单组样本与总体的中位数的wilcoxon符号秩检验"><i class="fa fa-check"></i><b>8.1.2</b> 单组样本与总体的中位数的Wilcoxon符号秩检验</a></li>
<li class="chapter" data-level="8.1.3" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html#配对样本差值的中位数和0比较"><i class="fa fa-check"></i><b>8.1.3</b> 配对样本差值的中位数和0比较</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html#wilcoxon秩和检验"><i class="fa fa-check"></i><b>8.2</b> Wilcoxon秩和检验</a><ul>
<li class="chapter" data-level="8.2.1" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html#wilcoxon秩和检验的原理与过程"><i class="fa fa-check"></i><b>8.2.1</b> Wilcoxon秩和检验的原理与过程</a></li>
<li class="chapter" data-level="8.2.2" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html#连续型资料的两样本比较"><i class="fa fa-check"></i><b>8.2.2</b> 连续型资料的两样本比较</a></li>
<li class="chapter" data-level="8.2.3" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html#非连续型资料的两样本比较"><i class="fa fa-check"></i><b>8.2.3</b> 非连续型资料的两样本比较</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html#完全随即设计多个样本比较的kruskal-wallis-h-检验"><i class="fa fa-check"></i><b>8.3</b> 完全随即设计多个样本比较的Kruskal-Wallis H 检验</a><ul>
<li class="chapter" data-level="8.3.1" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html#原始数据的多个样本比较"><i class="fa fa-check"></i><b>8.3.1</b> 原始数据的多个样本比较</a></li>
<li class="chapter" data-level="8.3.2" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html#频数表资料和登记资料的多个样本比较"><i class="fa fa-check"></i><b>8.3.2</b> 频数表资料和登记资料的多个样本比较</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html#多个独立样本两两比较的nemenyi法检验"><i class="fa fa-check"></i><b>8.4</b> 多个独立样本两两比较的Nemenyi法检验</a></li>
<li class="chapter" data-level="8.5" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html#随机区组设计多个相关样本的friedman-m-检验"><i class="fa fa-check"></i><b>8.5</b> 随机区组设计多个相关样本的Friedman M 检验</a><ul>
<li class="chapter" data-level="8.5.1" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html#多个相关样本的两两比较"><i class="fa fa-check"></i><b>8.5.1</b> 多个相关样本的两两比较</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="第九章-双变量回归与相关.html"><a href="第九章-双变量回归与相关.html"><i class="fa fa-check"></i><b>9</b> 第九章 双变量回归与相关</a><ul>
<li class="chapter" data-level="9.1" data-path="第九章-双变量回归与相关.html"><a href="第九章-双变量回归与相关.html#直线回归"><i class="fa fa-check"></i><b>9.1</b> 直线回归</a></li>
<li class="chapter" data-level="9.2" data-path="第九章-双变量回归与相关.html"><a href="第九章-双变量回归与相关.html#直线回归中的统计推断"><i class="fa fa-check"></i><b>9.2</b> 直线回归中的统计推断</a><ul>
<li class="chapter" data-level="9.2.1" data-path="第九章-双变量回归与相关.html"><a href="第九章-双变量回归与相关.html#方差分析"><i class="fa fa-check"></i><b>9.2.1</b> 方差分析</a></li>
<li class="chapter" data-level="9.2.2" data-path="第九章-双变量回归与相关.html"><a href="第九章-双变量回归与相关.html#t检验-1"><i class="fa fa-check"></i><b>9.2.2</b> t检验</a></li>
<li class="chapter" data-level="9.2.3" data-path="第九章-双变量回归与相关.html"><a href="第九章-双变量回归与相关.html#总体回归系数β的可信区间"><i class="fa fa-check"></i><b>9.2.3</b> 总体回归系数β的可信区间</a></li>
<li class="chapter" data-level="9.2.4" data-path="第九章-双变量回归与相关.html"><a href="第九章-双变量回归与相关.html#利用回归方程进行估计和预测"><i class="fa fa-check"></i><b>9.2.4</b> 利用回归方程进行估计和预测</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="第九章-双变量回归与相关" class="section level1">
<h1><span class="header-section-number"> </span> 第九章 双变量回归与相关</h1>
<p>日期: 2020-12-05
作者：wxhyihuan</p>
<p>前面几章讨论了单变量(Univariate)计量资料的统计分析方法，着重于描述某一变量的统计特征或比较该变
量的组间差别。但是在大量的医学科研与实践中，经常会遇到对两个变量(Bivariate)之间关系的研究，例如糖尿病患者
的血糖与其胰岛素水平的关系如何，某人群年龄的变化与其收缩压的关系怎样等，此时常用线性回归(Linear Regression)与相关分(Correlation)
析。本章介绍两个数值变量呈直线或曲线关系的分析方法，及可用于有序分类变量(等级变量)的秩相关
的非参数统计方法。</p>
<div id="直线回归" class="section level2">
<h2><span class="header-section-number">9.1</span> 直线回归</h2>
<p>在定量描述Y与X数量上的依存关系时，将X称为自变量(Independent variable)；Y称为应变量(Dependent variable)。
当Y随X变化而变化且呈直线趋势，但并非自变量全部都恰好全都在这个直线上(即与两变量间严格的直线函数关系不 同)，
称为直线回归(Linear regression)或简单回归(Simple regression)，用以下直线回归方程(Linear regression equation)
表示：
<span class="math display">\[ \hat {Y} = a+bX \tag{9-1}\]</span></p>
<p>方程<span class="math inline">\((9-1)\)</span> 被称为经验回归方程或样本回归方程，它是对X、Y两变个量总体间线性关系的一个估计。
根据散点图可以假定，对于X各个取值，相应Y的总体均数<span class="math inline">\(\mu_{Y|X}\)</span>在一条直线上，表示为：</p>
<p><span class="math display">\[\mu_{Y|X}= \alpha +\beta X +\epsilon_i\]</span></p>
<p><span class="math inline">\(\epsilon_i\)</span>被称为残差，即。除了图中所示两变量呈直线关系外，一般还假定每个X对应Y的总体为正态分布，各个正态分布的总
体方差相等且各次观测相互独立。这样，公式(9-1)中<span class="math inline">\(\bar{Y}\)</span>的实际上是X所对应Y的总体均数
<span class="math inline">\(\mu_{Y|X}\)</span>的一个样 本估计值，称为回归方程的预测值(Predicted value)，而a，b分别为<span class="math inline">\(\alpha\)</span>和
<span class="math inline">\(\beta\)</span>的样本估计。其中a称为常数项 (Constant term)，是回归直线在Y轴上的截距(Intercept)，
其统计意义是当X取值为0时相应Y的均数估计值；b称为回归系数(Coefficient of regression)，
是直线的斜率(Slope)，其统计意义是当X变化一个单位时Y的平均改变的估计值，并且：
- b&gt;0时直线从左下方走向右上方，Y随X的增大而增大;
- b&lt;0时直线从左上方走向右下方，Y随X的增大而减小;
- b=0时直线与X轴平行，Y与X无直线关系。</p>
<p>如果能够从样本数据中求得a、b的数值，回归方程即可唯一确定。求解 a、b实际上就是 怎样“合理地”找到一条能最好地代表数据点分布趋势的直线。将实测值Y与假定回归线上的估计值$ {Y}<span class="math inline">\(的纵向距 离\)</span>Y-{Y}$称为残差(Residual)或剩余值，一个自然的想法就是各点残差要尽可能的小。由于考虑所有点之残差有 正有负，所以通常取各点残差平方和最小的直线为所求，这就是所谓“最小二乘方拟合”(Least squares fitting,LSF)原则。 在一定假没条件下，如此得到的回归系数最为理想。按照这一原则，数学上可以容易地得到残差平方和最小计算公式为:
<span class="math display">\[\sum_{i=1}^n\epsilon_i^2=\sum_{i=1}^n(\hat Y_i-\alpha-\beta x_i)^2\]</span>
此时对应的斜率b(回归系数)值为：
<span class="math display">\[b=\frac{\sum_{i=1}^n(Y-\bar Y)(X-\bar X)}{\sum_{i=1}^n(X-\bar X)^2}\]</span>
此时对应的截距a(常数项)值为：
<span class="math inline">\(a=\bar Y-b\bar X\)</span></p>
<p>R种的直线回归方程的主要工具是<a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/lm">lm()工具</a>，这里使用《医学统计学》中的案例9-1的数据来估计尿肌酐含量与年龄的直线回归方程。</p>
<table class=" lightable-paper lightable-striped lightable-classic-2" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto; font-family: "Arial Narrow", "Source Sans Pro", sans-serif; margin-left: auto; margin-right: auto;'>
<caption>
<span id="tab:tablable">Table 9.1: </span>8名正常儿童的年龄X(岁)与尿肌酐含量Y*(mmol/24h)
</caption>
<thead>
<tr>
<th style="text-align:center;">
编号
</th>
<th style="text-align:center;">
年龄(X)
</th>
<th style="text-align:center;">
尿肌酐(Y)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
13
</td>
<td style="text-align:center;">
3.54
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
11
</td>
<td style="text-align:center;">
3.01
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
9
</td>
<td style="text-align:center;">
3.09
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
2.48
</td>
</tr>
<tr>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
2.56
</td>
</tr>
<tr>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
3.36
</td>
</tr>
<tr>
<td style="text-align:center;">
7
</td>
<td style="text-align:center;">
12
</td>
<td style="text-align:center;">
3.18
</td>
</tr>
<tr>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
7
</td>
<td style="text-align:center;">
2.65
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="第九章-双变量回归与相关.html#cb95-1"></a><span class="kw">library</span>(<span class="st">&quot;dplyr&quot;</span>)</span>
<span id="cb95-2"><a href="第九章-双变量回归与相关.html#cb95-2"></a><span class="kw">library</span>(<span class="st">&quot;kableExtra&quot;</span>) </span>
<span id="cb95-3"><a href="第九章-双变量回归与相关.html#cb95-3"></a><span class="kw">library</span>(<span class="st">&quot;haven&quot;</span>)</span>
<span id="cb95-4"><a href="第九章-双变量回归与相关.html#cb95-4"></a><span class="co">#使用haven包种的read_sav()的函数读取数据</span></span>
<span id="cb95-5"><a href="第九章-双变量回归与相关.html#cb95-5"></a>Creatinine_df&lt;-<span class="kw">read_sav</span>(<span class="dt">file=</span><span class="st">&quot;ExampleData/SavData4MedSta/Exam09-01.sav&quot;</span>)</span>
<span id="cb95-6"><a href="第九章-双变量回归与相关.html#cb95-6"></a><span class="kw">colnames</span>(Creatinine_df)&lt;-<span class="kw">c</span>(<span class="st">&quot;No.&quot;</span>,<span class="st">&quot;Age&quot;</span>,<span class="st">&quot;CreatiC&quot;</span>)</span>
<span id="cb95-7"><a href="第九章-双变量回归与相关.html#cb95-7"></a></span>
<span id="cb95-8"><a href="第九章-双变量回归与相关.html#cb95-8"></a>lmod&lt;-<span class="kw">lm</span>(Creatinine_df<span class="op">$</span>CreatiC<span class="op">~</span>Creatinine_df<span class="op">$</span>Age)</span>
<span id="cb95-9"><a href="第九章-双变量回归与相关.html#cb95-9"></a><span class="co"># Call:</span></span>
<span id="cb95-10"><a href="第九章-双变量回归与相关.html#cb95-10"></a><span class="co"># lm(formula = Creatinine_df$CreatiC ~ Creatinine_df$Age)</span></span>
<span id="cb95-11"><a href="第九章-双变量回归与相关.html#cb95-11"></a><span class="co"># </span></span>
<span id="cb95-12"><a href="第九章-双变量回归与相关.html#cb95-12"></a><span class="co"># Coefficients:</span></span>
<span id="cb95-13"><a href="第九章-双变量回归与相关.html#cb95-13"></a><span class="co">#       (Intercept)  Creatinine_df$Age  </span></span>
<span id="cb95-14"><a href="第九章-双变量回归与相关.html#cb95-14"></a><span class="co">#            1.6617             0.1392  </span></span>
<span id="cb95-15"><a href="第九章-双变量回归与相关.html#cb95-15"></a></span>
<span id="cb95-16"><a href="第九章-双变量回归与相关.html#cb95-16"></a>lmod_summary &lt;-<span class="st"> </span><span class="kw">summary</span>(lmod)</span>
<span id="cb95-17"><a href="第九章-双变量回归与相关.html#cb95-17"></a><span class="co"># Call:</span></span>
<span id="cb95-18"><a href="第九章-双变量回归与相关.html#cb95-18"></a><span class="co"># lm(formula = Creatinine_df$CreatiC ~ Creatinine_df$Age)</span></span>
<span id="cb95-19"><a href="第九章-双变量回归与相关.html#cb95-19"></a></span>
<span id="cb95-20"><a href="第九章-双变量回归与相关.html#cb95-20"></a><span class="co"># Residuals:</span></span>
<span id="cb95-21"><a href="第九章-双变量回归与相关.html#cb95-21"></a><span class="co">#      Min       1Q   Median       3Q      Max </span></span>
<span id="cb95-22"><a href="第九章-双变量回归与相关.html#cb95-22"></a><span class="co"># -0.21500 -0.15937 -0.00125  0.09583  0.30667 </span></span>
<span id="cb95-23"><a href="第九章-双变量回归与相关.html#cb95-23"></a><span class="co"># </span></span>
<span id="cb95-24"><a href="第九章-双变量回归与相关.html#cb95-24"></a><span class="co"># Coefficients:</span></span>
<span id="cb95-25"><a href="第九章-双变量回归与相关.html#cb95-25"></a><span class="co">#                   Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span id="cb95-26"><a href="第九章-双变量回归与相关.html#cb95-26"></a><span class="co"># (Intercept)        1.66167    0.29700   5.595  0.00139 **</span></span>
<span id="cb95-27"><a href="第九章-双变量回归与相关.html#cb95-27"></a><span class="co"># Creatinine_df$Age  0.13917    0.03039   4.579  0.00377 **</span></span>
<span id="cb95-28"><a href="第九章-双变量回归与相关.html#cb95-28"></a><span class="co"># ---</span></span>
<span id="cb95-29"><a href="第九章-双变量回归与相关.html#cb95-29"></a><span class="co"># Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span>
<span id="cb95-30"><a href="第九章-双变量回归与相关.html#cb95-30"></a><span class="co"># </span></span>
<span id="cb95-31"><a href="第九章-双变量回归与相关.html#cb95-31"></a><span class="co"># Residual standard error: 0.197 on 6 degrees of freedom</span></span>
<span id="cb95-32"><a href="第九章-双变量回归与相关.html#cb95-32"></a><span class="co"># Multiple R-squared:  0.7775,  Adjusted R-squared:  0.7404 </span></span>
<span id="cb95-33"><a href="第九章-双变量回归与相关.html#cb95-33"></a><span class="co"># F-statistic: 20.97 on 1 and 6 DF,  p-value: 0.003774</span></span>
<span id="cb95-34"><a href="第九章-双变量回归与相关.html#cb95-34"></a><span class="kw">pf</span>(lmod_summary<span class="op">$</span>fstatistic[<span class="dv">1</span>],lmod_summary<span class="op">$</span>fstatistic[<span class="dv">2</span>],lmod_summary<span class="op">$</span>fstatistic[<span class="dv">3</span>],<span class="dt">lower.tail =</span> F)</span></code></pre></div>
<p>根据计算结果，常项数a=1.6617，回归系数b=0.1392，因此<span class="math inline">\(\hat Y=1.6617+0.1392X\)</span>。</p>
</div>
<div id="直线回归中的统计推断" class="section level2">
<h2><span class="header-section-number">9.2</span> 直线回归中的统计推断</h2>
<p>建立样本直线回归方程，只是完成了统计分析中两变量关系的统计描述，研究者还必须回答它所来自 总体的直线回归关系是否确实存在，即是否对总体有β≠0? 当无论X如何取值，<span class="math inline">\(\mu_{Y|X}\)</span> 总在一条 水平线上，即β=0，总体直线回归方程并不成立，意即 Y与X无直线关系，此时<span class="math inline">\(\mu_{Y|X}\)</span>。然而在一次随机 抽样中，如果所得样本为实心圆点所示，则会得到一个并不等于0的样本回归系数b。b与0相差到多大可以认为具有统计学意义？一般可以用用方差分析或与其等价的t检验来回答这一问题。</p>
<div id="方差分析" class="section level3">
<h3><span class="header-section-number">9.2.1</span> 方差分析</h3>
<p>将应变量Y的离均差平方和(<span class="math inline">\(SS_{tol}\)</span>)分解为估计值的离均差方和(<span class="math inline">\(SS_{reg}\)</span>)与残差平方和<span class="math inline">\(SS_{res}\)</span>，即<span class="math inline">\(SS_{tol}=SS_{reg}+SS_{res}\)</span>：
<span class="math display">\[\sum{(Y-\bar Y)^2}=\sum{(\hat Y-\bar Y)^2}+\sum{(Y-\hat Y)^2}\]</span>
<span class="math inline">\(SS_{tol}，SS_{reg}，SS_{res}\)</span>各自的自由度<span class="math inline">\(v\)</span>，并有：
<span class="math display">\[v_{tol}=v_{reg}+v_{res}=n-1，v_{reg}=1，v_{res}=n-2\]</span></p>
<p>根据方差分析，计算F值计算公式为：
<span class="math display">\[F=\frac{SS_{reg}/v_{res}}{SS_{res}/v_{res}}=\frac{MS_{reg}}{MS_{res}}，v_{reg}=1，v_{res}=n-2\]</span></p>
<p>在计算<span class="math inline">\(SS_{reg}\)</span>计算的简化公式为：
<span class="math display">\[SS_{reg}=b^2*l_{XX}=b^2*(\sum X^2-(\sum X)^2/n)\]</span></p>
</div>
<div id="t检验-1" class="section level3">
<h3><span class="header-section-number">9.2.2</span> t检验</h3>
<p>对β=0这一假设是否进行t检验：</p>
<p><span class="math display">\[\begin{aligned}
t &amp;= \frac{b-0}{S_b}\\
S_b &amp;= \frac{S_{Y|X}}{\sqrt{l_{XX}}}\\
S_{Y|X} &amp;=\sqrt{\frac{SS_{res}}{n-2}}
 \end{aligned}\]</span>
公式中的<span class="math inline">\(S_b\)</span>为样本回归系数标准误，<span class="math inline">\(S_{Y|X}\)</span>为回归的剩余标准差(Standed deviation of residuals)。</p>
</div>
<div id="总体回归系数β的可信区间" class="section level3">
<h3><span class="header-section-number">9.2.3</span> 总体回归系数β的可信区间</h3>
<p>利用对回归系数的t检验，可以的到β的1-α的可信区间为：
<span class="math display">\[b ± S_b*t_{\alpha/2,v}\]</span></p>
<p>根据计算结果，β的95%可信区间为(0.06480131,0.213532)，要注意的是，此区间不包含0值！</p>
</div>
<div id="利用回归方程进行估计和预测" class="section level3">
<h3><span class="header-section-number">9.2.4</span> 利用回归方程进行估计和预测</h3>
<div id="总体均数mu_yx的可信区间" class="section level4">
<h4><span class="header-section-number">9.2.4.1</span> 总体均数<span class="math inline">\(\mu_{Y|X}\)</span>的可信区间</h4>
<p>给定X的数值<span class="math inline">\(X_0\)</span>，由样本回归方程计算出的<span class="math inline">\(\hat Y_0\)</span>只是相应<strong>总体均数</strong><span class="math inline">\(\mu_{Y|X_0}\)</span>的一个点估计。由于
存在抽样误差，<span class="math inline">\(\hat Y_0\)</span>会因样本而不同。反应其抽样误差大小的标准误的计算公式为：
<span class="math display">\[S_{\hat Y_0}=S_{Y|X}\sqrt{1/n+\frac{(X_0-\bar X)^2}{\sum(X-\bar X)^2}}\]</span>
<span class="math inline">\(\hat Y_0\)</span>的标准误与回归的剩余标准差<span class="math inline">\(S_{Y|X}\)</span>成正比。当<span class="math inline">\(X=X_0\)</span>时，达到其最小值<span class="math inline">\(S_{Y|X}/\sqrt{n}\)</span>，相差越大，则<span class="math inline">\(S_{\hat Y_0}\)</span>越大。</p>
<p>给定<span class="math inline">\(X=X_0\)</span>时，总体均数<span class="math inline">\(\mu_{Y|X_0}\)</span>的1-α可信区间为：
<span class="math display">\[\hat Y_0 ± S_{\hat Y_0}*t_{\alpha/2,v}\]</span></p>
<p>在直角坐标系中，总体均数<span class="math inline">\(\mu_{Y|X_0}\)</span>的1-α可信区间通常被表示为一条中间窄，两端宽的带子(边缘一般是实线)，其中最窄处对应的就是<span class="math inline">\(X=X_0\)</span>。</p>
</div>
<div id="个体y值的预测区间" class="section level4">
<h4><span class="header-section-number">9.2.4.2</span> 个体Y值的预测区间</h4>
<p>将预报因子(自变量X)代入回归方程对总体中预报量(因变量Y)的个体值进行估计。给定X的数值<span class="math inline">\(X_0\)</span>，对应的个体Y值
也存在一个波动范围，其标准差<span class="math inline">\(S_{Y_0}\)</span>(注意：<strong>不要与样本观察值Y的标准差相混淆</strong>)的计算公式为：
<span class="math display">\[S_{Y_0}=S_{Y|X}*\sqrt{1+1/n+\frac{(X-\bar X)^2}{\sum (X-\bar X)^2}}\]</span>
给定<span class="math inline">\(X=X_0\)</span>时的个体Y值的1-α得预测区间为：
<span class="math display">\[\hat Y_0 ± S_{Y_0}*t_{\alpha/2,v}\]</span></p>
<p>在直角坐标系中，个体Y值的1-α得预测区间通常被比表示为一条比总体均数<span class="math inline">\(\mu_{Y|X_0}\)</span>的1-α可信区间带更宽的带子，
其中最窄处对应的也是<span class="math inline">\(X=X_0\)</span>。</p>
<p>应注意的是，给定<span class="math inline">\(X=X_0\)</span>时，相应Y的均数的可信区间与其个体Y值的预测区间的含义是不同的:前者表示在固定的<span class="math inline">\(X_0\)</span>处，
如果反复抽样100次，可算出100个相应Y的总体均数的可信区间，平均有100x(1-α)个可信区间包含总体均数;后者表示的是一
个预测值的取值范围，即预测100个个体值中，平均将有100x(1-α)个个体值在求出的范围内。</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="第九章-双变量回归与相关.html#cb96-1"></a><span class="kw">library</span>(<span class="st">&quot;dplyr&quot;</span>)</span>
<span id="cb96-2"><a href="第九章-双变量回归与相关.html#cb96-2"></a><span class="kw">library</span>(<span class="st">&quot;haven&quot;</span>)</span>
<span id="cb96-3"><a href="第九章-双变量回归与相关.html#cb96-3"></a><span class="kw">library</span>(<span class="st">&quot;ggplot2&quot;</span>)</span>
<span id="cb96-4"><a href="第九章-双变量回归与相关.html#cb96-4"></a>Creatinine_df&lt;-<span class="kw">read_sav</span>(<span class="dt">file=</span><span class="st">&quot;ExampleData/SavData4MedSta/Exam09-01.sav&quot;</span>)</span>
<span id="cb96-5"><a href="第九章-双变量回归与相关.html#cb96-5"></a><span class="kw">colnames</span>(Creatinine_df)&lt;-<span class="kw">c</span>(<span class="st">&quot;No.&quot;</span>,<span class="st">&quot;Age&quot;</span>,<span class="st">&quot;CreatiC&quot;</span>)</span>
<span id="cb96-6"><a href="第九章-双变量回归与相关.html#cb96-6"></a></span>
<span id="cb96-7"><a href="第九章-双变量回归与相关.html#cb96-7"></a>lmod&lt;-<span class="kw">lm</span>(Creatinine_df<span class="op">$</span>CreatiC<span class="op">~</span>Creatinine_df<span class="op">$</span>Age)</span>
<span id="cb96-8"><a href="第九章-双变量回归与相关.html#cb96-8"></a></span>
<span id="cb96-9"><a href="第九章-双变量回归与相关.html#cb96-9"></a>meanX&lt;-<span class="kw">mean</span>(Creatinine_df<span class="op">$</span>Age)</span>
<span id="cb96-10"><a href="第九章-双变量回归与相关.html#cb96-10"></a>meanY&lt;-<span class="kw">mean</span>(Creatinine_df<span class="op">$</span>CreatiC)</span>
<span id="cb96-11"><a href="第九章-双变量回归与相关.html#cb96-11"></a>n&lt;-<span class="kw">length</span>(Creatinine_df<span class="op">$</span>CreatiC)</span>
<span id="cb96-12"><a href="第九章-双变量回归与相关.html#cb96-12"></a><span class="co">##用离均差平方和计算不同的变异量</span></span>
<span id="cb96-13"><a href="第九章-双变量回归与相关.html#cb96-13"></a>SS_tol&lt;-<span class="kw">sum</span>((Creatinine_df<span class="op">$</span>CreatiC<span class="op">-</span>meanY)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb96-14"><a href="第九章-双变量回归与相关.html#cb96-14"></a>SS_reg&lt;-<span class="kw">sum</span>((lmod<span class="op">$</span>fitted.values<span class="op">-</span>meanY)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb96-15"><a href="第九章-双变量回归与相关.html#cb96-15"></a>SS_res&lt;-<span class="kw">sum</span>((Creatinine_df<span class="op">$</span>CreatiC<span class="op">-</span>lmod<span class="op">$</span>fitted.values)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb96-16"><a href="第九章-双变量回归与相关.html#cb96-16"></a><span class="co">##计算不同的离均差平方和(Sum of square of deviations from mean,SS)，离均差积和</span></span>
<span id="cb96-17"><a href="第九章-双变量回归与相关.html#cb96-17"></a>DAS_xx&lt;-<span class="kw">sum</span>(Creatinine_df<span class="op">$</span>Age<span class="op">^</span><span class="dv">2</span>)<span class="op">-</span>(<span class="kw">sum</span>(Creatinine_df<span class="op">$</span>Age))<span class="op">^</span><span class="dv">2</span><span class="op">/</span>n</span>
<span id="cb96-18"><a href="第九章-双变量回归与相关.html#cb96-18"></a>DAS_yy&lt;-<span class="kw">sum</span>(Creatinine_df<span class="op">$</span>CreatiC<span class="op">^</span><span class="dv">2</span>)<span class="op">-</span>(<span class="kw">sum</span>(Creatinine_df<span class="op">$</span>CreatiC))<span class="op">^</span><span class="dv">2</span><span class="op">/</span>n</span>
<span id="cb96-19"><a href="第九章-双变量回归与相关.html#cb96-19"></a>DAS_xy&lt;-<span class="kw">sum</span>(Creatinine_df<span class="op">$</span>Age<span class="op">*</span>Creatinine_df<span class="op">$</span>CreatiC)<span class="op">-</span>(<span class="kw">sum</span>(Creatinine_df<span class="op">$</span>Age)<span class="op">*</span><span class="kw">sum</span>(Creatinine_df<span class="op">$</span>CreatiC))<span class="op">/</span>n</span>
<span id="cb96-20"><a href="第九章-双变量回归与相关.html#cb96-20"></a></span>
<span id="cb96-21"><a href="第九章-双变量回归与相关.html#cb96-21"></a><span class="co">#计算回归系数b与常项数a</span></span>
<span id="cb96-22"><a href="第九章-双变量回归与相关.html#cb96-22"></a>b&lt;-DAS_xy<span class="op">/</span>DAS_xx</span>
<span id="cb96-23"><a href="第九章-双变量回归与相关.html#cb96-23"></a><span class="co"># [1] 0.1391667</span></span>
<span id="cb96-24"><a href="第九章-双变量回归与相关.html#cb96-24"></a>a&lt;-meanY<span class="op">-</span>b<span class="op">*</span>meanX</span>
<span id="cb96-25"><a href="第九章-双变量回归与相关.html#cb96-25"></a><span class="co"># [1] 1.661667</span></span>
<span id="cb96-26"><a href="第九章-双变量回归与相关.html#cb96-26"></a></span>
<span id="cb96-27"><a href="第九章-双变量回归与相关.html#cb96-27"></a><span class="co">#计算回归方程的剩余标准差SDR_xy</span></span>
<span id="cb96-28"><a href="第九章-双变量回归与相关.html#cb96-28"></a>SDR_xy&lt;-<span class="kw">sqrt</span>(SS_res<span class="op">/</span>(n<span class="dv">-2</span>))</span>
<span id="cb96-29"><a href="第九章-双变量回归与相关.html#cb96-29"></a><span class="co">#计算样本回归系数的标准误Se_rc</span></span>
<span id="cb96-30"><a href="第九章-双变量回归与相关.html#cb96-30"></a>Se_b&lt;-SDR_xy<span class="op">/</span><span class="kw">sqrt</span>(DAS_xx)</span>
<span id="cb96-31"><a href="第九章-双变量回归与相关.html#cb96-31"></a></span>
<span id="cb96-32"><a href="第九章-双变量回归与相关.html#cb96-32"></a>F_val&lt;-SS_reg<span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>SS_res</span>
<span id="cb96-33"><a href="第九章-双变量回归与相关.html#cb96-33"></a><span class="co"># [1] 20.96842</span></span>
<span id="cb96-34"><a href="第九章-双变量回归与相关.html#cb96-34"></a>t_val&lt;-b<span class="op">/</span>Se_b</span>
<span id="cb96-35"><a href="第九章-双变量回归与相关.html#cb96-35"></a><span class="co"># [1] 4.579129</span></span>
<span id="cb96-36"><a href="第九章-双变量回归与相关.html#cb96-36"></a></span>
<span id="cb96-37"><a href="第九章-双变量回归与相关.html#cb96-37"></a><span class="co"># 计算回归系数Beta(b)的95%可信区间</span></span>
<span id="cb96-38"><a href="第九章-双变量回归与相关.html#cb96-38"></a>alpha&lt;-<span class="fl">0.05</span></span>
<span id="cb96-39"><a href="第九章-双变量回归与相关.html#cb96-39"></a>t_alphaval&lt;-<span class="kw">qt</span>(alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-2</span>,<span class="dt">lower.tail =</span> F)</span>
<span id="cb96-40"><a href="第九章-双变量回归与相关.html#cb96-40"></a><span class="co"># [1] 2.446912</span></span>
<span id="cb96-41"><a href="第九章-双变量回归与相关.html#cb96-41"></a>lci&lt;-b<span class="op">-</span>t_alphaval<span class="op">*</span>Se_b</span>
<span id="cb96-42"><a href="第九章-双变量回归与相关.html#cb96-42"></a>uci&lt;-b<span class="op">+</span>t_alphaval<span class="op">*</span>Se_b</span>
<span id="cb96-43"><a href="第九章-双变量回归与相关.html#cb96-43"></a></span>
<span id="cb96-44"><a href="第九章-双变量回归与相关.html#cb96-44"></a><span class="co">#根据计算的回归系数和b和常项数a计算Y的预测值</span></span>
<span id="cb96-45"><a href="第九章-双变量回归与相关.html#cb96-45"></a>pred.y &lt;-<span class="st"> </span>b <span class="op">*</span><span class="st"> </span>Creatinine_df<span class="op">$</span>Age <span class="op">+</span><span class="st"> </span>a</span>
<span id="cb96-46"><a href="第九章-双变量回归与相关.html#cb96-46"></a><span class="co">#根据抽样误差大小的标准误计算公式计算总体均数的可信区间</span></span>
<span id="cb96-47"><a href="第九章-双变量回归与相关.html#cb96-47"></a>pred.y_se&lt;-SDR_xy<span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">/</span>n<span class="op">+</span>(Creatinine_df<span class="op">$</span>Age<span class="op">-</span>meanX)<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">sum</span>((Creatinine_df<span class="op">$</span>Age<span class="op">-</span>meanX)<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb96-48"><a href="第九章-双变量回归与相关.html#cb96-48"></a>pred.y_uci&lt;-pred.y<span class="op">+</span>t_alphaval<span class="op">*</span>pred.y_se</span>
<span id="cb96-49"><a href="第九章-双变量回归与相关.html#cb96-49"></a>pred.y_lci&lt;-pred.y<span class="op">-</span>t_alphaval<span class="op">*</span>pred.y_se</span>
<span id="cb96-50"><a href="第九章-双变量回归与相关.html#cb96-50"></a></span>
<span id="cb96-51"><a href="第九章-双变量回归与相关.html#cb96-51"></a><span class="co">#根据抽样观察值的波动标准差计算公式计算观察值的预测区间</span></span>
<span id="cb96-52"><a href="第九章-双变量回归与相关.html#cb96-52"></a>y_se&lt;-SDR_xy<span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">+</span><span class="dv">1</span><span class="op">/</span>n<span class="op">+</span>(Creatinine_df<span class="op">$</span>Age<span class="op">-</span>meanX)<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">sum</span>((Creatinine_df<span class="op">$</span>Age<span class="op">-</span>meanX)<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb96-53"><a href="第九章-双变量回归与相关.html#cb96-53"></a>y_uci&lt;-pred.y<span class="op">+</span>t_alphaval<span class="op">*</span>y_se</span>
<span id="cb96-54"><a href="第九章-双变量回归与相关.html#cb96-54"></a>y_lci&lt;-pred.y<span class="op">-</span>t_alphaval<span class="op">*</span>y_se</span>
<span id="cb96-55"><a href="第九章-双变量回归与相关.html#cb96-55"></a></span>
<span id="cb96-56"><a href="第九章-双变量回归与相关.html#cb96-56"></a>pred.y_df&lt;-<span class="kw">cbind</span>(Creatinine_df<span class="op">$</span>Age,</span>
<span id="cb96-57"><a href="第九章-双变量回归与相关.html#cb96-57"></a>  <span class="kw">predict</span>(lmod,<span class="dt">interval =</span> <span class="st">&quot;confidence&quot;</span>)[,<span class="dv">2</span>],</span>
<span id="cb96-58"><a href="第九章-双变量回归与相关.html#cb96-58"></a>  <span class="kw">predict</span>(lmod,<span class="dt">interval =</span> <span class="st">&quot;confidence&quot;</span>)[,<span class="dv">3</span>], pred.y)</span>
<span id="cb96-59"><a href="第九章-双变量回归与相关.html#cb96-59"></a></span>
<span id="cb96-60"><a href="第九章-双变量回归与相关.html#cb96-60"></a>y_df&lt;-<span class="kw">cbind</span>(Creatinine_df<span class="op">$</span>Age,  y_lci,  y_uci, pred.y)</span>
<span id="cb96-61"><a href="第九章-双变量回归与相关.html#cb96-61"></a></span>
<span id="cb96-62"><a href="第九章-双变量回归与相关.html#cb96-62"></a><span class="co">#plot(Creatinine_df$Age,Creatinine_df$CreatiC, cex = 1.75, pch = 21, bg = &#39;gray&#39;)</span></span>
<span id="cb96-63"><a href="第九章-双变量回归与相关.html#cb96-63"></a><span class="co">#lines(pred.y_df[order(pred.y_df[,1]),][,1],pred.y_df[order(pred.y_df[,1]),][,4],col=&quot;green&quot;)</span></span>
<span id="cb96-64"><a href="第九章-双变量回归与相关.html#cb96-64"></a></span>
<span id="cb96-65"><a href="第九章-双变量回归与相关.html#cb96-65"></a><span class="co">#lines(pred.y_df[order(pred.y_df[,1]),][,1],pred.y_df[order(pred.y_df[,1]),][,2],col=&quot;red&quot;)</span></span>
<span id="cb96-66"><a href="第九章-双变量回归与相关.html#cb96-66"></a><span class="co">#lines(pred.y_df[order(pred.y_df[,1]),][,1],pred.y_df[order(pred.y_df[,1]),][,3],col=&quot;red&quot;)</span></span>
<span id="cb96-67"><a href="第九章-双变量回归与相关.html#cb96-67"></a></span>
<span id="cb96-68"><a href="第九章-双变量回归与相关.html#cb96-68"></a><span class="co">#lines(y_df[order(y_df[,1]),][,1],y_df[order(y_df[,1]),][,2],col=&quot;blue&quot;)</span></span>
<span id="cb96-69"><a href="第九章-双变量回归与相关.html#cb96-69"></a><span class="co">#lines(y_df[order(y_df[,1]),][,1],y_df[order(y_df[,1]),][,3],col=&quot;blue&quot;)</span></span>
<span id="cb96-70"><a href="第九章-双变量回归与相关.html#cb96-70"></a></span>
<span id="cb96-71"><a href="第九章-双变量回归与相关.html#cb96-71"></a><span class="kw">colnames</span>(pred.y_df)&lt;-<span class="kw">c</span>(<span class="st">&quot;Age&quot;</span>,<span class="st">&quot;LCI&quot;</span>,<span class="st">&quot;UCI&quot;</span>,<span class="st">&quot;predy&quot;</span>)</span>
<span id="cb96-72"><a href="第九章-双变量回归与相关.html#cb96-72"></a><span class="kw">colnames</span>(y_df)&lt;-<span class="kw">c</span>(<span class="st">&quot;Age&quot;</span>,<span class="st">&quot;LCI&quot;</span>,<span class="st">&quot;UCI&quot;</span>,<span class="st">&quot;predy&quot;</span>)</span>
<span id="cb96-73"><a href="第九章-双变量回归与相关.html#cb96-73"></a></span>
<span id="cb96-74"><a href="第九章-双变量回归与相关.html#cb96-74"></a>o &lt;-<span class="st"> </span><span class="kw">ggplot</span>(Creatinine_df, <span class="kw">aes</span>(Age, CreatiC))<span class="op">+</span></span>
<span id="cb96-75"><a href="第九章-双变量回归与相关.html#cb96-75"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;年龄(岁)|Age(Years)&quot;</span>)<span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;尿肌酐浓度(mmol/24h)|Creatic concentration(mmol/24h)&quot;</span>)<span class="op">+</span></span>
<span id="cb96-76"><a href="第九章-双变量回归与相关.html#cb96-76"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape=</span><span class="dv">21</span>,<span class="dt">size=</span><span class="fl">3.5</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>,<span class="dt">fill=</span><span class="st">&quot;red&quot;</span>,<span class="dt">alpha=</span><span class="fl">0.5</span>)<span class="op">+</span></span>
<span id="cb96-77"><a href="第九章-双变量回归与相关.html#cb96-77"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>, <span class="dt">se=</span><span class="ot">TRUE</span>, <span class="dt">colour =</span> <span class="st">&quot;blue&quot;</span>,<span class="dt">fill=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">alpha=</span><span class="fl">0.3</span>,<span class="dt">size=</span><span class="fl">1.1</span>)<span class="op">+</span></span>
<span id="cb96-78"><a href="第九章-双变量回归与相关.html#cb96-78"></a><span class="st">  </span><span class="kw">geom_path</span>(<span class="dt">data=</span><span class="kw">as.data.frame</span>(y_df[<span class="kw">order</span>(y_df[,<span class="dv">1</span>]),]),<span class="kw">aes</span>(Age,UCI),<span class="dt">lineend=</span><span class="st">&quot;butt&quot;</span>,<span class="dt">linejoin=</span><span class="st">&quot;round&quot;</span>,<span class="dt">linemitre=</span><span class="dv">1</span>,</span>
<span id="cb96-79"><a href="第九章-双变量回归与相关.html#cb96-79"></a>  <span class="dt">color=</span><span class="st">&quot;red&quot;</span>,<span class="dt">size=</span><span class="fl">1.1</span>,<span class="dt">alpha=</span><span class="fl">0.5</span>,<span class="dt">linetype=</span><span class="dv">2</span>)<span class="op">+</span></span>
<span id="cb96-80"><a href="第九章-双变量回归与相关.html#cb96-80"></a><span class="st">  </span><span class="kw">geom_path</span>(<span class="dt">data=</span><span class="kw">as.data.frame</span>(y_df[<span class="kw">order</span>(y_df[,<span class="dv">1</span>]),]),<span class="kw">aes</span>(Age,LCI),<span class="dt">lineend=</span><span class="st">&quot;butt&quot;</span>,<span class="dt">linejoin=</span><span class="st">&quot;round&quot;</span>,<span class="dt">linemitre=</span><span class="dv">1</span>,</span>
<span id="cb96-81"><a href="第九章-双变量回归与相关.html#cb96-81"></a>  <span class="dt">color=</span><span class="st">&quot;red&quot;</span>,<span class="dt">size=</span><span class="fl">1.1</span>,<span class="dt">alpha=</span><span class="fl">0.5</span>,<span class="dt">linetype=</span><span class="dv">2</span>)<span class="op">+</span></span>
<span id="cb96-82"><a href="第九章-双变量回归与相关.html#cb96-82"></a><span class="st">  </span><span class="kw">theme_classic</span>()</span>
<span id="cb96-83"><a href="第九章-双变量回归与相关.html#cb96-83"></a><span class="kw">print</span>(o)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:figregression"></span>
<img src="figs/figregression.png" alt="8名正常儿童的年龄X(岁)与尿肌酐含量Y*(mmol/24h)的线性回归模拟" width="49%" />
<p class="caption">
Figure 9.1: 8名正常儿童的年龄X(岁)与尿肌酐含量Y*(mmol/24h)的线性回归模拟
</p>
</div>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="第八章-秩转换的非参数检验.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "Sepia",
"family": "serif",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/08-BivariateRegression.rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"search": true,
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
