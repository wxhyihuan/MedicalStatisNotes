<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 第八章 秩转换的非参数检验 | MedicalStatisNotes.utf8</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content=" 第八章 秩转换的非参数检验 | MedicalStatisNotes.utf8" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 第八章 秩转换的非参数检验 | MedicalStatisNotes.utf8" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="第七章-chi2检验.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://wxhyihuan.github.io/">医学统计学笔记与R语言</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> 简介与传送门</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#简介"><i class="fa fa-check"></i><b>1.1</b> 简介</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#软件准备"><i class="fa fa-check"></i><b>1.1.1</b> 软件准备</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#传送门"><i class="fa fa-check"></i><b>1.2</b> 传送门</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#致谢"><i class="fa fa-check"></i><b>1.3</b> 致谢</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#声明"><i class="fa fa-check"></i><b>1.4</b> 声明</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html"><i class="fa fa-check"></i><b>2</b> 第二章 计量资料的统计描述</a><ul>
<li class="chapter" data-level="2.1" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#描述统计"><i class="fa fa-check"></i><b>2.1</b> 描述统计</a></li>
<li class="chapter" data-level="2.2" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#测试数据"><i class="fa fa-check"></i><b>2.2</b> 测试数据</a></li>
<li class="chapter" data-level="2.3" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#数据输入和频率统计"><i class="fa fa-check"></i><b>2.3</b> 数据输入和频率统计</a><ul>
<li class="chapter" data-level="2.3.1" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#读取数据并将数据转换成单列形式"><i class="fa fa-check"></i><b>2.3.1</b> 读取数据，并将数据转换成单列形式</a></li>
<li class="chapter" data-level="2.3.2" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#计算极差-maxminrange"><i class="fa fa-check"></i><b>2.3.2</b> 计算极差, max()/min()/range()</a></li>
<li class="chapter" data-level="2.3.3" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#确定组段数和组距"><i class="fa fa-check"></i><b>2.3.3</b> 确定组段数和组距</a></li>
<li class="chapter" data-level="2.3.4" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#计算频数分布"><i class="fa fa-check"></i><b>2.3.4</b> 计算频数分布</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#描述性统计的度量"><i class="fa fa-check"></i><b>2.4</b> 描述性统计的度量</a><ul>
<li class="chapter" data-level="2.4.1" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#算术平均值"><i class="fa fa-check"></i><b>2.4.1</b> 算术平均值</a></li>
<li class="chapter" data-level="2.4.2" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#几何平均值"><i class="fa fa-check"></i><b>2.4.2</b> 几何平均值</a></li>
<li class="chapter" data-level="2.4.3" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#中位数与百分位数"><i class="fa fa-check"></i><b>2.4.3</b> 中位数与百分位数</a></li>
<li class="chapter" data-level="2.4.4" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#极差"><i class="fa fa-check"></i><b>2.4.4</b> 极差</a></li>
<li class="chapter" data-level="2.4.5" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#四分位间距"><i class="fa fa-check"></i><b>2.4.5</b> 四分位间距</a></li>
<li class="chapter" data-level="2.4.6" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#方差与标准差"><i class="fa fa-check"></i><b>2.4.6</b> 方差与标准差</a></li>
<li class="chapter" data-level="2.4.7" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#变异系数"><i class="fa fa-check"></i><b>2.4.7</b> 变异系数</a></li>
<li class="chapter" data-level="2.4.8" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#其他的描述统计"><i class="fa fa-check"></i><b>2.4.8</b> 其他的描述统计</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#正态分布和标准正态分布"><i class="fa fa-check"></i><b>2.5</b> 正态分布和标准正态分布</a><ul>
<li class="chapter" data-level="2.5.1" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#概率密度函数dnorm"><i class="fa fa-check"></i><b>2.5.1</b> 概率密度函数dnorm()</a></li>
<li class="chapter" data-level="2.5.2" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#概率累积分布函数pnorm"><i class="fa fa-check"></i><b>2.5.2</b> 概率累积分布函数pnorm()</a></li>
<li class="chapter" data-level="2.5.3" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#正态分位函数qnorm"><i class="fa fa-check"></i><b>2.5.3</b> 正态分位函数qnorm()</a></li>
<li class="chapter" data-level="2.5.4" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#生成正态分布函数rnorm"><i class="fa fa-check"></i><b>2.5.4</b> 生成正态分布函数rnorm()</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#正态分布检验"><i class="fa fa-check"></i><b>2.6</b> 正态分布检验</a><ul>
<li class="chapter" data-level="2.6.1" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#直方图"><i class="fa fa-check"></i><b>2.6.1</b> 直方图</a></li>
<li class="chapter" data-level="2.6.2" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#概率密度图"><i class="fa fa-check"></i><b>2.6.2</b> 概率密度图</a></li>
<li class="chapter" data-level="2.6.3" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#qq-plot"><i class="fa fa-check"></i><b>2.6.3</b> QQ-plot</a></li>
<li class="chapter" data-level="2.6.4" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#正态检验"><i class="fa fa-check"></i><b>2.6.4</b> 正态检验</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html"><i class="fa fa-check"></i><b>3</b> 第三章 总体均数的估计与假设检验</a><ul>
<li class="chapter" data-level="3.1" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#推论统计"><i class="fa fa-check"></i><b>3.1</b> 推论统计</a><ul>
<li class="chapter" data-level="3.1.1" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#参数估计与假设检验"><i class="fa fa-check"></i><b>3.1.1</b> 参数估计与假设检验</a></li>
<li class="chapter" data-level="3.1.2" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#统计量与标准误"><i class="fa fa-check"></i><b>3.1.2</b> 统计量与标准误</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#t-分布"><i class="fa fa-check"></i><b>3.2</b> <em>t</em> 分布</a><ul>
<li class="chapter" data-level="3.2.1" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#概率密度函数dt"><i class="fa fa-check"></i><b>3.2.1</b> 概率密度函数dt()</a></li>
<li class="chapter" data-level="3.2.2" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#概率累积分布函数pt"><i class="fa fa-check"></i><b>3.2.2</b> 概率累积分布函数pt()</a></li>
<li class="chapter" data-level="3.2.3" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#求置信区间的qt"><i class="fa fa-check"></i><b>3.2.3</b> 求置信区间的qt()</a></li>
<li class="chapter" data-level="3.2.4" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#指定t分布函数rt"><i class="fa fa-check"></i><b>3.2.4</b> 指定t分布函数rt()</a></li>
<li class="chapter" data-level="3.2.5" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#参数估计"><i class="fa fa-check"></i><b>3.2.5</b> 参数估计</a></li>
<li class="chapter" data-level="3.2.6" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#假设检验"><i class="fa fa-check"></i><b>3.2.6</b> 假设检验</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#t-检验的分类及应用"><i class="fa fa-check"></i><b>3.3</b> <em>t</em> 检验的分类及应用</a><ul>
<li class="chapter" data-level="3.3.1" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#t检验与z检验"><i class="fa fa-check"></i><b>3.3.1</b> <em>t</em>检验与Z检验</a></li>
<li class="chapter" data-level="3.3.2" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#单样本t检验"><i class="fa fa-check"></i><b>3.3.2</b> 单样本<em>t</em>检验</a></li>
<li class="chapter" data-level="3.3.3" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#配对样本t检验"><i class="fa fa-check"></i><b>3.3.3</b> 配对样本<em>t</em>检验</a></li>
<li class="chapter" data-level="3.3.4" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#两种独立样本t检验"><i class="fa fa-check"></i><b>3.3.4</b> 两种独立样本t检验</a></li>
<li class="chapter" data-level="3.3.5" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#两样本方差齐性检验"><i class="fa fa-check"></i><b>3.3.5</b> 两样本方差齐性检验</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#变量转换"><i class="fa fa-check"></i><b>3.4</b> 变量转换</a><ul>
<li class="chapter" data-level="3.4.1" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#对数变换"><i class="fa fa-check"></i><b>3.4.1</b> 对数变换</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html"><i class="fa fa-check"></i><b>4</b> 第四章 多个样本均数比较的方差分析</a><ul>
<li class="chapter" data-level="4.1" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#f分布"><i class="fa fa-check"></i><b>4.1</b> <em>F</em>分布</a></li>
<li class="chapter" data-level="4.2" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#f检验的分类原理及应用"><i class="fa fa-check"></i><b>4.2</b> <em>F</em>检验的分类、原理及应用</a><ul>
<li class="chapter" data-level="4.2.1" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#分类"><i class="fa fa-check"></i><b>4.2.1</b> 分类</a></li>
<li class="chapter" data-level="4.2.2" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#原理"><i class="fa fa-check"></i><b>4.2.2</b> 原理</a></li>
<li class="chapter" data-level="4.2.3" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#单因子方差分析"><i class="fa fa-check"></i><b>4.2.3</b> 单因子方差分析</a></li>
<li class="chapter" data-level="4.2.4" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#双因子方差分析"><i class="fa fa-check"></i><b>4.2.4</b> 双因子方差分析</a></li>
<li class="chapter" data-level="4.2.5" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#拉丁方设计资料的方差分析"><i class="fa fa-check"></i><b>4.2.5</b> 拉丁方设计资料的方差分析</a></li>
<li class="chapter" data-level="4.2.6" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#两阶段交叉设计资料的方差分析"><i class="fa fa-check"></i><b>4.2.6</b> 两阶段交叉设计资料的方差分析</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#方差分析的诊断图"><i class="fa fa-check"></i><b>4.3</b> 方差分析的诊断图</a></li>
<li class="chapter" data-level="4.4" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#多个样本均数间的多重比较"><i class="fa fa-check"></i><b>4.4</b> 多个样本均数间的多重比较</a></li>
<li class="chapter" data-level="4.5" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#多样本方差齐性检验"><i class="fa fa-check"></i><b>4.5</b> 多样本方差齐性检验</a><ul>
<li class="chapter" data-level="4.5.1" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#bartletts-检验"><i class="fa fa-check"></i><b>4.5.1</b> Bartlett’s 检验</a></li>
<li class="chapter" data-level="4.5.2" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#levenes-检验"><i class="fa fa-check"></i><b>4.5.2</b> Levene’s 检验</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html"><i class="fa fa-check"></i><b>5</b> 第五章 计数资料的统计描述</a><ul>
<li class="chapter" data-level="5.1" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#常用相对数"><i class="fa fa-check"></i><b>5.1</b> 常用相对数</a><ul>
<li class="chapter" data-level="5.1.1" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#强度相对数"><i class="fa fa-check"></i><b>5.1.1</b> 强度相对数</a></li>
<li class="chapter" data-level="5.1.2" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#结构相对数"><i class="fa fa-check"></i><b>5.1.2</b> 结构相对数</a></li>
<li class="chapter" data-level="5.1.3" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#相对比"><i class="fa fa-check"></i><b>5.1.3</b> 相对比</a></li>
<li class="chapter" data-level="5.1.4" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#应用相对数的注意点"><i class="fa fa-check"></i><b>5.1.4</b> 应用相对数的注意点</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#率的标准化"><i class="fa fa-check"></i><b>5.2</b> 率的标准化</a><ul>
<li class="chapter" data-level="5.2.1" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#标准化率的计算"><i class="fa fa-check"></i><b>5.2.1</b> 标准化率的计算</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#动态数列及其指标分析"><i class="fa fa-check"></i><b>5.3</b> 动态数列及其指标分析</a><ul>
<li class="chapter" data-level="5.3.1" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#绝对增长量"><i class="fa fa-check"></i><b>5.3.1</b> 绝对增长量</a></li>
<li class="chapter" data-level="5.3.2" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#发展速度与增长速度"><i class="fa fa-check"></i><b>5.3.2</b> 发展速度与增长速度</a></li>
<li class="chapter" data-level="5.3.3" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#平均发展速度与平均增长速度"><i class="fa fa-check"></i><b>5.3.3</b> 平均发展速度与平均增长速度</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html"><i class="fa fa-check"></i><b>6</b> 第六章 计数资料的统计描述</a><ul>
<li class="chapter" data-level="6.1" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#二项分布"><i class="fa fa-check"></i><b>6.1</b> 二项分布</a><ul>
<li class="chapter" data-level="6.1.1" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#二项分布的性质"><i class="fa fa-check"></i><b>6.1.1</b> 二项分布的性质</a></li>
<li class="chapter" data-level="6.1.2" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#二项分布的应用"><i class="fa fa-check"></i><b>6.1.2</b> 二项分布的应用</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#泊松分布"><i class="fa fa-check"></i><b>6.2</b> 泊松分布</a><ul>
<li class="chapter" data-level="6.2.1" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#泊松分布的性质"><i class="fa fa-check"></i><b>6.2.1</b> 泊松分布的性质</a></li>
<li class="chapter" data-level="6.2.2" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#泊松分布的应用"><i class="fa fa-check"></i><b>6.2.2</b> 泊松分布的应用</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#负二项分布"><i class="fa fa-check"></i><b>6.3</b> 负二项分布</a><ul>
<li class="chapter" data-level="6.3.1" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#负二项分布的性质"><i class="fa fa-check"></i><b>6.3.1</b> 负二项分布的性质</a></li>
<li class="chapter" data-level="6.3.2" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#负二项分布的参数估计"><i class="fa fa-check"></i><b>6.3.2</b> 负二项分布的参数估计</a></li>
<li class="chapter" data-level="6.3.3" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#负二项分布的应用"><i class="fa fa-check"></i><b>6.3.3</b> 负二项分布的应用</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html"><i class="fa fa-check"></i><b>7</b> 第七章 <span class="math inline">\(\chi^2\)</span>检验</a><ul>
<li class="chapter" data-level="7.1" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#卡方分布"><i class="fa fa-check"></i><b>7.1</b> 卡方分布</a><ul>
<li class="chapter" data-level="7.1.1" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#概率密度函数"><i class="fa fa-check"></i><b>7.1.1</b> 概率密度函数</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#卡方检验"><i class="fa fa-check"></i><b>7.2</b> 卡方检验</a><ul>
<li class="chapter" data-level="7.2.1" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#卡方独立性检验的基本思想"><i class="fa fa-check"></i><b>7.2.1</b> 卡方独立性检验的基本思想</a></li>
<li class="chapter" data-level="7.2.2" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#四格资料表的卡方检验"><i class="fa fa-check"></i><b>7.2.2</b> 四格资料表的卡方检验</a></li>
<li class="chapter" data-level="7.2.3" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#配对的四格资料表的卡方检验"><i class="fa fa-check"></i><b>7.2.3</b> 配对的四格资料表的卡方检验</a></li>
<li class="chapter" data-level="7.2.4" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#四格资料表的fisher确切概率法"><i class="fa fa-check"></i><b>7.2.4</b> 四格资料表的Fisher确切概率法</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#行列资料表的卡方检验"><i class="fa fa-check"></i><b>7.3</b> 行列资料表的卡方检验</a><ul>
<li class="chapter" data-level="7.3.1" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#多个样本率的比较r-times-2表"><i class="fa fa-check"></i><b>7.3.1</b> 多个样本率的比较(<span class="math inline">\(R \times 2\)</span>表)</a></li>
<li class="chapter" data-level="7.3.2" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#样本构成比的比较2-times-c表"><i class="fa fa-check"></i><b>7.3.2</b> 样本构成比的比较(<span class="math inline">\(2 \times C\)</span>表)</a></li>
<li class="chapter" data-level="7.3.3" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#双向无序分组资料的关联性检验"><i class="fa fa-check"></i><b>7.3.3</b> 双向无序分组资料的关联性检验</a></li>
<li class="chapter" data-level="7.3.4" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#双向有序分组资料的线性趋势检验"><i class="fa fa-check"></i><b>7.3.4</b> 双向有序分组资料的线性趋势检验</a></li>
<li class="chapter" data-level="7.3.5" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#卡方检验的注意事项与选择思路"><i class="fa fa-check"></i><b>7.3.5</b> 卡方检验的注意事项与选择思路</a></li>
<li class="chapter" data-level="7.3.6" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#多个样本率的多重比较"><i class="fa fa-check"></i><b>7.3.6</b> 多个样本率的多重比较</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#cochran-mantel-haenszel卡方统计量检验"><i class="fa fa-check"></i><b>7.4</b> Cochran-Mantel-Haenszel卡方统计量检验</a></li>
<li class="chapter" data-level="7.5" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#频数分布的拟合优度检验"><i class="fa fa-check"></i><b>7.5</b> 频数分布的拟合优度检验</a><ul>
<li class="chapter" data-level="7.5.1" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#观察数据的无分布预期"><i class="fa fa-check"></i><b>7.5.1</b> 观察数据的无分布预期</a></li>
<li class="chapter" data-level="7.5.2" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#观察数据的有预期分布"><i class="fa fa-check"></i><b>7.5.2</b> 观察数据的有预期分布</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html"><i class="fa fa-check"></i><b>8</b> 第八章 秩转换的非参数检验</a><ul>
<li class="chapter" data-level="8.1" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html#wilcoxon符号秩检验"><i class="fa fa-check"></i><b>8.1</b> Wilcoxon符号秩检验</a><ul>
<li class="chapter" data-level="8.1.1" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html#wilcoxon符号秩检验的原理与过程"><i class="fa fa-check"></i><b>8.1.1</b> Wilcoxon符号秩检验的原理与过程</a></li>
<li class="chapter" data-level="8.1.2" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html#单组样本与总体的中位数的wilcoxon符号秩检验"><i class="fa fa-check"></i><b>8.1.2</b> 单组样本与总体的中位数的Wilcoxon符号秩检验</a></li>
<li class="chapter" data-level="8.1.3" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html#配对样本差值的中位数和0比较"><i class="fa fa-check"></i><b>8.1.3</b> 配对样本差值的中位数和0比较</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html#两个独立样本的比较的wilcoxon秩和检验"><i class="fa fa-check"></i><b>8.2</b> 两个独立样本的比较的Wilcoxon秩和检验</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="第八章-秩转换的非参数检验" class="section level1">
<h1><span class="header-section-number"></span> 第八章 秩转换的非参数检验</h1>
<p>非参数检验(Nonparametric test)是相对于参数检验(Parametric test)而言的。如果总体分布为已知的数学形式，
<strong>对其总体参数作假设检验</strong>称为参数检验。本书前面介绍的计量资料的对正态总体均数作假设检验的1检验和F检验就为
参数检验。但当总体分布不能由已知的数学形式表达、没有总体参数时，也就谈不上参数检验了。若两个或多个正
态总体方差不等，也不能对其总体均数进行1检验或F检验的参数检 验。对于计量资料，不满足参数检验条件的假设
检验方法，一是可尝试变量变换使其满足参数检验条件， 但有时达不到目的;二是用非参数检验。对于等级资料，
常用非参数检验。</p>
<p>非参数检验对总体分布不作严格假定，又称任意分布检验(Distribution-free test)，它直接<strong>对总体分布的位置是否相同作假设检验</strong>。
非参数检验的优点是它不受总体分布的限制，适用范围广。其中<strong>秩转换(Rank transformation)的非参数检验</strong>，
是推断一个总体表达分布位置的<em>中位数</em>M(非参数)和已知<span class="math inline">\(M_0\)</span>、两个或多个总体的分布是否有差别。秩转换的非参数
检验是先将数值变量资料从小到大，或等级资料从弱到强转换成秩后，再计算检验统计量，其特点是假设检验的
结果对总体分布的形状差别不敏感，只对总体分布的位 置差别敏感。</p>
<p>对于计量资料，若满足正态和方差齐性条件，这时小样本资料选检验或F检验是不妥的，更适合采用秩转换的非参数检验；
对于分布不知是否正态的小样本资料，为保险起见，宜选秩转换的非参数检验；对于一端或两端是不确定数值
(如&lt;0.5、5.0 等)的资料，不管是否正态分布，只能选秩转换的非参数 检验。对于等级资料，若选行x列表资料的<span class="math inline">\(\chi^2\)</span>检验，只
能推断构成比差别，而选秩转换的非参数检验，可推断等级强度差别。如果已知计量资料满足(或近似满足) 检验或F检验条件，当然选检验或F检验， 因为这时若选秩转换的非参数检验，会降低检验效能。</p>
<p>符号秩本身代表一种类型的数据转换，即将实验数据先转化成符号秩。 当一组数据符号秩求和该总和用作检验统计量。 符号秩检验是一种<strong>具有对称的类似正态的分布，是离散分布的而f非连续分布</strong>。</p>
<hr />
<ol style="list-style-type: decimal">
<li><b>什么是 对总体分布的<strong>位置</strong>是否相同作假设检验?</b></li>
</ol>
<p>这里的“位置”应该是是指反应分布特征的位置参数，即均值和中位数，其他的位置参数如众数，四分位等一般难以反映整体，因此用的比较少。
一般均值和中位数代表数据集的中心点。</p>
<ol start="2" style="list-style-type: decimal">
<li><b>为什么是<font color="red">中位数</font>不是<font color="red">均值</font>?又或者为什么不是其他非参数内的参数呢??</b></li>
</ol>
<p>首先，这里需要回答一下，什么是参数累和会参数累位置参数？均值这一类位置参数由于在计算时，会受到样本容量n的大小影响，及计算公式中涉及到样本容量这个变化的参数，因此是属于[参数]类。而中位数，百分位数，
在计算是没有其以来其他参数，直接给予数据本身就可以计算出来，因此是参数类。</p>
<p>其次，在逻辑上我们通常回去寻找数据的中心(这样可以尽量保证统计的稳健性和有效性)，最俱代表性的的是中位数。实际上，均值是数据呈对称分布时的中位数；而在数据分布有偏移时，中位数则一般不同于均数，
使用中位数更能代表数据中心，这也是相比众数，4分位等非参数分布参数的优势。</p>
<p>最后，也有路径依赖的原因，因为早期很多数据都被假设是符合正态的，或者是近似符合正太分布的，可能那时候因为计算受限，
这样的假设处理比较方便而且能解决大部分情况。均值计算起来更加方便快捷，百分位数则需要对所有数据排序，然后再计算。</p>
<hr />
<p>R 语言中的主要函数有：
1. Wilcoxon符号秩检验，Wilcoxon Signed Rank Statistic的<a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/SignRank">dsignrank(),psignrank(),qsignrank(),rsignrank()</a>
2. Wilcoxon符号秩和检验，Wilcoxon Rank Sum Statistic<a href="https://www.rdocumentation.org/link/pwilcox?package=stats&amp;version=3.6.2">dwilcox(),pwilcox(),qwilcox()和rwilcox()</a>
3. 相应的检验函数有<a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/wilcox.test">wilcox.test()</a>。</p>
<div id="wilcoxon符号秩检验" class="section level2">
<h2><span class="header-section-number">8.1</span> Wilcoxon符号秩检验</h2>
<p>Wilcoxon符号秩检验(Wilcoxon singed-rank test)可用于单样本中位数和总体中位数比较，还可用于配对样本差值的中位数和0比较。</p>
<div id="wilcoxon符号秩检验的原理与过程" class="section level3">
<h3><span class="header-section-number">8.1.1</span> Wilcoxon符号秩检验的原理与过程</h3>
<p><strong>单组样本与总体的中位数的Wilcoxon符号秩检验</strong></p>
<p>为了推断样本说来自的总体中位数M与某个已知的总体的中位数<span class="math inline">\(M_0\)</span>是否有差别。用样本变量和<span class="math inline">\(M_0\)</span>的差值，来推断差值的总体位置值和0是否有差别。比如一个样本容量为n的<span class="math inline">\(X\)</span>变量，观察的值为<span class="math inline">\(x_1,x_2,x_3,\dots,x_n,\)</span>；假设要将<span class="math inline">\(X\)</span>变量代表的总体与已知位置值<span class="math inline">\(M_0=m\)</span>的总体进行比较的过程如下：</p>
<ol style="list-style-type: decimal">
<li>计算X中观察值与m的差值，即<span class="math inline">\(d_i=x_i-m，Sgn_i=Sgn(d_i)，i\in[1,n]\)</span>；
<ul>
<li>如果<span class="math inline">\(x_i&gt;m\)</span>，对应的对<span class="math inline">\(d_i&gt;0\)</span>，<em>秩符号</em>为1，即Sgn_i=Sgn(d_i)=1</li>
<li>如果<span class="math inline">\(x_i=m\)</span>，对应的对<span class="math inline">\(d_i=0\)</span>，<em>秩符号</em>为0，即Sgn_i=Sgn(d_i)=0</li>
<li>如果<span class="math inline">\(x_i&lt;m\)</span>，对应的对<span class="math inline">\(d_i&lt;0\)</span>，<em>秩符号</em>为-1，即Sgn_i=Sgn(d_i)=-1</li>
</ul></li>
<li>将样本变换为带符号的秩向量，即对<span class="math inline">\(|d_i|\)</span>按从小到大进行排序，<span class="math inline">\(|d_i|\)</span>排序后的秩(即排序值)记作<span class="math inline">\(R_i\)</span>。这里要注意过滤<span class="math inline">\(d_i=0\)</span>(秩符号为0)的数据，同时，<strong>对应的样本量n会发生相应的减少为n’</strong>。</li>
<li>原始向量值的<em>有符号秩</em>为<span class="math inline">\(R_i*Sgn_i，i\in[1,n]\)</span>，</li>
</ol>
<p><strong>配对样本比较的Wilcoxon符号秩检验</strong></p>
<p>实验样本中配对组之间的差异也代表一个数据向量，这就是为什么使用基于符号秩(Signed Rank Statistic)检验而不是符号秩和检验(Rank Sum Statistic)。</p>
<p>为了推断配对的两个相关样本说来自的两个总体中位数是否有差别。比如两个容量为n的配对样本<span class="math inline">\(X\text{与}Y\)</span>变量，观察的值为<span class="math inline">\(x_1,x_2,x_3,\dots,x_n,\)</span>和<span class="math inline">\(y_1,y_2,y_3,\dots,y_n,\)</span>；这里将<span class="math inline">\(X\text{与}Y\)</span>的差值与0进行检验，判断是否有差别。</p>
<ol style="list-style-type: decimal">
<li>计算X中观察值与m的差值，即<span class="math inline">\(d_i=x_i-y_i，Sgn_i=Sgn(d_i)，i\in[1,n]\)</span>；
<ul>
<li>如果<span class="math inline">\(d_i&gt;0\)</span>，<em>秩符号</em>为1，即Sgn_i=Sgn(d_i)=1</li>
<li>如果<span class="math inline">\(d_i=0\)</span>，<em>秩符号</em>为0，即Sgn_i=Sgn(d_i)=0</li>
<li>如果<span class="math inline">\(d_i&lt;0\)</span>，<em>秩符号</em>为-1，即Sgn_i=Sgn(d_i)=-1</li>
</ul></li>
<li>将样本变换为带符号的秩向量，即对<span class="math inline">\(|d_i|\)</span>按从小到大进行排序，<span class="math inline">\(|d_i|\)</span>排序后的秩(即排序值)记作<span class="math inline">\(R_i\)</span>。这里要注意过滤<span class="math inline">\(d_i=0\)</span>(秩符号为0)的数据，同时，<strong>对应的样本量n会发生相应的减少为n’</strong>。</li>
<li>原始向量值的<em>有符号秩</em>为<span class="math inline">\(R_i*Sgn_i，i\in[1,n]\)</span>，</li>
</ol>
<p><strong>Wilcoxon符号秩检验的统计量</strong></p>
<p>单样本和配对样本的符号秩检验统计量的计算方式一样的，但是不同软件对这个统计量的定义略有差异，主要有两种情况：</p>
<ol style="list-style-type: decimal">
<li>按照正秩和负秩()两个值分别计算计算的情况如下：</li>
</ol>
<p>正秩：
<span class="math display">\[V_{&gt;0}=\sum_i^{n&#39;}R_i*Sgn_i，Sgn_i&gt;0\]</span>
负秩：
<span class="math display">\[V_{&lt;0}=|\sum_i^{n&#39;}R_i*Sgn_i|，Sgn_i&lt;0\]</span></p>
<p>它具有从V=0的最小值到最大值V=n’(n’+1)/2的对称分布，因此在计算P值时候，计算正秩/负秩的效果是一样的，但仍然需要注意时单侧还是双侧检验的使用环境。R语言中自带工具采用的时这一类方式，这里也主要以此为参考。</p>
<ol start="2" style="list-style-type: decimal">
<li>按照<a href="https://en.wikipedia.org/wiki/Wilcoxon_signed-rank_test">总符号秩</a>计算的情况如下：
总秩：
<span class="math display">\[W=\sum_i^{n&#39;}R_i*Sgn_i\]</span></li>
</ol>
</div>
<div id="单组样本与总体的中位数的wilcoxon符号秩检验" class="section level3">
<h3><span class="header-section-number">8.1.2</span> 单组样本与总体的中位数的Wilcoxon符号秩检验</h3>
<p>这里以案例8-2的数据进行测试，设置的原假设<span class="math inline">\(H_0:\)</span>尿氟含量的总体中位数M=45.30；备择假设<span class="math inline">\(H_1:\)</span>M&gt;43.5，是单侧检验；</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="第八章-秩转换的非参数检验.html#cb85-1"></a><span class="kw">library</span>(<span class="st">&quot;memisc&quot;</span>)</span>
<span id="cb85-2"><a href="第八章-秩转换的非参数检验.html#cb85-2"></a><span class="kw">library</span>(<span class="st">&quot;kableExtra&quot;</span>)</span>
<span id="cb85-3"><a href="第八章-秩转换的非参数检验.html#cb85-3"></a><span class="co">#读取数据</span></span>
<span id="cb85-4"><a href="第八章-秩转换的非参数检验.html#cb85-4"></a>urine&lt;-<span class="kw">c</span>(<span class="fl">44.21</span>,<span class="fl">45.30</span>,<span class="fl">46.39</span>,<span class="fl">49.47</span>,<span class="fl">51.05</span>,<span class="fl">53.16</span>,<span class="fl">53.26</span>,<span class="fl">54.37</span>,<span class="fl">57.16</span>,<span class="fl">67.37</span>,<span class="fl">71.05</span>,<span class="fl">87.37</span>)</span>
<span id="cb85-5"><a href="第八章-秩转换的非参数检验.html#cb85-5"></a>m0&lt;-<span class="fl">45.30</span></span>
<span id="cb85-6"><a href="第八章-秩转换的非参数检验.html#cb85-6"></a></span>
<span id="cb85-7"><a href="第八章-秩转换的非参数检验.html#cb85-7"></a>diff_val&lt;-urine<span class="op">-</span>m0</span>
<span id="cb85-8"><a href="第八章-秩转换的非参数检验.html#cb85-8"></a>diff_no0&lt;-diff_val[<span class="kw">which</span>(diff_val <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>)]</span>
<span id="cb85-9"><a href="第八章-秩转换的非参数检验.html#cb85-9"></a>abs_diff_val&lt;-<span class="kw">abs</span>(diff_no0)</span>
<span id="cb85-10"><a href="第八章-秩转换的非参数检验.html#cb85-10"></a>rank_vals&lt;-<span class="kw">rank</span>(abs_diff_val)</span>
<span id="cb85-11"><a href="第八章-秩转换的非参数检验.html#cb85-11"></a>sum_plusrank&lt;-<span class="kw">sum</span>(rank_vals[<span class="kw">which</span>(diff_no0 <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)])</span>
<span id="cb85-12"><a href="第八章-秩转换的非参数检验.html#cb85-12"></a>sum_minusrank&lt;-<span class="kw">sum</span>(rank_vals[<span class="kw">which</span>(diff_no0 <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>)])</span>
<span id="cb85-13"><a href="第八章-秩转换的非参数检验.html#cb85-13"></a>n_<span class="dv">1</span>&lt;-<span class="kw">length</span>(diff_no0)</span>
<span id="cb85-14"><a href="第八章-秩转换的非参数检验.html#cb85-14"></a><span class="kw">barplot</span>(diff_no0,<span class="dt">col=</span><span class="st">&quot;dark gray&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;Difference in Likert&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Frequency&quot;</span>)</span>
<span id="cb85-15"><a href="第八章-秩转换的非参数检验.html#cb85-15"></a><span class="kw">psignrank</span>(sum_plusrank,n_<span class="dv">1</span>,<span class="dt">low.tail=</span>F)</span>
<span id="cb85-16"><a href="第八章-秩转换的非参数检验.html#cb85-16"></a><span class="co"># [1] 0.0004882812</span></span>
<span id="cb85-17"><a href="第八章-秩转换的非参数检验.html#cb85-17"></a><span class="kw">wilcox.test</span>(serum_df<span class="op">$</span>原法,serum_df<span class="op">$</span>新法,<span class="dt">mu=</span><span class="fl">45.3</span>,<span class="dt">paired =</span> T,<span class="dt">alternative =</span> <span class="kw">c</span>(<span class="st">&quot;less&quot;</span>),<span class="dt">exact=</span>T,<span class="dt">correct =</span> F)</span>
<span id="cb85-18"><a href="第八章-秩转换的非参数检验.html#cb85-18"></a><span class="co">#   Wilcoxon signed rank exact test</span></span>
<span id="cb85-19"><a href="第八章-秩转换的非参数检验.html#cb85-19"></a><span class="co">#  </span></span>
<span id="cb85-20"><a href="第八章-秩转换的非参数检验.html#cb85-20"></a><span class="co">#  data:  serum_df$原法 and serum_df$新法</span></span>
<span id="cb85-21"><a href="第八章-秩转换的非参数检验.html#cb85-21"></a><span class="co">#  V = 1, p-value = 0.0004883</span></span>
<span id="cb85-22"><a href="第八章-秩转换的非参数检验.html#cb85-22"></a><span class="co">#  alternative hypothesis: true location shift is less than 45.3</span></span>
<span id="cb85-23"><a href="第八章-秩转换的非参数检验.html#cb85-23"></a></span>
<span id="cb85-24"><a href="第八章-秩转换的非参数检验.html#cb85-24"></a><span class="kw">wilcox.test</span>(serum_df<span class="op">$</span>原法,serum_df<span class="op">$</span>新法,<span class="dt">mu=</span><span class="fl">45.3</span>,<span class="dt">paired =</span> T,<span class="dt">alternative =</span> <span class="kw">c</span>(<span class="st">&quot;less&quot;</span>),<span class="dt">exact=</span>F,<span class="dt">correct =</span> T)</span>
<span id="cb85-25"><a href="第八章-秩转换的非参数检验.html#cb85-25"></a><span class="co">##      Wilcoxon signed rank test with continuity correction</span></span>
<span id="cb85-26"><a href="第八章-秩转换的非参数检验.html#cb85-26"></a><span class="co">##  </span></span>
<span id="cb85-27"><a href="第八章-秩转换的非参数检验.html#cb85-27"></a><span class="co">##  data:  serum_df$原法 and serum_df$新法</span></span>
<span id="cb85-28"><a href="第八章-秩转换的非参数检验.html#cb85-28"></a><span class="co">##  V = 1, p-value = 0.001632</span></span>
<span id="cb85-29"><a href="第八章-秩转换的非参数检验.html#cb85-29"></a><span class="co">##  alternative hypothesis: true location shift is less than 45.3</span></span></code></pre></div>
<p>根据计算结果，p值&lt;0.05，因此拒绝原假设<span class="math inline">\(H_0\)</span>，接受<span class="math inline">\(H_1\)</span>，可以认为工人的尿氟比正常人的尿氟含量高。</p>
</div>
<div id="配对样本差值的中位数和0比较" class="section level3">
<h3><span class="header-section-number">8.1.3</span> 配对样本差值的中位数和0比较</h3>
<p>这里以案例8-1的数据进行测试，设置的原假设<span class="math inline">\(H_0:\)</span>两组数据的差值中位数等于0；备择假设<span class="math inline">\(H_1:\)</span>两组数据的差值中位数不等于0，是双侧检验；</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="第八章-秩转换的非参数检验.html#cb86-1"></a><span class="kw">library</span>(<span class="st">&quot;memisc&quot;</span>)</span>
<span id="cb86-2"><a href="第八章-秩转换的非参数检验.html#cb86-2"></a><span class="kw">library</span>(<span class="st">&quot;kableExtra&quot;</span>)</span>
<span id="cb86-3"><a href="第八章-秩转换的非参数检验.html#cb86-3"></a><span class="co">#读取数据</span></span>
<span id="cb86-4"><a href="第八章-秩转换的非参数检验.html#cb86-4"></a>serum&lt;-<span class="kw">spss.system.file</span>(<span class="st">&quot;ExampleData/SavData4MedSta/Exam08-01.sav&quot;</span>)</span>
<span id="cb86-5"><a href="第八章-秩转换的非参数检验.html#cb86-5"></a>serum_df&lt;-<span class="kw">as.data.frame</span>(<span class="kw">as.data.set</span>(serum))</span>
<span id="cb86-6"><a href="第八章-秩转换的非参数检验.html#cb86-6"></a></span>
<span id="cb86-7"><a href="第八章-秩转换的非参数检验.html#cb86-7"></a><span class="co"># 1 计算两种方法的差值</span></span>
<span id="cb86-8"><a href="第八章-秩转换的非参数检验.html#cb86-8"></a>diff_val&lt;-serum_df[,<span class="dv">1</span>]<span class="op">-</span>serum_df[,<span class="dv">2</span>]</span>
<span id="cb86-9"><a href="第八章-秩转换的非参数检验.html#cb86-9"></a><span class="co"># 2 省略diff_val中为0的对子数(网上的一些有的方法可能没有这一步),并计算差值的绝对值</span></span>
<span id="cb86-10"><a href="第八章-秩转换的非参数检验.html#cb86-10"></a>diff_no0&lt;-diff_val[<span class="kw">which</span>(diff_val <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>)]</span>
<span id="cb86-11"><a href="第八章-秩转换的非参数检验.html#cb86-11"></a>abs_diff_val&lt;-<span class="kw">abs</span>(diff_no0)</span>
<span id="cb86-12"><a href="第八章-秩转换的非参数检验.html#cb86-12"></a><span class="co"># 3 使用rank()函数计算差值绝对值的秩</span></span>
<span id="cb86-13"><a href="第八章-秩转换的非参数检验.html#cb86-13"></a>rank_vals&lt;-<span class="kw">rank</span>(abs_diff_val)</span>
<span id="cb86-14"><a href="第八章-秩转换的非参数检验.html#cb86-14"></a><span class="co"># 4 取正秩和或者负秩和</span></span>
<span id="cb86-15"><a href="第八章-秩转换的非参数检验.html#cb86-15"></a>sum_plusrank&lt;-<span class="kw">sum</span>(rank_vals[<span class="kw">which</span>(diff_no0 <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)])</span>
<span id="cb86-16"><a href="第八章-秩转换的非参数检验.html#cb86-16"></a>sum_minusrank&lt;-<span class="kw">sum</span>(rank_vals[<span class="kw">which</span>(diff_no0 <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>)])</span>
<span id="cb86-17"><a href="第八章-秩转换的非参数检验.html#cb86-17"></a><span class="co"># 5 确定有效对子数，即差值不为0的对子数, n</span></span>
<span id="cb86-18"><a href="第八章-秩转换的非参数检验.html#cb86-18"></a>n_<span class="dv">1</span>&lt;-<span class="kw">length</span>(diff_no0)</span>
<span id="cb86-19"><a href="第八章-秩转换的非参数检验.html#cb86-19"></a></span>
<span id="cb86-20"><a href="第八章-秩转换的非参数检验.html#cb86-20"></a><span class="co">#这里可以预先查看一下diff_no0的数据状况</span></span>
<span id="cb86-21"><a href="第八章-秩转换的非参数检验.html#cb86-21"></a><span class="kw">barplot</span>(diff_no0,<span class="dt">col=</span><span class="st">&quot;dark gray&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;Difference in Likert&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Frequency&quot;</span>)</span>
<span id="cb86-22"><a href="第八章-秩转换的非参数检验.html#cb86-22"></a></span>
<span id="cb86-23"><a href="第八章-秩转换的非参数检验.html#cb86-23"></a><span class="co">##使用psignrank()计算P值，需要注意的是符号秩时会连续分布，因此针对11.5/54.5这样的小鼠，在计算P值是否需要注意左侧右侧的边际问题</span></span>
<span id="cb86-24"><a href="第八章-秩转换的非参数检验.html#cb86-24"></a><span class="kw">psignrank</span>(sum_plusrank,n_<span class="dv">1</span>)<span class="op">+</span><span class="kw">psignrank</span>(sum_minusrank,n_<span class="dv">1</span>,<span class="dt">lower.tail =</span> F)</span>
<span id="cb86-25"><a href="第八章-秩转换的非参数检验.html#cb86-25"></a><span class="co"># [1] 0.0546875</span></span>
<span id="cb86-26"><a href="第八章-秩转换的非参数检验.html#cb86-26"></a><span class="kw">psignrank</span>(sum_plusrank,n_<span class="dv">1</span>)<span class="op">*</span><span class="dv">2</span></span>
<span id="cb86-27"><a href="第八章-秩转换的非参数检验.html#cb86-27"></a><span class="co"># [1] 0.06738281</span></span>
<span id="cb86-28"><a href="第八章-秩转换的非参数检验.html#cb86-28"></a><span class="kw">psignrank</span>(sum_minusrank,n_<span class="dv">1</span>,<span class="dt">lower.tail =</span> F)<span class="op">*</span><span class="dv">2</span></span>
<span id="cb86-29"><a href="第八章-秩转换的非参数检验.html#cb86-29"></a><span class="co"># [1] 0.04199219</span></span>
<span id="cb86-30"><a href="第八章-秩转换的非参数检验.html#cb86-30"></a></span>
<span id="cb86-31"><a href="第八章-秩转换的非参数检验.html#cb86-31"></a><span class="co">##或者使用wilcox.test()函数工具，对于N小于20的样本，一般采用exact=T计算</span></span>
<span id="cb86-32"><a href="第八章-秩转换的非参数检验.html#cb86-32"></a><span class="kw">wilcox.test</span>(serum_df<span class="op">$</span>原法,serum_df<span class="op">$</span>新法,<span class="dt">mu=</span><span class="dv">0</span>,<span class="dt">paired =</span> T,<span class="dt">alternative =</span> <span class="kw">c</span>(<span class="st">&quot;two.sided&quot;</span>),<span class="dt">exact=</span>T,<span class="dt">correct =</span> F)</span>
<span id="cb86-33"><a href="第八章-秩转换的非参数检验.html#cb86-33"></a><span class="co">##  Wilcoxon signed rank test</span></span>
<span id="cb86-34"><a href="第八章-秩转换的非参数检验.html#cb86-34"></a><span class="co">## </span></span>
<span id="cb86-35"><a href="第八章-秩转换的非参数检验.html#cb86-35"></a><span class="co">## data:  serum_df$原法 and serum_df$新法</span></span>
<span id="cb86-36"><a href="第八章-秩转换的非参数检验.html#cb86-36"></a><span class="co">## V = 11.5, p-value = 0.05581</span></span>
<span id="cb86-37"><a href="第八章-秩转换的非参数检验.html#cb86-37"></a><span class="co">## alternative hypothesis: true location shift is not equal to 0</span></span>
<span id="cb86-38"><a href="第八章-秩转换的非参数检验.html#cb86-38"></a><span class="co">## </span></span>
<span id="cb86-39"><a href="第八章-秩转换的非参数检验.html#cb86-39"></a><span class="co">## Warning messages:</span></span>
<span id="cb86-40"><a href="第八章-秩转换的非参数检验.html#cb86-40"></a><span class="co">## 1: In wilcox.test.default(serum_df$原法, serum_df$新法, mu = 0, paired = T,  :</span></span>
<span id="cb86-41"><a href="第八章-秩转换的非参数检验.html#cb86-41"></a><span class="co">##   无法精確計算带连结的p值</span></span>
<span id="cb86-42"><a href="第八章-秩转换的非参数检验.html#cb86-42"></a><span class="co">## 2: In wilcox.test.default(serum_df$原法, serum_df$新法, mu = 0, paired = T,  :</span></span>
<span id="cb86-43"><a href="第八章-秩转换的非参数检验.html#cb86-43"></a><span class="co">##   有0时无法計算精確的p值</span></span>
<span id="cb86-44"><a href="第八章-秩转换的非参数检验.html#cb86-44"></a></span>
<span id="cb86-45"><a href="第八章-秩转换的非参数检验.html#cb86-45"></a><span class="kw">wilcox.test</span>(serum_df<span class="op">$</span>原法,serum_df<span class="op">$</span>新法,<span class="dt">mu=</span><span class="dv">0</span>,<span class="dt">paired =</span> T,<span class="dt">alternative =</span> <span class="kw">c</span>(<span class="st">&quot;two.sided&quot;</span>),<span class="dt">exact=</span>F,<span class="dt">correct =</span> T)</span>
<span id="cb86-46"><a href="第八章-秩转换的非参数检验.html#cb86-46"></a><span class="co">##  Wilcoxon signed rank test with continuity correction</span></span>
<span id="cb86-47"><a href="第八章-秩转换的非参数检验.html#cb86-47"></a><span class="co">## </span></span>
<span id="cb86-48"><a href="第八章-秩转换的非参数检验.html#cb86-48"></a><span class="co">## data:  serum_df$原法 and serum_df$新法</span></span>
<span id="cb86-49"><a href="第八章-秩转换的非参数检验.html#cb86-49"></a><span class="co">## V = 11.5, p-value = 0.06175</span></span>
<span id="cb86-50"><a href="第八章-秩转换的非参数检验.html#cb86-50"></a><span class="co">## alternative hypothesis: true location shift is not equal to 0</span></span></code></pre></div>
<p>根据计算结果，p值&gt;0.05，因此不拒绝原假设<span class="math inline">\(H_0\)</span>，即还不能认为两种方法有差异。</p>
<div id="配对的等级资料的中位数和0比较" class="section level4">
<h4><span class="header-section-number">8.1.3.1</span> 配对的等级资料的中位数和0比较</h4>
<p>符号秩检验若用于配对的等级资料，则先把等级从弱到强转换成秩(1， 2，3，…)；然后求各对秩的差值，省略所有差值为0的对子数，
令余下的有效对子数为;最后按n个差值编正秩和负秩，求正秩和或负 秩和。但对于等级资料，相同秩多，
小样本的检验结果会存在偏性，最好用大样本。</p>
<p><font color="red">此处的R代码待后续有合适的测试数据再补充。</font></p>
</div>
<div id="正态近似法-4" class="section level4">
<h4><span class="header-section-number">8.1.3.2</span> 正态近似法</h4>
<p>对于n&gt;50的情况，根据中心极限定理，可以采用正态近似法做<span class="math inline">\(u\)</span>检验，按照下式计算u值：
<span class="math display">\[u=\frac{T-n(n+1)/4}{\sqrt{\frac{n(n+1)(2n+1)}{24}-\frac{\sum(t_j^3-t_j)}{48}}}\]</span>
其中<span class="math inline">\(t_j(j=1,2,...)\)</span>为第j个相同秩的个数，T即为按照符号秩计算的统计量。</p>
<p><font color="red">此处的R代码待后续有合适的测试数据再补充。</font></p>
</div>
</div>
</div>
<div id="两个独立样本的比较的wilcoxon秩和检验" class="section level2">
<h2><span class="header-section-number">8.2</span> 两个独立样本的比较的Wilcoxon秩和检验</h2>
<p>Wilcoxon 秩和检验(Wilcoxon rink sum test)，用于推断计量资料或等级资料的两个独立样本所来自的
两个总体分布是否有差别。</p>
<p>在理论上检验假设<span class="math inline">\(H_0\)</span>应为两个总体分布相同，即两个样本来自同一总体。由 于秩和检验对两个总体分布的形状差别不敏感，
对于<strong>位置</strong>相同、形状不同但类似的两个总体分布，如均数 相等、方差不等的两个正态分布，推断不出两个总体分布(形状)
有差别，故对立的各择假设<span class="math inline">\(H_1\)</span>不能为两 个总体分布不同，而只能为两个总体分布位置不同(对单侧检验可写作某个
总体分布位置比另一个总体分 布位置要右或要左一些)。考虑到对方差不等、即总体分布不同的两个正态分布，可用秩
和检验来推断两 个总体分布位置是否有差别，故在实际应用中检验假设<span class="math inline">\(H_0\)</span>可写作两个总体分布位置相同。总之，不管两
个总体分布的形状有无差别，<strong>秩和检验的目的是推断两个总体分布的位置是否有差别，这正是实践中所需要的</strong>，
如要推断两个不同人群的某项指标值的大小是否有差别或哪个人群的大，可用其指标值分布的位置差别反映，
而不关心其指标值分布的形状有无差别。两个总体分布位置相同或不同，实际情况一般是两个
总体分布形状相同或 类似，这时可简化为两个总体中位数相等或不等。注意的是，理论上一个总体分布为正偏态、
另一个总体分布为负偏态时，也可能两个总体中位数相等，这时认为正偏态总体分布位置比负偏态总体分布位置要右一些。</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="第七章-chi2检验.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "Sepia",
"family": "serif",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/07-Nonparametrictest.rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"search": true,
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
