<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 第六章 计数资料的统计描述 | MedicalStatisNotes.utf8</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content=" 第六章 计数资料的统计描述 | MedicalStatisNotes.utf8" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 第六章 计数资料的统计描述 | MedicalStatisNotes.utf8" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="第五章-计数资料的统计描述.html"/>
<link rel="next" href="第七章-chi2检验.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://wxhyihuan.github.io/">医学统计学笔记与R语言</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> 简介与传送门</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#简介"><i class="fa fa-check"></i><b>1.1</b> 简介</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#软件准备"><i class="fa fa-check"></i><b>1.1.1</b> 软件准备</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#传送门"><i class="fa fa-check"></i><b>1.2</b> 传送门</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#致谢"><i class="fa fa-check"></i><b>1.3</b> 致谢</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#声明"><i class="fa fa-check"></i><b>1.4</b> 声明</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html"><i class="fa fa-check"></i><b>2</b> 第二章 计量资料的统计描述</a><ul>
<li class="chapter" data-level="2.1" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#描述统计"><i class="fa fa-check"></i><b>2.1</b> 描述统计</a></li>
<li class="chapter" data-level="2.2" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#测试数据"><i class="fa fa-check"></i><b>2.2</b> 测试数据</a></li>
<li class="chapter" data-level="2.3" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#数据输入和频率统计"><i class="fa fa-check"></i><b>2.3</b> 数据输入和频率统计</a><ul>
<li class="chapter" data-level="2.3.1" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#读取数据并将数据转换成单列形式"><i class="fa fa-check"></i><b>2.3.1</b> 读取数据，并将数据转换成单列形式</a></li>
<li class="chapter" data-level="2.3.2" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#计算极差-maxminrange"><i class="fa fa-check"></i><b>2.3.2</b> 计算极差, max()/min()/range()</a></li>
<li class="chapter" data-level="2.3.3" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#确定组段数和组距"><i class="fa fa-check"></i><b>2.3.3</b> 确定组段数和组距</a></li>
<li class="chapter" data-level="2.3.4" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#计算频数分布"><i class="fa fa-check"></i><b>2.3.4</b> 计算频数分布</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#描述性统计的度量"><i class="fa fa-check"></i><b>2.4</b> 描述性统计的度量</a><ul>
<li class="chapter" data-level="2.4.1" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#算术平均值"><i class="fa fa-check"></i><b>2.4.1</b> 算术平均值</a></li>
<li class="chapter" data-level="2.4.2" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#几何平均值"><i class="fa fa-check"></i><b>2.4.2</b> 几何平均值</a></li>
<li class="chapter" data-level="2.4.3" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#中位数与百分位数"><i class="fa fa-check"></i><b>2.4.3</b> 中位数与百分位数</a></li>
<li class="chapter" data-level="2.4.4" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#极差"><i class="fa fa-check"></i><b>2.4.4</b> 极差</a></li>
<li class="chapter" data-level="2.4.5" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#四分位间距"><i class="fa fa-check"></i><b>2.4.5</b> 四分位间距</a></li>
<li class="chapter" data-level="2.4.6" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#方差与标准差"><i class="fa fa-check"></i><b>2.4.6</b> 方差与标准差</a></li>
<li class="chapter" data-level="2.4.7" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#变异系数"><i class="fa fa-check"></i><b>2.4.7</b> 变异系数</a></li>
<li class="chapter" data-level="2.4.8" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#其他的描述统计"><i class="fa fa-check"></i><b>2.4.8</b> 其他的描述统计</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#正态分布和标准正态分布"><i class="fa fa-check"></i><b>2.5</b> 正态分布和标准正态分布</a><ul>
<li class="chapter" data-level="2.5.1" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#概率密度函数dnorm"><i class="fa fa-check"></i><b>2.5.1</b> 概率密度函数dnorm()</a></li>
<li class="chapter" data-level="2.5.2" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#概率累积分布函数pnorm"><i class="fa fa-check"></i><b>2.5.2</b> 概率累积分布函数pnorm()</a></li>
<li class="chapter" data-level="2.5.3" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#正态分位函数qnorm"><i class="fa fa-check"></i><b>2.5.3</b> 正态分位函数qnorm()</a></li>
<li class="chapter" data-level="2.5.4" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#生成正态分布函数rnorm"><i class="fa fa-check"></i><b>2.5.4</b> 生成正态分布函数rnorm()</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#正态分布检验"><i class="fa fa-check"></i><b>2.6</b> 正态分布检验</a><ul>
<li class="chapter" data-level="2.6.1" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#直方图"><i class="fa fa-check"></i><b>2.6.1</b> 直方图</a></li>
<li class="chapter" data-level="2.6.2" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#概率密度图"><i class="fa fa-check"></i><b>2.6.2</b> 概率密度图</a></li>
<li class="chapter" data-level="2.6.3" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#qq-plot"><i class="fa fa-check"></i><b>2.6.3</b> QQ-plot</a></li>
<li class="chapter" data-level="2.6.4" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#正态检验"><i class="fa fa-check"></i><b>2.6.4</b> 正态检验</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html"><i class="fa fa-check"></i><b>3</b> 第三章 总体均数的估计与假设检验</a><ul>
<li class="chapter" data-level="3.1" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#推论统计"><i class="fa fa-check"></i><b>3.1</b> 推论统计</a><ul>
<li class="chapter" data-level="3.1.1" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#参数估计与假设检验"><i class="fa fa-check"></i><b>3.1.1</b> 参数估计与假设检验</a></li>
<li class="chapter" data-level="3.1.2" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#统计量与标准误"><i class="fa fa-check"></i><b>3.1.2</b> 统计量与标准误</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#t-分布"><i class="fa fa-check"></i><b>3.2</b> <em>t</em> 分布</a><ul>
<li class="chapter" data-level="3.2.1" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#概率密度函数dt"><i class="fa fa-check"></i><b>3.2.1</b> 概率密度函数dt()</a></li>
<li class="chapter" data-level="3.2.2" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#概率累积分布函数pt"><i class="fa fa-check"></i><b>3.2.2</b> 概率累积分布函数pt()</a></li>
<li class="chapter" data-level="3.2.3" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#求置信区间的qt"><i class="fa fa-check"></i><b>3.2.3</b> 求置信区间的qt()</a></li>
<li class="chapter" data-level="3.2.4" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#指定t分布函数rt"><i class="fa fa-check"></i><b>3.2.4</b> 指定t分布函数rt()</a></li>
<li class="chapter" data-level="3.2.5" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#参数估计"><i class="fa fa-check"></i><b>3.2.5</b> 参数估计</a></li>
<li class="chapter" data-level="3.2.6" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#假设检验"><i class="fa fa-check"></i><b>3.2.6</b> 假设检验</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#t-检验的分类及应用"><i class="fa fa-check"></i><b>3.3</b> <em>t</em> 检验的分类及应用</a><ul>
<li class="chapter" data-level="3.3.1" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#t检验与z检验"><i class="fa fa-check"></i><b>3.3.1</b> <em>t</em>检验与Z检验</a></li>
<li class="chapter" data-level="3.3.2" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#单样本t检验"><i class="fa fa-check"></i><b>3.3.2</b> 单样本<em>t</em>检验</a></li>
<li class="chapter" data-level="3.3.3" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#配对样本t检验"><i class="fa fa-check"></i><b>3.3.3</b> 配对样本<em>t</em>检验</a></li>
<li class="chapter" data-level="3.3.4" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#两种独立样本t检验"><i class="fa fa-check"></i><b>3.3.4</b> 两种独立样本t检验</a></li>
<li class="chapter" data-level="3.3.5" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#两样本方差齐性检验"><i class="fa fa-check"></i><b>3.3.5</b> 两样本方差齐性检验</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#变量转换"><i class="fa fa-check"></i><b>3.4</b> 变量转换</a><ul>
<li class="chapter" data-level="3.4.1" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#对数变换"><i class="fa fa-check"></i><b>3.4.1</b> 对数变换</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html"><i class="fa fa-check"></i><b>4</b> 第四章 多个样本均数比较的方差分析</a><ul>
<li class="chapter" data-level="4.1" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#f分布"><i class="fa fa-check"></i><b>4.1</b> <em>F</em>分布</a></li>
<li class="chapter" data-level="4.2" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#f检验的分类原理及应用"><i class="fa fa-check"></i><b>4.2</b> <em>F</em>检验的分类、原理及应用</a><ul>
<li class="chapter" data-level="4.2.1" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#分类"><i class="fa fa-check"></i><b>4.2.1</b> 分类</a></li>
<li class="chapter" data-level="4.2.2" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#原理"><i class="fa fa-check"></i><b>4.2.2</b> 原理</a></li>
<li class="chapter" data-level="4.2.3" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#单因子方差分析"><i class="fa fa-check"></i><b>4.2.3</b> 单因子方差分析</a></li>
<li class="chapter" data-level="4.2.4" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#双因子方差分析"><i class="fa fa-check"></i><b>4.2.4</b> 双因子方差分析</a></li>
<li class="chapter" data-level="4.2.5" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#拉丁方设计资料的方差分析"><i class="fa fa-check"></i><b>4.2.5</b> 拉丁方设计资料的方差分析</a></li>
<li class="chapter" data-level="4.2.6" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#两阶段交叉设计资料的方差分析"><i class="fa fa-check"></i><b>4.2.6</b> 两阶段交叉设计资料的方差分析</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#方差分析的诊断图"><i class="fa fa-check"></i><b>4.3</b> 方差分析的诊断图</a></li>
<li class="chapter" data-level="4.4" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#多个样本均数间的多重比较"><i class="fa fa-check"></i><b>4.4</b> 多个样本均数间的多重比较</a></li>
<li class="chapter" data-level="4.5" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#多样本方差齐性检验"><i class="fa fa-check"></i><b>4.5</b> 多样本方差齐性检验</a><ul>
<li class="chapter" data-level="4.5.1" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#bartletts-检验"><i class="fa fa-check"></i><b>4.5.1</b> Bartlett’s 检验</a></li>
<li class="chapter" data-level="4.5.2" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#levenes-检验"><i class="fa fa-check"></i><b>4.5.2</b> Levene’s 检验</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html"><i class="fa fa-check"></i><b>5</b> 第五章 计数资料的统计描述</a><ul>
<li class="chapter" data-level="5.1" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#常用相对数"><i class="fa fa-check"></i><b>5.1</b> 常用相对数</a><ul>
<li class="chapter" data-level="5.1.1" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#强度相对数"><i class="fa fa-check"></i><b>5.1.1</b> 强度相对数</a></li>
<li class="chapter" data-level="5.1.2" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#结构相对数"><i class="fa fa-check"></i><b>5.1.2</b> 结构相对数</a></li>
<li class="chapter" data-level="5.1.3" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#相对比"><i class="fa fa-check"></i><b>5.1.3</b> 相对比</a></li>
<li class="chapter" data-level="5.1.4" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#应用相对数的注意点"><i class="fa fa-check"></i><b>5.1.4</b> 应用相对数的注意点</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#率的标准化"><i class="fa fa-check"></i><b>5.2</b> 率的标准化</a><ul>
<li class="chapter" data-level="5.2.1" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#标准化率的计算"><i class="fa fa-check"></i><b>5.2.1</b> 标准化率的计算</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#动态数列及其指标分析"><i class="fa fa-check"></i><b>5.3</b> 动态数列及其指标分析</a><ul>
<li class="chapter" data-level="5.3.1" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#绝对增长量"><i class="fa fa-check"></i><b>5.3.1</b> 绝对增长量</a></li>
<li class="chapter" data-level="5.3.2" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#发展速度与增长速度"><i class="fa fa-check"></i><b>5.3.2</b> 发展速度与增长速度</a></li>
<li class="chapter" data-level="5.3.3" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#平均发展速度与平均增长速度"><i class="fa fa-check"></i><b>5.3.3</b> 平均发展速度与平均增长速度</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html"><i class="fa fa-check"></i><b>6</b> 第六章 计数资料的统计描述</a><ul>
<li class="chapter" data-level="6.1" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#二项分布"><i class="fa fa-check"></i><b>6.1</b> 二项分布</a><ul>
<li class="chapter" data-level="6.1.1" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#二项分布的性质"><i class="fa fa-check"></i><b>6.1.1</b> 二项分布的性质</a></li>
<li class="chapter" data-level="6.1.2" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#二项分布的应用"><i class="fa fa-check"></i><b>6.1.2</b> 二项分布的应用</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#泊松分布"><i class="fa fa-check"></i><b>6.2</b> 泊松分布</a><ul>
<li class="chapter" data-level="6.2.1" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#泊松分布的性质"><i class="fa fa-check"></i><b>6.2.1</b> 泊松分布的性质</a></li>
<li class="chapter" data-level="6.2.2" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#泊松分布的应用"><i class="fa fa-check"></i><b>6.2.2</b> 泊松分布的应用</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#负二项分布"><i class="fa fa-check"></i><b>6.3</b> 负二项分布</a><ul>
<li class="chapter" data-level="6.3.1" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#负二项分布的性质"><i class="fa fa-check"></i><b>6.3.1</b> 负二项分布的性质</a></li>
<li class="chapter" data-level="6.3.2" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#负二项分布的参数估计"><i class="fa fa-check"></i><b>6.3.2</b> 负二项分布的参数估计</a></li>
<li class="chapter" data-level="6.3.3" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#负二项分布的应用"><i class="fa fa-check"></i><b>6.3.3</b> 负二项分布的应用</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html"><i class="fa fa-check"></i><b>7</b> 第七章 <span class="math inline">\(\chi^2\)</span>检验</a><ul>
<li class="chapter" data-level="7.1" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#卡方分布"><i class="fa fa-check"></i><b>7.1</b> 卡方分布</a><ul>
<li class="chapter" data-level="7.1.1" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#概率密度函数"><i class="fa fa-check"></i><b>7.1.1</b> 概率密度函数</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#卡方检验"><i class="fa fa-check"></i><b>7.2</b> 卡方检验</a><ul>
<li class="chapter" data-level="7.2.1" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#卡方独立性检验的基本思想"><i class="fa fa-check"></i><b>7.2.1</b> 卡方独立性检验的基本思想</a></li>
<li class="chapter" data-level="7.2.2" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#四格资料表的卡方检验"><i class="fa fa-check"></i><b>7.2.2</b> 四格资料表的卡方检验</a></li>
<li class="chapter" data-level="7.2.3" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#配对的四格资料表的卡方检验"><i class="fa fa-check"></i><b>7.2.3</b> 配对的四格资料表的卡方检验</a></li>
<li class="chapter" data-level="7.2.4" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#四格资料表的fisher确切概率法"><i class="fa fa-check"></i><b>7.2.4</b> 四格资料表的Fisher确切概率法</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#行列资料表的卡方检验"><i class="fa fa-check"></i><b>7.3</b> 行列资料表的卡方检验</a><ul>
<li class="chapter" data-level="7.3.1" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#多个样本率的比较r-times-2表"><i class="fa fa-check"></i><b>7.3.1</b> 多个样本率的比较(<span class="math inline">\(R \times 2\)</span>表)</a></li>
<li class="chapter" data-level="7.3.2" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#样本构成比的比较2-times-c表"><i class="fa fa-check"></i><b>7.3.2</b> 样本构成比的比较(<span class="math inline">\(2 \times C\)</span>表)</a></li>
<li class="chapter" data-level="7.3.3" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#双向无序分组资料的关联性检验"><i class="fa fa-check"></i><b>7.3.3</b> 双向无序分组资料的关联性检验</a></li>
<li class="chapter" data-level="7.3.4" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#双向有序分组资料的线性趋势检验"><i class="fa fa-check"></i><b>7.3.4</b> 双向有序分组资料的线性趋势检验</a></li>
<li class="chapter" data-level="7.3.5" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#卡方检验的注意事项与选择思路"><i class="fa fa-check"></i><b>7.3.5</b> 卡方检验的注意事项与选择思路</a></li>
<li class="chapter" data-level="7.3.6" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#多个样本率的多重比较"><i class="fa fa-check"></i><b>7.3.6</b> 多个样本率的多重比较</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#cochran-mantel-haenszel卡方统计量检验"><i class="fa fa-check"></i><b>7.4</b> Cochran-Mantel-Haenszel卡方统计量检验</a></li>
<li class="chapter" data-level="7.5" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#频数分布的拟合优度检验"><i class="fa fa-check"></i><b>7.5</b> 频数分布的拟合优度检验</a><ul>
<li class="chapter" data-level="7.5.1" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#观察数据的无分布预期"><i class="fa fa-check"></i><b>7.5.1</b> 观察数据的无分布预期</a></li>
<li class="chapter" data-level="7.5.2" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#观察数据的有预期分布"><i class="fa fa-check"></i><b>7.5.2</b> 观察数据的有预期分布</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html"><i class="fa fa-check"></i><b>8</b> 第八章 秩转换的非参数检验</a><ul>
<li class="chapter" data-level="8.1" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html#wilcoxon符号秩检验"><i class="fa fa-check"></i><b>8.1</b> Wilcoxon符号秩检验</a><ul>
<li class="chapter" data-level="8.1.1" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html#wilcoxon符号秩检验的原理与过程"><i class="fa fa-check"></i><b>8.1.1</b> Wilcoxon符号秩检验的原理与过程</a></li>
<li class="chapter" data-level="8.1.2" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html#单组样本与总体的中位数的wilcoxon符号秩检验"><i class="fa fa-check"></i><b>8.1.2</b> 单组样本与总体的中位数的Wilcoxon符号秩检验</a></li>
<li class="chapter" data-level="8.1.3" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html#配对样本差值的中位数和0比较"><i class="fa fa-check"></i><b>8.1.3</b> 配对样本差值的中位数和0比较</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html#wilcoxon秩和检验"><i class="fa fa-check"></i><b>8.2</b> Wilcoxon秩和检验</a><ul>
<li class="chapter" data-level="8.2.1" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html#wilcoxon秩和检验的原理与过程"><i class="fa fa-check"></i><b>8.2.1</b> Wilcoxon秩和检验的原理与过程</a></li>
<li class="chapter" data-level="8.2.2" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html#连续型资料的两样本比较"><i class="fa fa-check"></i><b>8.2.2</b> 连续型资料的两样本比较</a></li>
<li class="chapter" data-level="8.2.3" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html#非连续型资料的两样本比较"><i class="fa fa-check"></i><b>8.2.3</b> 非连续型资料的两样本比较</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html#完全随即设计多个样本比较的kruskal-wallis-h-检验"><i class="fa fa-check"></i><b>8.3</b> 完全随即设计多个样本比较的Kruskal-Wallis H 检验</a><ul>
<li class="chapter" data-level="8.3.1" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html#原始数据的多个样本比较"><i class="fa fa-check"></i><b>8.3.1</b> 原始数据的多个样本比较</a></li>
<li class="chapter" data-level="8.3.2" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html#频数表资料和登记资料的多个样本比较"><i class="fa fa-check"></i><b>8.3.2</b> 频数表资料和登记资料的多个样本比较</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html#多个独立样本两两比较的nemenyi法检验"><i class="fa fa-check"></i><b>8.4</b> 多个独立样本两两比较的Nemenyi法检验</a></li>
<li class="chapter" data-level="8.5" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html#随机区组设计多个相关样本的friedman-m-检验"><i class="fa fa-check"></i><b>8.5</b> 随机区组设计多个相关样本的Friedman M 检验</a><ul>
<li class="chapter" data-level="8.5.1" data-path="第八章-秩转换的非参数检验.html"><a href="第八章-秩转换的非参数检验.html#多个相关样本的两两比较"><i class="fa fa-check"></i><b>8.5.1</b> 多个相关样本的两两比较</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="双变量回归与相关.html"><a href="双变量回归与相关.html"><i class="fa fa-check"></i><b>9</b> 双变量回归与相关</a><ul>
<li class="chapter" data-level="9.1" data-path="双变量回归与相关.html"><a href="双变量回归与相关.html#直线回归"><i class="fa fa-check"></i><b>9.1</b> 直线回归</a></li>
<li class="chapter" data-level="9.2" data-path="双变量回归与相关.html"><a href="双变量回归与相关.html#直线回归中的统计推断"><i class="fa fa-check"></i><b>9.2</b> 直线回归中的统计推断</a><ul>
<li class="chapter" data-level="9.2.1" data-path="双变量回归与相关.html"><a href="双变量回归与相关.html#方差分析"><i class="fa fa-check"></i><b>9.2.1</b> 方差分析</a></li>
<li class="chapter" data-level="9.2.2" data-path="双变量回归与相关.html"><a href="双变量回归与相关.html#t检验-1"><i class="fa fa-check"></i><b>9.2.2</b> t检验</a></li>
<li class="chapter" data-level="9.2.3" data-path="双变量回归与相关.html"><a href="双变量回归与相关.html#总体回归系数β的可信区间"><i class="fa fa-check"></i><b>9.2.3</b> 总体回归系数β的可信区间</a></li>
<li class="chapter" data-level="9.2.4" data-path="双变量回归与相关.html"><a href="双变量回归与相关.html#利用回归方程进行估计和预测"><i class="fa fa-check"></i><b>9.2.4</b> 利用回归方程进行估计和预测</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="第六章-计数资料的统计描述" class="section level1">
<h1><span class="header-section-number"> </span> 第六章 计数资料的统计描述</h1>
<p>日期: 2020-11-24
作者：wxhyihuan</p>
<p>随机变量有连续型和离散型之分，相应的概率分布就可分为连续型分布(如 u分布、t分布和F分布)和离散型分布，常用的离散型分布有 二项分布、泊松分布，负二项分布，多项分布。</p>
<div id="二项分布" class="section level2">
<h2><span class="header-section-number">6.1</span> 二项分布</h2>
<p>二项分布(Binomial distribution)是<span class="math inline">\(n\)</span>个独立的 成功/失败(或阴/阳，或是/非) 试验中“成功”的次数<span class="math inline">\(X\)</span>(即取值[0~n]之间)的离散概率分布，其中每次试验的“成功”概率为<span class="math inline">\(p\)</span>，记为B(n,p)。这样的<strong>单次</strong>成功/失败试验又称为伯努利试验，即当<span class="math inline">\(n = 1\)</span>时，二项分布就是<a href="https://zh.wikipedia.org/wiki/%E4%BC%AF%E5%8A%AA%E5%88%A9%E5%88%86%E5%B8%83">伯努利分布，0-1分布</a>。二项分布是显著性差异的二项试验的基础。一般地，如果随机变量<span class="math inline">\(X\)</span>(即取值[0~n]之间)服从参数为<span class="math inline">\(n\)</span>和<span class="math inline">\(p\)</span>的二项分布时，那么<span class="math inline">\(n\)</span>次试验中正好得到<span class="math inline">\(x\)</span>次成功的<a href="https://zh.wikipedia.org/wiki/%E6%A6%82%E7%8E%87%E8%B4%A8%E9%87%8F%E5%87%BD%E6%95%B0">概率质量函数</a>即为：
<span class="math display">\[\begin{aligned}
 f(x,n,p)=P(x,n,p) &amp; = \binom{x}{n}p^x(1-p)^{n-x} \\
 &amp; = \frac{n!}{x!(n-x)!}p^x(1-p)^{n-x}, x\in[0,n]
 \end{aligned}\]</span>
P(x)就是<a href="https://zh.wikipedia.org/wiki/%E4%BA%8C%E9%A1%B9%E5%BC%8F%E5%AE%9A%E7%90%86">二项式</a><span class="math inline">\([p+(1-p)]^n\)</span>展开式的通项，<span class="math inline">\(n!/x!(n-x)!\)</span>为二项系数，且<span class="math inline">\(\sum_{x=0}^nP(x)=1\)</span>。</p>
<p><strong>注意</strong></p>
<p>对二项分布的资料进行抽样时，如果是有返回(放回)随机抽去n个个体，则依旧是刚才的<span class="math inline">\(P(x)\)</span>分布函数；如果时无返回(不放回)的随机抽样，自由当n远小于总体个数N(如n &lt; N/10)时，也可做近似<span class="math inline">\(P(x)\)</span>分布函数处理。</p>
<p><strong>适用的条件</strong></p>
<ol style="list-style-type: decimal">
<li>每次实验结果只有发生和不发生两种情形(如成功/失败)，且每次实验中，成功/失败事件发生的概率都相同</li>
<li>重复实验是相互独立</li>
</ol>
<div id="二项分布的性质" class="section level3">
<h3><span class="header-section-number">6.1.1</span> 二项分布的性质</h3>
<div id="均数与标准差" class="section level4">
<h4><span class="header-section-number">6.1.1.1</span> 均数与标准差</h4>
<p><strong>1.“成功”次数的性质</strong></p>
<p><strong>X的总体均数标准差</strong></p>
<p>在n次独立重复实验中，出现“成功”次数X的总体均数，方差和标准差分别是，
X的总体均数：
<span class="math display">\[μ=np\]</span>
X的总方差：
<span class="math display">\[σ^2=np(1-p)\]</span>
X的总标准差：
<span class="math display">\[σ=\sqrt{np(1-p)}\]</span></p>
<p><strong>率p的总体均数标准差</strong>
在n次独立重复实验中，出现“成功”次数的率p(p=0/n,1/n,2/n…,n/n])的总体均数，方差和标准差分别是，
“成功”次数的率p的总体均数：
<span class="math display">\[μ_p=p\]</span></p>
<p>“成功”次数的率p的总方差：
<span class="math display">\[σ^2=\frac{p(1-p)}{n}=Var_p\]</span></p>
<p>“成功”次数的率p的总标准差：
<span class="math display">\[σ=\sqrt{\frac{p(1-p)}{n}}=S_p\]</span></p>
<p>一般的，总体的p往往不知道，因此用样本资料计算样本的“成功”率<span class="math inline">\(p=X/n\)</span>，来计算<span class="math inline">\(Var_p和S_p\)</span>。</p>
</div>
<div id="二项分布的图像" class="section level4">
<h4><span class="header-section-number">6.1.1.2</span> 二项分布的图像</h4>
<p>二项分布的图像偏态主要由p和n决定：</p>
<ol style="list-style-type: decimal">
<li>当p=0.5时，分布呈对称分布</li>
<li>当p≠0.5时，图形呈偏态，随着n增大，分布呈逐渐趋向于对称</li>
<li>当p不太靠近0或1，n-&gt;∞时，分布呈近似于正态分布</li>
</ol>
</div>
<div id="与其他分布的关系" class="section level4">
<h4><span class="header-section-number">6.1.1.3</span> 与其他分布的关系</h4>
<ol style="list-style-type: decimal">
<li>伯努利分布是二项分布在n=1时的特殊情况。X~ B(1,p)与X~ Bern(p)的意思是相同的。相反，任何二项分布B(n,p)都是n次独立伯努利试验的和，每次试验成功的概率为p。</li>
<li>泊松近似 当试验的次数n-&gt;∞，而乘积np固定时，二项分布收敛于<a href="https://zh.wikipedia.org/zh-hans/%E6%B3%8A%E6%9D%BE%E5%88%86%E4%BD%88">泊松分布</a>。因此参数为λ=np的泊松分布可以作为二项分布B(n,p)的近似，近似成立的前提要求n足够大，而p足够小，np不是很小。</li>
<li>正态近似 如果n足够大，那么分布的偏度就比较小。在这种情况下，如果使用适当的连续性校正，那么B(n,p)的一个很好的近似是正态分布:N(np,np(1-p))。当n越大（至少20）且p不接近0或1时近似效果更好。不同的经验法则可以用来决定n是否足够大,以及p是否距离0或1足够远,其中一个常用的规则是np和n(1 −p)都必须大于5。</li>
</ol>
</div>
</div>
<div id="二项分布的应用" class="section level3">
<h3><span class="header-section-number">6.1.2</span> 二项分布的应用</h3>
<p>利用二项分布及其正态近似性，可进行总体率的区间估计和差异推断，也可用于研究非遗传性疾病的家族集聚性和做群检验。对于二分类事物的构成问题，对其中一类的构成比进行统计推断，其方法则类似总体率。</p>
<div id="总体率的估计" class="section level4">
<h4><span class="header-section-number">6.1.2.1</span> 总体率的估计</h4>
<div id="精确法直接法" class="section level5">
<h5><span class="header-section-number">6.1.2.1.1</span> 精确法/直接法</h5>
<p>对于n≤50的小样本资料，用查表法可以获取百分率的可信区间，即了得到其总体的1-α(α一般取0.05，或0.01)的可信区间。</p>
<p>R语言中的二项分布相关的函数与之前介绍的连续性分布(u分布，t分布和f分布)类似，主要有
<a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/Binomial.html">dbinom(),pbinom(),qbinom()和rbinom()</a>。
用于进行参数估计和假设检验的函数主要有<a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/binom.test.html">binom.test()</a>。</p>
<p>使用《医学统计学》中的 案例6-2 的数据在R中进行二项分布的精确法/查表法分析测试。</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="第六章-计数资料的统计描述.html#cb52-1"></a>n &lt;-<span class="st"> </span><span class="dv">13</span></span>
<span id="cb52-2"><a href="第六章-计数资料的统计描述.html#cb52-2"></a>x &lt;-<span class="st"> </span><span class="dv">6</span></span>
<span id="cb52-3"><a href="第六章-计数资料的统计描述.html#cb52-3"></a>ratio &lt;-<span class="st"> </span>x<span class="op">/</span>n</span>
<span id="cb52-4"><a href="第六章-计数资料的统计描述.html#cb52-4"></a><span class="kw">binom.test</span>(x, n, <span class="dt">p =</span> <span class="fl">0.5</span>)</span>
<span id="cb52-5"><a href="第六章-计数资料的统计描述.html#cb52-5"></a><span class="kw">binom.test</span>(x, n, <span class="dt">p =</span> <span class="fl">0.5</span>, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="dt">conf.level =</span> <span class="fl">0.95</span>)</span>
<span id="cb52-6"><a href="第六章-计数资料的统计描述.html#cb52-6"></a><span class="co">##  Exact binomial test</span></span>
<span id="cb52-7"><a href="第六章-计数资料的统计描述.html#cb52-7"></a><span class="co">## </span></span>
<span id="cb52-8"><a href="第六章-计数资料的统计描述.html#cb52-8"></a><span class="co">## data:  x and n</span></span>
<span id="cb52-9"><a href="第六章-计数资料的统计描述.html#cb52-9"></a><span class="co">## number of successes = 6, number of trials = 13, p-value = 1</span></span>
<span id="cb52-10"><a href="第六章-计数资料的统计描述.html#cb52-10"></a><span class="co">## alternative hypothesis: true probability of success is not equal to 0.5</span></span>
<span id="cb52-11"><a href="第六章-计数资料的统计描述.html#cb52-11"></a><span class="co">## 95 percent confidence interval:</span></span>
<span id="cb52-12"><a href="第六章-计数资料的统计描述.html#cb52-12"></a><span class="co">##  0.1922324 0.7486545</span></span>
<span id="cb52-13"><a href="第六章-计数资料的统计描述.html#cb52-13"></a><span class="co">## sample estimates:</span></span>
<span id="cb52-14"><a href="第六章-计数资料的统计描述.html#cb52-14"></a><span class="co">## probability of success </span></span>
<span id="cb52-15"><a href="第六章-计数资料的统计描述.html#cb52-15"></a><span class="co">##              0.4615385 </span></span>
<span id="cb52-16"><a href="第六章-计数资料的统计描述.html#cb52-16"></a></span>
<span id="cb52-17"><a href="第六章-计数资料的统计描述.html#cb52-17"></a><span class="co">#使用Hmisc包中的binconf()函数</span></span>
<span id="cb52-18"><a href="第六章-计数资料的统计描述.html#cb52-18"></a><span class="co">#install.packages(&quot;Hmisc&quot;)</span></span>
<span id="cb52-19"><a href="第六章-计数资料的统计描述.html#cb52-19"></a><span class="kw">library</span>(Hmisc)</span>
<span id="cb52-20"><a href="第六章-计数资料的统计描述.html#cb52-20"></a><span class="kw">binconf</span>(x, n, <span class="dt">alpha=</span><span class="fl">0.05</span>, <span class="dt">method=</span><span class="st">&quot;all&quot;</span>)</span>
<span id="cb52-21"><a href="第六章-计数资料的统计描述.html#cb52-21"></a><span class="co">##             PointEst     Lower     Upper</span></span>
<span id="cb52-22"><a href="第六章-计数资料的统计描述.html#cb52-22"></a><span class="co">## Exact      0.4615385 0.1922324 0.7486545</span></span>
<span id="cb52-23"><a href="第六章-计数资料的统计描述.html#cb52-23"></a><span class="co">## Wilson     0.4615385 0.2320607 0.7085620</span></span>
<span id="cb52-24"><a href="第六章-计数资料的统计描述.html#cb52-24"></a><span class="co">## Asymptotic 0.4615385 0.1905457 0.7325312</span></span></code></pre></div>
</div>
<div id="正态近似法" class="section level5">
<h5><span class="header-section-number">6.1.2.1.2</span> 正态近似法</h5>
<p>如果n足够大，那么二项分布的偏度就比较小。在这种情况下，如果使用适当的连续性校正，
那么B(n,p)的一个很好的近似是正态分布:N(np,np(1-p))，对应的样本率p也近似正态分布:
N(p,p(1-p)/n)。当n越大（至少20）且p不接近0或1时近似效果更好。
不同的经验法则可以用来决定n是否足够大，以及p是否距离0或1足够远，
其中一个常用的规则是np和n(1 −p)都必须大于5时，可利用样本率p的分布近似正态分布来估计总体的1-α(α=0.05或0.01)的可信区间：
<span class="math display">\[(p-u_{a/2}S_p,p+u_{a/2}S_p) ,\]</span>
<span class="math inline">\(S_p\)</span>为样本资料计算样本的“成功”率<span class="math inline">\(S_p=\sqrt{{p(1-p)}/{n}}，p=X/N\)</span>，α=0.05时，<span class="math inline">\(u_{a/2}=1.96\)</span>；α=0.01时，<span class="math inline">\(u_{a/2}=2.58\)</span></p>
<p>使用《医学统计学》中的 案例6-3 的数据在R中进行二项分布的正态近似法分析测试。</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="第六章-计数资料的统计描述.html#cb53-1"></a><span class="co">##用正态分布近似计算</span></span>
<span id="cb53-2"><a href="第六章-计数资料的统计描述.html#cb53-2"></a>n1 &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb53-3"><a href="第六章-计数资料的统计描述.html#cb53-3"></a>x1 &lt;-<span class="st"> </span><span class="dv">55</span></span>
<span id="cb53-4"><a href="第六章-计数资料的统计描述.html#cb53-4"></a>p1 &lt;-<span class="st"> </span>x1<span class="op">/</span>n1</span>
<span id="cb53-5"><a href="第六章-计数资料的统计描述.html#cb53-5"></a>S_p1=<span class="kw">sqrt</span>(p1<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p1)<span class="op">/</span>n1)</span>
<span id="cb53-6"><a href="第六章-计数资料的统计描述.html#cb53-6"></a>p1 <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)<span class="op">*</span><span class="kw">qnorm</span>(<span class="fl">0.975</span>)<span class="op">*</span>S_p1</span>
<span id="cb53-7"><a href="第六章-计数资料的统计描述.html#cb53-7"></a><span class="co">## [1] 0.452493 0.647507</span></span>
<span id="cb53-8"><a href="第六章-计数资料的统计描述.html#cb53-8"></a></span>
<span id="cb53-9"><a href="第六章-计数资料的统计描述.html#cb53-9"></a><span class="co">##用精确法计算</span></span>
<span id="cb53-10"><a href="第六章-计数资料的统计描述.html#cb53-10"></a><span class="kw">binom.test</span>(x1, n1, <span class="fl">0.5</span>, <span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>, <span class="dt">conf.level=</span><span class="fl">0.95</span>)</span>
<span id="cb53-11"><a href="第六章-计数资料的统计描述.html#cb53-11"></a><span class="co">##  Exact binomial test</span></span>
<span id="cb53-12"><a href="第六章-计数资料的统计描述.html#cb53-12"></a><span class="co">## </span></span>
<span id="cb53-13"><a href="第六章-计数资料的统计描述.html#cb53-13"></a><span class="co">## data:  x1 and n1</span></span>
<span id="cb53-14"><a href="第六章-计数资料的统计描述.html#cb53-14"></a><span class="co">## number of successes = 55, number of trials = 100, p-value = 0.3682</span></span>
<span id="cb53-15"><a href="第六章-计数资料的统计描述.html#cb53-15"></a><span class="co">## alternative hypothesis: true probability of success is not equal to 0.5</span></span>
<span id="cb53-16"><a href="第六章-计数资料的统计描述.html#cb53-16"></a><span class="co">## 95 percent confidence interval:</span></span>
<span id="cb53-17"><a href="第六章-计数资料的统计描述.html#cb53-17"></a><span class="co">##  0.4472802 0.6496798</span></span>
<span id="cb53-18"><a href="第六章-计数资料的统计描述.html#cb53-18"></a><span class="co">## sample estimates:</span></span>
<span id="cb53-19"><a href="第六章-计数资料的统计描述.html#cb53-19"></a><span class="co">## probability of success </span></span>
<span id="cb53-20"><a href="第六章-计数资料的统计描述.html#cb53-20"></a><span class="co">##                   0.55 </span></span>
<span id="cb53-21"><a href="第六章-计数资料的统计描述.html#cb53-21"></a></span>
<span id="cb53-22"><a href="第六章-计数资料的统计描述.html#cb53-22"></a><span class="co">#使用Hmisc包中的binconf()函数</span></span>
<span id="cb53-23"><a href="第六章-计数资料的统计描述.html#cb53-23"></a><span class="kw">binconf</span>(x1, n1, <span class="dt">alpha=</span><span class="fl">0.05</span>, <span class="dt">method=</span><span class="st">&quot;all&quot;</span>)</span>
<span id="cb53-24"><a href="第六章-计数资料的统计描述.html#cb53-24"></a><span class="co">##            PointEst     Lower     Upper</span></span>
<span id="cb53-25"><a href="第六章-计数资料的统计描述.html#cb53-25"></a><span class="co">## Exact          0.55 0.4472802 0.6496798</span></span>
<span id="cb53-26"><a href="第六章-计数资料的统计描述.html#cb53-26"></a><span class="co">## Wilson         0.55 0.4524460 0.6438546</span></span>
<span id="cb53-27"><a href="第六章-计数资料的统计描述.html#cb53-27"></a><span class="co">## Asymptotic     0.55 0.4524930 0.6475070</span></span></code></pre></div>
</div>
</div>
<div id="样本率与总体率的比较" class="section level4">
<h4><span class="header-section-number">6.1.2.2</span> 样本率与总体率的比较</h4>
<div id="直接法" class="section level5">
<h5><span class="header-section-number">6.1.2.2.1</span> 直接法</h5>
<p>使用直接法时，需要注意是单侧检验还是双侧检验。一般的有：</p>
<ol style="list-style-type: decimal">
<li>单侧检验的情况：
<ul>
<li>若是回答“差/低”的问题计算的“成功”<strong>至多</strong>是k次的概率，即是<span class="math inline">\(P(X≤k)\)</span>；</li>
<li>若是回答“优/高”的问题计算的的“成功”<strong>至少</strong>是k次的概率，即<span class="math inline">\(P(X≥k)\)</span>的率。</li>
</ul></li>
<li>双侧检验的情况：
主要是回答“有无差别”，及备择假设是<span class="math inline">\(p≠p_0\)</span>是否成立，因此计算的是实际样本“成功”k次出现的概率，与更背离原假设的事件出现的概率和。</li>
</ol>
<p>使用《医学统计学》中的 案例6-4的数据在R中进行二项分布的样本率与总体率的比较的直接法分析测试。</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="第六章-计数资料的统计描述.html#cb54-1"></a><span class="co">#比较的是至少9次，或者零一对象最多8次的概率，所以：</span></span>
<span id="cb54-2"><a href="第六章-计数资料的统计描述.html#cb54-2"></a>p_<span class="dv">8</span>&lt;-<span class="kw">pbinom</span>(<span class="dv">8</span>,<span class="dv">10</span>,<span class="fl">0.55</span>)</span>
<span id="cb54-3"><a href="第六章-计数资料的统计描述.html#cb54-3"></a><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p_<span class="dv">8</span></span>
<span id="cb54-4"><a href="第六章-计数资料的统计描述.html#cb54-4"></a><span class="co">#[1] 0.0232571</span></span></code></pre></div>
<p>根据计算结果，p(x&gt;8)=p(x≥9)=0.0232571＜0.05，因此拒接原假设<span class="math inline">\(H_0:p=0.55\)</span>，接受<span class="math inline">\(H_1:p＞0.55\)</span>。</p>
<p>使用《医学统计学》中的 案例6-5的数据在R中进行二项分布的样本率与总体率的比较的直接法分析测试。</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="第六章-计数资料的统计描述.html#cb55-1"></a>n2&lt;-<span class="dv">10</span></span>
<span id="cb55-2"><a href="第六章-计数资料的统计描述.html#cb55-2"></a>x2&lt;-<span class="dv">9</span></span>
<span id="cb55-3"><a href="第六章-计数资料的统计描述.html#cb55-3"></a>p2&lt;-<span class="fl">0.6</span></span>
<span id="cb55-4"><a href="第六章-计数资料的统计描述.html#cb55-4"></a><span class="co">#比较的是至少9次，或者零一对象最多8次的概率，所以：</span></span>
<span id="cb55-5"><a href="第六章-计数资料的统计描述.html#cb55-5"></a>p_<span class="dv">3</span>&lt;-<span class="kw">pbinom</span>(x2,n2,p2)</span>
<span id="cb55-6"><a href="第六章-计数资料的统计描述.html#cb55-6"></a><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p_<span class="dv">3</span></span>
<span id="cb55-7"><a href="第六章-计数资料的统计描述.html#cb55-7"></a><span class="co"># [1] 0.0232571</span></span></code></pre></div>
<p>根据计算结果，p(x&gt;8)=p(x≥9)=0.0232571＜0.05，因此拒接原假设<span class="math inline">\(H_0:p=0.55\)</span>，接受<span class="math inline">\(H_1:p＞0.55\)</span>。</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="第六章-计数资料的统计描述.html#cb56-1"></a>n3&lt;-<span class="dv">10</span></span>
<span id="cb56-2"><a href="第六章-计数资料的统计描述.html#cb56-2"></a>x3&lt;-<span class="dv">9</span></span>
<span id="cb56-3"><a href="第六章-计数资料的统计描述.html#cb56-3"></a>p3&lt;-<span class="fl">0.6</span></span>
<span id="cb56-4"><a href="第六章-计数资料的统计描述.html#cb56-4"></a><span class="co">#计算的是出现9次的概率：</span></span>
<span id="cb56-5"><a href="第六章-计数资料的统计描述.html#cb56-5"></a>p4&lt;-<span class="kw">dbinom</span>(x3,n3,p3)</span>
<span id="cb56-6"><a href="第六章-计数资料的统计描述.html#cb56-6"></a><span class="co"># [1] 0.04031078</span></span>
<span id="cb56-7"><a href="第六章-计数资料的统计描述.html#cb56-7"></a><span class="co">#计算出现更背离原假设的事件及概率，即：</span></span>
<span id="cb56-8"><a href="第六章-计数资料的统计描述.html#cb56-8"></a>p4_<span class="dv">1</span>&lt;-<span class="kw">sum</span>(<span class="kw">dbinom</span>(<span class="dv">0</span><span class="op">:</span>n3,n3,p3)[<span class="kw">which</span>(<span class="kw">dbinom</span>(<span class="dv">0</span><span class="op">:</span>n3,n3,p3)<span class="op">&lt;</span><span class="kw">dbinom</span>(x3,n3,p3))])</span>
<span id="cb56-9"><a href="第六章-计数资料的统计描述.html#cb56-9"></a><span class="co"># [1] 0.01834117</span></span>
<span id="cb56-10"><a href="第六章-计数资料的统计描述.html#cb56-10"></a><span class="co">#双侧检验的p值为：</span></span>
<span id="cb56-11"><a href="第六章-计数资料的统计描述.html#cb56-11"></a>p4<span class="op">+</span>p4_<span class="dv">1</span></span>
<span id="cb56-12"><a href="第六章-计数资料的统计描述.html#cb56-12"></a><span class="co"># [1] 0.05865196</span></span>
<span id="cb56-13"><a href="第六章-计数资料的统计描述.html#cb56-13"></a></span>
<span id="cb56-14"><a href="第六章-计数资料的统计描述.html#cb56-14"></a><span class="co">#或者直接用which()函数一并计算</span></span>
<span id="cb56-15"><a href="第六章-计数资料的统计描述.html#cb56-15"></a><span class="kw">sum</span>(<span class="kw">dbinom</span>(<span class="dv">0</span><span class="op">:</span>n3,n3,p3)[<span class="kw">which</span>(<span class="kw">dbinom</span>(<span class="dv">0</span><span class="op">:</span>n3,n3,p3)<span class="op">&lt;=</span><span class="kw">dbinom</span>(x3,n3,p3))])</span>
<span id="cb56-16"><a href="第六章-计数资料的统计描述.html#cb56-16"></a><span class="co"># [1] 0.05865196</span></span></code></pre></div>
<p>根据计算结果，p(x)=0.05865196＞0.05，因此不拒接原假设<span class="math inline">\(H_0:p=0.6\)</span>，尚不能认为两种处理的效果不同。</p>
</div>
<div id="正态近似法-1" class="section level5">
<h5><span class="header-section-number">6.1.2.2.2</span> 正态近似法</h5>
<p>当n较大、p和1-p均不太小，如np和n(1-p)均大于5时，利用样本率的分布近似正态分布的原理，
可作样本所在的总体率p与已知总体率<span class="math inline">\(p_0\)</span>的比较。检验统计量u值的计算公式为：
<span class="math display">\[u=\frac{p-p_0}{\sqrt{p_0(1-p_0)/n}}\]</span></p>
<p>使用《医学统计学》中的 案例6-6的数据在R中进行二项分布的样本率与总体率的比较的正态近似法分析测试。</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="第六章-计数资料的统计描述.html#cb57-1"></a>n4&lt;-<span class="dv">180</span></span>
<span id="cb57-2"><a href="第六章-计数资料的统计描述.html#cb57-2"></a>x4&lt;-<span class="dv">117</span></span>
<span id="cb57-3"><a href="第六章-计数资料的统计描述.html#cb57-3"></a>p4&lt;-x4<span class="op">/</span>n4</span>
<span id="cb57-4"><a href="第六章-计数资料的统计描述.html#cb57-4"></a>p4_<span class="dv">0</span>&lt;-<span class="fl">0.45</span></span>
<span id="cb57-5"><a href="第六章-计数资料的统计描述.html#cb57-5"></a></span>
<span id="cb57-6"><a href="第六章-计数资料的统计描述.html#cb57-6"></a>u&lt;-(p4<span class="op">-</span>p4_<span class="dv">0</span>)<span class="op">/</span><span class="kw">sqrt</span>( p4_<span class="dv">0</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p4_<span class="dv">0</span>)<span class="op">/</span>n4)</span>
<span id="cb57-7"><a href="第六章-计数资料的统计描述.html#cb57-7"></a><span class="co"># [1] 5.393599</span></span>
<span id="cb57-8"><a href="第六章-计数资料的统计描述.html#cb57-8"></a><span class="co">#根据正态分布的该v累计分布函数计算出p值</span></span>
<span id="cb57-9"><a href="第六章-计数资料的统计描述.html#cb57-9"></a><span class="kw">pnorm</span>(u,<span class="dt">lower.tail =</span> F)<span class="op">*</span><span class="dv">2</span></span>
<span id="cb57-10"><a href="第六章-计数资料的统计描述.html#cb57-10"></a><span class="co"># [1] 6.906029e-08</span></span>
<span id="cb57-11"><a href="第六章-计数资料的统计描述.html#cb57-11"></a></span>
<span id="cb57-12"><a href="第六章-计数资料的统计描述.html#cb57-12"></a><span class="co">#整理成函数的形式</span></span>
<span id="cb57-13"><a href="第六章-计数资料的统计描述.html#cb57-13"></a>binom_comp_uAsym&lt;-<span class="cf">function</span>(n1,x1,p0){</span>
<span id="cb57-14"><a href="第六章-计数资料的统计描述.html#cb57-14"></a>  p1&lt;-x1<span class="op">/</span>n1</span>
<span id="cb57-15"><a href="第六章-计数资料的统计描述.html#cb57-15"></a>  p_val&lt;-<span class="kw">pnorm</span>((p1<span class="op">-</span>p0)<span class="op">/</span><span class="kw">sqrt</span>( p0<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p0)<span class="op">/</span>n1),<span class="dt">lower.tail =</span> F)<span class="op">*</span><span class="dv">2</span></span>
<span id="cb57-16"><a href="第六章-计数资料的统计描述.html#cb57-16"></a>  <span class="kw">return</span>( p_val)</span>
<span id="cb57-17"><a href="第六章-计数资料的统计描述.html#cb57-17"></a>}</span>
<span id="cb57-18"><a href="第六章-计数资料的统计描述.html#cb57-18"></a></span>
<span id="cb57-19"><a href="第六章-计数资料的统计描述.html#cb57-19"></a><span class="kw">binom_comp_uAsym</span>(n4,x4,p4_<span class="dv">0</span>)</span>
<span id="cb57-20"><a href="第六章-计数资料的统计描述.html#cb57-20"></a><span class="co"># [1] 6.906029e-08</span></span></code></pre></div>
<p>根据计算结果，p(x)=6.906029e-08＜0.01＜0.05，因此拒接原假设<span class="math inline">\(H_0:p=0.45\)</span>，接受<span class="math inline">\(H_1\)</span>，两种处理的效果不同，新的比旧的好。</p>
</div>
</div>
<div id="两样本率的比较正态近似" class="section level4">
<h4><span class="header-section-number">6.1.2.3</span> 两样本率的比较(正态近似)</h4>
<p>当n1与n2均较大，p1、p2、1-p1和1-p2均不太小，如n1p1、n1(1-p1)、n2p2、n2(1-p2)均大于5时，可利用样本率的分布
近似正态分布且独立两正态变量之差也服从正态分布的性质，采用近似正态法对两总体率进行统计检验，u的计算公式为：
<span class="math display">\[\begin{aligned}
u &amp;= \frac{p_1-p_2}{S_{p_1-p_2}}\\
S_{p_1-p_2} &amp;= \sqrt{\frac{X_1+X_2}{n_1+n_2}(1-\frac{X_1+X_2}{n_1+n_2})(\frac{1}{n_1}+\frac{1}{n_2})}
\end{aligned}\]</span></p>
<p>使用《医学统计学》中的 案例6-7的数据在R中进行二项分布的样本率与总体率的比较的正态近似法分析测试。</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="第六章-计数资料的统计描述.html#cb58-1"></a>n5&lt;-<span class="dv">120</span></span>
<span id="cb58-2"><a href="第六章-计数资料的统计描述.html#cb58-2"></a>n6&lt;-<span class="dv">110</span></span>
<span id="cb58-3"><a href="第六章-计数资料的统计描述.html#cb58-3"></a>x5&lt;-<span class="dv">36</span></span>
<span id="cb58-4"><a href="第六章-计数资料的统计描述.html#cb58-4"></a>x6&lt;-<span class="dv">22</span></span>
<span id="cb58-5"><a href="第六章-计数资料的统计描述.html#cb58-5"></a></span>
<span id="cb58-6"><a href="第六章-计数资料的统计描述.html#cb58-6"></a>p5&lt;-x5<span class="op">/</span>n5</span>
<span id="cb58-7"><a href="第六章-计数资料的统计描述.html#cb58-7"></a>p6&lt;-x6<span class="op">/</span>n6</span>
<span id="cb58-8"><a href="第六章-计数资料的统计描述.html#cb58-8"></a></span>
<span id="cb58-9"><a href="第六章-计数资料的统计描述.html#cb58-9"></a>S_<span class="dv">5</span>_<span class="dv">6</span>&lt;-<span class="kw">sqrt</span>((x5<span class="op">+</span>x6)<span class="op">/</span>(n5<span class="op">+</span>n6)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>(x5<span class="op">+</span>x6)<span class="op">/</span>(n5<span class="op">+</span>n6))<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>n5<span class="op">+</span><span class="dv">1</span><span class="op">/</span>n6))</span>
<span id="cb58-10"><a href="第六章-计数资料的统计描述.html#cb58-10"></a>u&lt;-(p5<span class="op">-</span>p6)<span class="op">/</span>S_<span class="dv">5</span>_<span class="dv">6</span></span>
<span id="cb58-11"><a href="第六章-计数资料的统计描述.html#cb58-11"></a><span class="kw">pnorm</span>(u,<span class="dt">lower.tail =</span> F)<span class="op">*</span><span class="dv">2</span></span>
<span id="cb58-12"><a href="第六章-计数资料的统计描述.html#cb58-12"></a><span class="co"># [1] 0.08107076</span></span>
<span id="cb58-13"><a href="第六章-计数资料的统计描述.html#cb58-13"></a></span>
<span id="cb58-14"><a href="第六章-计数资料的统计描述.html#cb58-14"></a><span class="co">#整理成函数的形式</span></span>
<span id="cb58-15"><a href="第六章-计数资料的统计描述.html#cb58-15"></a>binom_twosamplecomp_uAsym&lt;-<span class="cf">function</span>(n1,x1,n2,x2){</span>
<span id="cb58-16"><a href="第六章-计数资料的统计描述.html#cb58-16"></a>  p1&lt;-x1<span class="op">/</span>n1</span>
<span id="cb58-17"><a href="第六章-计数资料的统计描述.html#cb58-17"></a>  p2&lt;-x2<span class="op">/</span>n2</span>
<span id="cb58-18"><a href="第六章-计数资料的统计描述.html#cb58-18"></a>  S_val&lt;-<span class="kw">sqrt</span>((x1<span class="op">+</span>x2)<span class="op">/</span>(n1<span class="op">+</span>n2)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>(x1<span class="op">+</span>x2)<span class="op">/</span>(n1<span class="op">+</span>n2))<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>n1<span class="op">+</span><span class="dv">1</span><span class="op">/</span>n2))</span>
<span id="cb58-19"><a href="第六章-计数资料的统计描述.html#cb58-19"></a>  p_val&lt;-<span class="kw">pnorm</span>((p1<span class="op">-</span>p2)<span class="op">/</span>S_val,<span class="dt">lower.tail =</span> F)<span class="op">*</span><span class="dv">2</span></span>
<span id="cb58-20"><a href="第六章-计数资料的统计描述.html#cb58-20"></a>  <span class="kw">return</span>( p_val)</span>
<span id="cb58-21"><a href="第六章-计数资料的统计描述.html#cb58-21"></a>}</span>
<span id="cb58-22"><a href="第六章-计数资料的统计描述.html#cb58-22"></a><span class="kw">binom_twosamplecomp_uAsym</span>(n5,x5,n6,x6)</span>
<span id="cb58-23"><a href="第六章-计数资料的统计描述.html#cb58-23"></a><span class="co"># [1] 0.08107076</span></span></code></pre></div>
<p>根据计算结果，p值=0.08107076＞0.05＞0.01，因此不拒接原假设<span class="math inline">\(H_0\)</span>，尚不能认为两种处理的效果不同。</p>
</div>
<div id="非遗传疾病的家族聚集性" class="section level4">
<h4><span class="header-section-number">6.1.2.4</span> 非遗传疾病的家族聚集性</h4>
<p>非遗传性疾病的家族集聚性(Clustering in familes)，系指该疾病的发生在家族成员间是否有传染性，如果没有传染性，则家族成员间的患病是独立的，该疾病无家族集聚性。
否则，家族成员间的患病是非独立的，该疾病存在家族集聚性。</p>
<p>当这种遗传性疾病无家族集聚性时，以家族为样本，在n个成员中，出现X个成员患病的概率分布可认为服从二项分布; 否则，使不服从二项分布。
实际资料与二项分布进行<a href="第六章-计数资料的统计描述.html#拟合优度检验">拟合优度(Goodness of fit)的卡方检验</a>得出p值。</p>
</div>
<div id="群检验" class="section level4">
<h4><span class="header-section-number">6.1.2.5</span> 群检验</h4>
<p>为了解决检验大批标本的阳性率问题，把N个标本分为n个群，每个群m个标本，即N=n*m。检验每个群是否为阳性群（一旦检测到阳性就停止检测当前群），只有阴性群才需要检测所有标本，可以大大减少检测数目。
记每个标本阳性率为p，则<span class="math inline">\((1-p)^m\)</span>为m个标本均为阴性的概率，<span class="math inline">\(1-(1-p)^m\)</span>为一个群为阳性群的概率。
通过阳性群率计算阳性率：假设受检的n个群中，X个群为阳性群，则X/n可作为一个群为阳性群概率的估计值，则有：</p>
<p><span class="math display">\[(1-p)^m=\frac{X}{n}\]</span></p>
<p>从而估计出：</p>
<p><span class="math display">\[p=1-\sqrt[m]{1-X/n}\]</span></p>
<p>使用《医学统计学》中的 案例6-9的数据在R中进行二项分布的群检验分析测试。</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="第六章-计数资料的统计描述.html#cb59-1"></a>N&lt;-<span class="dv">6000</span></span>
<span id="cb59-2"><a href="第六章-计数资料的统计描述.html#cb59-2"></a>n&lt;-<span class="dv">300</span></span>
<span id="cb59-3"><a href="第六章-计数资料的统计描述.html#cb59-3"></a>m&lt;-<span class="dv">20</span></span>
<span id="cb59-4"><a href="第六章-计数资料的统计描述.html#cb59-4"></a>X&lt;-<span class="dv">270</span></span>
<span id="cb59-5"><a href="第六章-计数资料的统计描述.html#cb59-5"></a><span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span>X<span class="op">/</span>n)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>m)</span>
<span id="cb59-6"><a href="第六章-计数资料的统计描述.html#cb59-6"></a><span class="co"># [1] 0.1087491</span></span>
<span id="cb59-7"><a href="第六章-计数资料的统计描述.html#cb59-7"></a></span>
<span id="cb59-8"><a href="第六章-计数资料的统计描述.html#cb59-8"></a><span class="co">#整理成函数的形式</span></span>
<span id="cb59-9"><a href="第六章-计数资料的统计描述.html#cb59-9"></a>binom_commtest&lt;-<span class="cf">function</span>(N,n,m,X){</span>
<span id="cb59-10"><a href="第六章-计数资料的统计描述.html#cb59-10"></a>  <span class="kw">return</span>( <span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span>X<span class="op">/</span>n)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>m))</span>
<span id="cb59-11"><a href="第六章-计数资料的统计描述.html#cb59-11"></a>}</span>
<span id="cb59-12"><a href="第六章-计数资料的统计描述.html#cb59-12"></a><span class="kw">binom_commtest</span>(N,n,m,X)</span>
<span id="cb59-13"><a href="第六章-计数资料的统计描述.html#cb59-13"></a><span class="co"># [1] 0.1087491</span></span></code></pre></div>
<p>根据计算结果，该地区的钉螺血吸虫的感染率的估计值为10.87%。</p>
</div>
</div>
</div>
<div id="泊松分布" class="section level2">
<h2><span class="header-section-number">6.2</span> 泊松分布</h2>
<p>泊松分布，也叫Poisson分布，是二项分布的一种<strong>极端</strong>(即n很大,p很凶啊)情况，已发展为描述小概率事件发生规律的一种重要分布，适合于描述单位时间内随机事件发生的次数的概率分布。如某一服务设施在一定时间内受到的服务请求的次数，电话交换机接到呼叫的次数、汽车站台的候客人数、机器出现的故障数、DNA序列的变异数、放射性原子核的衰变数、发病率低的非传染性疾病发病或人数分布等、单位时间或面积、空间某罕见事物的分布等。如果随机变量X服从总体均数为<span class="math inline">\(\lambda\)</span>的泊松分布，X取值为0，1，2，···的对应概率质量函数为：
<span class="math display">\[P(X)=\frac{e^{-\lambda}\lambda^X}{X!}, X=0,1,2,\dots\]</span>
其中，<span class="math inline">\(\lambda\)</span>为总体均数，e=2.71828为自然常数，有<span class="math inline">\(\sum{P(X)}=1\)</span>。</p>
<p><strong>适用的条件</strong>
1. 普通性 在充分小的观测单位上X的取值最多为1。简单而言，就是在试验次数n足够大时，每次试验可看作是一个“充分小的观测单位”，且每次试验只会发生两种互斥的可能结果之一(阳性或阴性)，这样阳性数X的取值最多为1。
2. 独立增量性 在某个观测单位上的取值与前面各观测单位上的取值无关。简而言之，就是前 面的试验结果不影响下一次的试验结果，各次试验具有独立性。
3. 平稳性 X的取值只与观测单位的大小有关，而与观测单位的位置无关。简单而言，就是每一次 试验阳性事件发生的概率都应相同，为x=/n，这样阳性数 的取值只与重复试验的次数有关，为合计的阳性数，可看作是大量独立试验的总结果。</p>
<div id="泊松分布的性质" class="section level3">
<h3><span class="header-section-number">6.2.1</span> 泊松分布的性质</h3>
<div id="均数与标准差-1" class="section level4">
<h4><span class="header-section-number">6.2.1.1</span> 均数与标准差</h4>
<ol style="list-style-type: decimal">
<li>总体均数<span class="math inline">\(\lambda\)</span>与总体方差<span class="math inline">\(\sigma^2\)</span>相等</li>
<li>n很大p很小，且<span class="math inline">\(np=\lambda\)</span>为常数时，二项分布近似Poisson分布</li>
</ol>
</div>
<div id="泊松分布的图像" class="section level4">
<h4><span class="header-section-number">6.2.1.2</span> 泊松分布的图像</h4>
<ol style="list-style-type: decimal">
<li>Poisson分布的图形是右偏分布，均值越大时，其对称性越好</li>
<li>当<span class="math inline">\(\lambda≤1\)</span>时，随X取值越大，P(X)取值反而越小；当<span class="math inline">\(\lambda＞1\)</span>时，随X取值越大，P(X)取值先正达后变小；</li>
<li>当<span class="math inline">\(\lambda\)</span>为整数时，则在<span class="math inline">\(X=\lambda\)</span>和<span class="math inline">\(X=\lambda-1\)</span>处有最大概率值</li>
<li><span class="math inline">\(\lambda\)</span>越大，Poisson分布渐近正态分布，<span class="math inline">\(\lambda&gt;=20\)</span>时可近似为正态分布</li>
<li>Possion分布具有可加性(和正态分布类似)，但不具有可乘性(可由X取值和均数，方差看出)</li>
</ol>
</div>
</div>
<div id="泊松分布的应用" class="section level3">
<h3><span class="header-section-number">6.2.2</span> 泊松分布的应用</h3>
<p>利用泊松分布及其正态近似性，可进行总体率的区间估计和差异推断。</p>
<div id="总体均数的区间估计" class="section level4">
<h4><span class="header-section-number">6.2.2.1</span> 总体均数的区间估计</h4>
<p>利用服从泊松分布的样本资料，可进行总体均属的1-α可信区间，α取值为0.05或0.01。</p>
<div id="直接法-1" class="section level5">
<h5><span class="header-section-number">6.2.2.1.1</span> 直接法</h5>
<p>对于n≤50的服从泊松分布的小样本资料，用查泊松分布表可以获取百分率的可信区间，即了得到其总体的1-α的可信区间。</p>
<p>R语言中的泊松分布相关的函数与之前介绍的分布(如二项分布，t分布和f分布)类似，主要有
<a href="https://www.rdocumentation.org/packages/stats/versions/3.3/topics/Poisson">dpois(),ppois(),qpois()和rpois()</a>。
用于进行参数估计和假设检验的函数主要有<a href="https://www.rdocumentation.org/packages/stats/versions/3.3/topics/poisson.test">poisson.test()</a>。</p>
<p>使用《医学统计学》中的 案例6-10 的数据在R中进行二项分布的精确法/查表法分析测试。</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="第六章-计数资料的统计描述.html#cb60-1"></a>n &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb60-2"><a href="第六章-计数资料的统计描述.html#cb60-2"></a>x &lt;-<span class="st"> </span><span class="dv">21</span></span>
<span id="cb60-3"><a href="第六章-计数资料的统计描述.html#cb60-3"></a><span class="kw">poisson.test</span>(x, n,<span class="dt">conf.level=</span><span class="fl">0.95</span>)</span>
<span id="cb60-4"><a href="第六章-计数资料的统计描述.html#cb60-4"></a><span class="co">##  Exact Poisson test</span></span>
<span id="cb60-5"><a href="第六章-计数资料的统计描述.html#cb60-5"></a><span class="co">## </span></span>
<span id="cb60-6"><a href="第六章-计数资料的统计描述.html#cb60-6"></a><span class="co">## data:  21 time base: 1</span></span>
<span id="cb60-7"><a href="第六章-计数资料的统计描述.html#cb60-7"></a><span class="co">## number of events = 21, time base = 1, p-value = 1</span></span>
<span id="cb60-8"><a href="第六章-计数资料的统计描述.html#cb60-8"></a><span class="co">## alternative hypothesis: true event rate is not equal to 21</span></span>
<span id="cb60-9"><a href="第六章-计数资料的统计描述.html#cb60-9"></a><span class="co">## 95 percent confidence interval:</span></span>
<span id="cb60-10"><a href="第六章-计数资料的统计描述.html#cb60-10"></a><span class="co">##  12.99933 32.10073</span></span>
<span id="cb60-11"><a href="第六章-计数资料的统计描述.html#cb60-11"></a><span class="co">## sample estimates:</span></span>
<span id="cb60-12"><a href="第六章-计数资料的统计描述.html#cb60-12"></a><span class="co">## event rate </span></span>
<span id="cb60-13"><a href="第六章-计数资料的统计描述.html#cb60-13"></a><span class="co">##         21 </span></span>
<span id="cb60-14"><a href="第六章-计数资料的统计描述.html#cb60-14"></a><span class="kw">poisson.test</span>(x, n,<span class="dt">conf.level=</span><span class="fl">0.99</span>)</span>
<span id="cb60-15"><a href="第六章-计数资料的统计描述.html#cb60-15"></a><span class="co">##  Exact Poisson test</span></span>
<span id="cb60-16"><a href="第六章-计数资料的统计描述.html#cb60-16"></a><span class="co">## </span></span>
<span id="cb60-17"><a href="第六章-计数资料的统计描述.html#cb60-17"></a><span class="co">## data:  21 time base: 1</span></span>
<span id="cb60-18"><a href="第六章-计数资料的统计描述.html#cb60-18"></a><span class="co">## number of events = 21, time base = 1, p-value = 1</span></span>
<span id="cb60-19"><a href="第六章-计数资料的统计描述.html#cb60-19"></a><span class="co">## alternative hypothesis: true event rate is not equal to 21</span></span>
<span id="cb60-20"><a href="第六章-计数资料的统计描述.html#cb60-20"></a><span class="co">## 99 percent confidence interval:</span></span>
<span id="cb60-21"><a href="第六章-计数资料的统计描述.html#cb60-21"></a><span class="co">##  11.06923 35.94628</span></span>
<span id="cb60-22"><a href="第六章-计数资料的统计描述.html#cb60-22"></a><span class="co">## sample estimates:</span></span>
<span id="cb60-23"><a href="第六章-计数资料的统计描述.html#cb60-23"></a><span class="co">## event rate </span></span>
<span id="cb60-24"><a href="第六章-计数资料的统计描述.html#cb60-24"></a><span class="co">##         21 </span></span>
<span id="cb60-25"><a href="第六章-计数资料的统计描述.html#cb60-25"></a></span>
<span id="cb60-26"><a href="第六章-计数资料的统计描述.html#cb60-26"></a><span class="co">#使用exactci包中的poisson.exact()方法，可以使用plot参数绘制出区间图</span></span>
<span id="cb60-27"><a href="第六章-计数资料的统计描述.html#cb60-27"></a><span class="co">#install.packages(&quot;exactci&quot;)</span></span>
<span id="cb60-28"><a href="第六章-计数资料的统计描述.html#cb60-28"></a><span class="kw">library</span>(<span class="st">&quot;exactci&quot;</span>)</span>
<span id="cb60-29"><a href="第六章-计数资料的统计描述.html#cb60-29"></a><span class="kw">poisson.exact</span>(<span class="dv">21</span>, <span class="dt">plot=</span>T, <span class="dt">conf.level=</span><span class="fl">0.95</span>)</span>
<span id="cb60-30"><a href="第六章-计数资料的统计描述.html#cb60-30"></a><span class="kw">poisson.exact</span>(<span class="dv">21</span>, <span class="dt">plot=</span>T, <span class="dt">conf.level=</span><span class="fl">0.99</span>)</span></code></pre></div>
<p>根据计算结果，95%和99%的可信区间分别是(12.99933,32.10073)和(11.06923,35.94628)。</p>
</div>
<div id="正态近似法-2" class="section level5">
<h5><span class="header-section-number">6.2.2.1.2</span> 正态近似法</h5>
<p>对于n＞50的服从泊松分布的样本资料，可以采用正态近似法获取百分率的可信区间，即了得到其总体的1-α的可信区间。
<span class="math display">\[(X-u_{\alpha/2}\sqrt{X},X+u_{\alpha/2}\sqrt{X})\]</span></p>
<p>使用《医学统计学》中的 案例6-11 的数据在R中进行泊松分布的正态近似法分析测试。</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="第六章-计数资料的统计描述.html#cb61-1"></a>x&lt;-<span class="dv">68</span></span>
<span id="cb61-2"><a href="第六章-计数资料的统计描述.html#cb61-2"></a>alpha1&lt;-<span class="fl">0.05</span></span>
<span id="cb61-3"><a href="第六章-计数资料的统计描述.html#cb61-3"></a>alpha2&lt;-<span class="fl">0.01</span></span>
<span id="cb61-4"><a href="第六章-计数资料的统计描述.html#cb61-4"></a></span>
<span id="cb61-5"><a href="第六章-计数资料的统计描述.html#cb61-5"></a>posi_uAsym&lt;-<span class="cf">function</span>(X,alpha) {</span>
<span id="cb61-6"><a href="第六章-计数资料的统计描述.html#cb61-6"></a>  Low&lt;-X<span class="op">-</span><span class="kw">qnorm</span>(alpha<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">sqrt</span>(X)</span>
<span id="cb61-7"><a href="第六章-计数资料的统计描述.html#cb61-7"></a>  Up&lt;-X<span class="op">+</span><span class="kw">qnorm</span>(alpha<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">sqrt</span>(X)</span>
<span id="cb61-8"><a href="第六章-计数资料的统计描述.html#cb61-8"></a>  <span class="kw">return</span>(<span class="kw">list</span>(Low,Up))</span>
<span id="cb61-9"><a href="第六章-计数资料的统计描述.html#cb61-9"></a>}</span>
<span id="cb61-10"><a href="第六章-计数资料的统计描述.html#cb61-10"></a></span>
<span id="cb61-11"><a href="第六章-计数资料的统计描述.html#cb61-11"></a><span class="kw">posi_uAsym</span>(x,alpha1)</span>
<span id="cb61-12"><a href="第六章-计数资料的统计描述.html#cb61-12"></a><span class="co"># 84.16228</span></span>
<span id="cb61-13"><a href="第六章-计数资料的统计描述.html#cb61-13"></a><span class="co"># 51.83772</span></span>
<span id="cb61-14"><a href="第六章-计数资料的统计描述.html#cb61-14"></a><span class="kw">posi_uAsym</span>(x,alpha2)</span>
<span id="cb61-15"><a href="第六章-计数资料的统计描述.html#cb61-15"></a><span class="co"># 89.24083</span></span>
<span id="cb61-16"><a href="第六章-计数资料的统计描述.html#cb61-16"></a><span class="co"># 46.75917</span></span></code></pre></div>
</div>
</div>
<div id="样本均数与总体均数的比较" class="section level4">
<h4><span class="header-section-number">6.2.2.2</span> 样本均数与总体均数的比较</h4>
<div id="直接法-2" class="section level5">
<h5><span class="header-section-number">6.2.2.2.1</span> 直接法</h5>
<p>当总体均数<span class="math inline">\(\lambda\)</span>&lt;20<span class="math inline">\(时，可采用直接计算概率的方式对样本均数与已知总体均数间的差别进行有无 统计学意义的比较。如用于发病率很低的非传染性疾病，则是对以样本计数X为代表的总体率p与已知的总 体率\)</span>p_0$，是否有差别进行推断。</p>
<p>使用《医学统计学》中的 案例6-12 的数据在R中进行样本均数与总体均数的泊松分布-直接法分析测试。</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="第六章-计数资料的统计描述.html#cb62-1"></a>p0&lt;-<span class="fl">0.008</span></span>
<span id="cb62-2"><a href="第六章-计数资料的统计描述.html#cb62-2"></a>n&lt;-<span class="dv">120</span></span>
<span id="cb62-3"><a href="第六章-计数资料的统计描述.html#cb62-3"></a>X&lt;-<span class="dv">4</span></span>
<span id="cb62-4"><a href="第六章-计数资料的统计描述.html#cb62-4"></a>lambda&lt;-n<span class="op">*</span>p0</span>
<span id="cb62-5"><a href="第六章-计数资料的统计描述.html#cb62-5"></a></span>
<span id="cb62-6"><a href="第六章-计数资料的统计描述.html#cb62-6"></a><span class="co">#计算不小于4的泊松分布概率和</span></span>
<span id="cb62-7"><a href="第六章-计数资料的统计描述.html#cb62-7"></a><span class="kw">ppois</span>(X<span class="dv">-1</span>, <span class="dt">lambda=</span>lambda,<span class="dt">lower.tail =</span> F)</span>
<span id="cb62-8"><a href="第六章-计数资料的统计描述.html#cb62-8"></a><span class="co">#或者</span></span>
<span id="cb62-9"><a href="第六章-计数资料的统计描述.html#cb62-9"></a><span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(<span class="kw">dpois</span>(<span class="dv">0</span><span class="op">:</span>(X<span class="dv">-1</span>), <span class="dt">lambda=</span>lambda))</span>
<span id="cb62-10"><a href="第六章-计数资料的统计描述.html#cb62-10"></a><span class="co"># [1] 0.01663305</span></span></code></pre></div>
<p>根据计算结果，p值为0.0166&lt;0.05，按照α=0.05的检验水准，拒绝原假设<span class="math inline">\(H_0\)</span>，接受<span class="math inline">\(H_1\)</span>，即认为母亲吸烟会增大小孩的先天心脏病危险。</p>
</div>
<div id="正态近似法-3" class="section level5">
<h5><span class="header-section-number">6.2.2.2.2</span> 正态近似法</h5>
<p>当总体均数<span class="math inline">\(\lambda\)</span>≥20$时，可采用正态近似法的方式对样本均数与已知总体均数间的差别进行有无
统计学意义的比较，检验统计量u值的计算公式为：
<span class="math display">\[u=\frac{X-\lambda}{\sqrt{\lambda}}\]</span></p>
<p>使用《医学统计学》中的 案例6-13的数据在R中进行样本率与总体率的比较的泊松分布-正态近似法分析测试。</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="第六章-计数资料的统计描述.html#cb63-1"></a>p0&lt;-<span class="fl">0.003</span></span>
<span id="cb63-2"><a href="第六章-计数资料的统计描述.html#cb63-2"></a>n=<span class="dv">25000</span></span>
<span id="cb63-3"><a href="第六章-计数资料的统计描述.html#cb63-3"></a>X&lt;-<span class="dv">123</span></span>
<span id="cb63-4"><a href="第六章-计数资料的统计描述.html#cb63-4"></a></span>
<span id="cb63-5"><a href="第六章-计数资料的统计描述.html#cb63-5"></a>posi_comp_uAsym&lt;-<span class="cf">function</span>(n,X,p0) {</span>
<span id="cb63-6"><a href="第六章-计数资料的统计描述.html#cb63-6"></a>  u_val&lt;-(X<span class="op">-</span>n<span class="op">*</span>p0)<span class="op">/</span><span class="kw">sqrt</span>(n<span class="op">*</span>p0)</span>
<span id="cb63-7"><a href="第六章-计数资料的统计描述.html#cb63-7"></a>  <span class="co">#print (u_val)</span></span>
<span id="cb63-8"><a href="第六章-计数资料的统计描述.html#cb63-8"></a>  p_val&lt;-<span class="kw">pnorm</span>(u_val,<span class="dt">lower.tail =</span> F)<span class="op">*</span><span class="dv">2</span></span>
<span id="cb63-9"><a href="第六章-计数资料的统计描述.html#cb63-9"></a>  <span class="kw">return</span>(p_val)</span>
<span id="cb63-10"><a href="第六章-计数资料的统计描述.html#cb63-10"></a>}</span>
<span id="cb63-11"><a href="第六章-计数资料的统计描述.html#cb63-11"></a></span>
<span id="cb63-12"><a href="第六章-计数资料的统计描述.html#cb63-12"></a><span class="kw">posi_comp_uAsym</span>(n,X,p0)</span>
<span id="cb63-13"><a href="第六章-计数资料的统计描述.html#cb63-13"></a><span class="co"># [1] 2.980768e-08</span></span></code></pre></div>
<p>根据计算结果，p值为2.980768e-08&lt;0.05，按照α=0.05的检验水准，拒绝原假设<span class="math inline">\(H_0\)</span>，接受<span class="math inline">\(H_1\)</span>。</p>
</div>
</div>
<div id="两样本均数的比较正态近似" class="section level4">
<h4><span class="header-section-number">6.2.2.3</span> 两样本均数的比较(正态近似)</h4>
<p>对服从 Poisson 分布的样本，其样本计数可看作是样本均数。两个样本均数的比较，目的在于推断两样
本所代表的两总体均数是否有差别。设两个样本计数分别为<span class="math inline">\(X_1\)</span>和<span class="math inline">\(X_2\)</span>，可利用正态近似法进行比较，有下面两种情况：</p>
<p><strong>两个样本的观察单位数相等，即<span class="math inline">\(n_1=n_2\)</span></strong>
当<span class="math inline">\(X_1+X_2≥20\)</span>时：
<span class="math display">\[u=\frac{X_1-X_2}{\sqrt{X_1+X_2}}\]</span>
当<span class="math inline">\(5＜X_1+X_2＜20\)</span>时：
<span class="math display">\[u=\frac{|X_1-X_2|-1}{\sqrt{X_1+X_2}}\]</span></p>
<p><strong>两个样本的观察单位数不相等，即<span class="math inline">\(n_1≠n_2\)</span></strong>：
当<span class="math inline">\(X_1+X_2≥20\)</span>时：
<span class="math display">\[u=\frac{\bar{X_1}-\bar{X_2}}{\sqrt{X_1/n_1^2+X_2/n_2^2}}\]</span>
当<span class="math inline">\(5＜X_1+X_2＜20\)</span>时：
<span class="math display">\[u=\frac{|\bar{X_1}-\bar{X_2}|-1}{\sqrt{X_1/n_1^2+X_2/n_2^2}}\]</span>
其中的<span class="math inline">\(\bar{X_1}\)</span>和{X_2}分别是<span class="math inline">\(X_1/n_1\)</span>和<span class="math inline">\(X_2/n_2\)</span>。</p>
<p>使用《医学统计学》中的 案例6-14，6-15的数据在R中进行两样本均数的比较的泊松分布-正态近似法分析测试。</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="第六章-计数资料的统计描述.html#cb64-1"></a>n1&lt;-<span class="dv">1</span></span>
<span id="cb64-2"><a href="第六章-计数资料的统计描述.html#cb64-2"></a>n2&lt;-<span class="dv">1</span></span>
<span id="cb64-3"><a href="第六章-计数资料的统计描述.html#cb64-3"></a>x1&lt;-<span class="dv">4</span></span>
<span id="cb64-4"><a href="第六章-计数资料的统计描述.html#cb64-4"></a>x2&lt;-<span class="dv">7</span></span>
<span id="cb64-5"><a href="第六章-计数资料的统计描述.html#cb64-5"></a></span>
<span id="cb64-6"><a href="第六章-计数资料的统计描述.html#cb64-6"></a>posi_twosamplecom_uAsym &lt;-<span class="cf">function</span>(n1,n2,x1,x2){</span>
<span id="cb64-7"><a href="第六章-计数资料的统计描述.html#cb64-7"></a>  u_val&lt;-<span class="ot">NULL</span></span>
<span id="cb64-8"><a href="第六章-计数资料的统计描述.html#cb64-8"></a>  <span class="cf">if</span>(n1<span class="op">==</span>n2){</span>
<span id="cb64-9"><a href="第六章-计数资料的统计描述.html#cb64-9"></a>    <span class="cf">if</span>((x1<span class="op">+</span>x2)<span class="op">&gt;=</span><span class="dv">20</span>)</span>
<span id="cb64-10"><a href="第六章-计数资料的统计描述.html#cb64-10"></a>      u_val&lt;-(x1<span class="op">-</span>x2)<span class="op">/</span><span class="kw">sqrt</span>(x1<span class="op">+</span>x2)</span>
<span id="cb64-11"><a href="第六章-计数资料的统计描述.html#cb64-11"></a>    <span class="cf">else</span> <span class="cf">if</span> (<span class="dv">5</span><span class="op">&lt;</span>(x1<span class="op">+</span>x2) <span class="op">&amp;&amp;</span><span class="st"> </span>(x1<span class="op">+</span>x2)<span class="op">&lt;</span><span class="dv">20</span>) </span>
<span id="cb64-12"><a href="第六章-计数资料的统计描述.html#cb64-12"></a>      u_val&lt;-(<span class="kw">abs</span>(x1<span class="op">-</span>x2)<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="kw">sqrt</span>(x1<span class="op">+</span>x2)</span>
<span id="cb64-13"><a href="第六章-计数资料的统计描述.html#cb64-13"></a>  }<span class="cf">else</span>{</span>
<span id="cb64-14"><a href="第六章-计数资料的统计描述.html#cb64-14"></a>    x1m&lt;-x1<span class="op">/</span>n1</span>
<span id="cb64-15"><a href="第六章-计数资料的统计描述.html#cb64-15"></a>    x2m&lt;-x2<span class="op">/</span>n2</span>
<span id="cb64-16"><a href="第六章-计数资料的统计描述.html#cb64-16"></a>     <span class="cf">if</span>((x1<span class="op">+</span>x2)<span class="op">&gt;=</span><span class="dv">20</span>)</span>
<span id="cb64-17"><a href="第六章-计数资料的统计描述.html#cb64-17"></a>      u_val&lt;-(x1m<span class="op">-</span>x2m)<span class="op">/</span><span class="kw">sqrt</span>(x1<span class="op">/</span>n1<span class="op">^</span><span class="dv">2</span><span class="op">+</span>x2<span class="op">/</span>n2<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb64-18"><a href="第六章-计数资料的统计描述.html#cb64-18"></a>    <span class="cf">else</span> <span class="cf">if</span> (<span class="dv">5</span><span class="op">&lt;</span>(x1<span class="op">+</span>x2) <span class="op">&amp;&amp;</span><span class="st"> </span>(x1<span class="op">+</span>x2)<span class="op">&lt;</span><span class="dv">20</span>) </span>
<span id="cb64-19"><a href="第六章-计数资料的统计描述.html#cb64-19"></a>      u_val&lt;-(<span class="kw">abs</span>(x1m<span class="op">-</span>x2m)<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="kw">sqrt</span>(x1<span class="op">/</span>n1<span class="op">^</span><span class="dv">2</span><span class="op">+</span>x2<span class="op">/</span>n2<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb64-20"><a href="第六章-计数资料的统计描述.html#cb64-20"></a>  }</span>
<span id="cb64-21"><a href="第六章-计数资料的统计描述.html#cb64-21"></a>  <span class="co">#print(u_val)</span></span>
<span id="cb64-22"><a href="第六章-计数资料的统计描述.html#cb64-22"></a>  <span class="kw">return</span>(<span class="kw">pnorm</span>(u_val,<span class="dt">lower.tail =</span> F)<span class="op">*</span><span class="dv">2</span>)</span>
<span id="cb64-23"><a href="第六章-计数资料的统计描述.html#cb64-23"></a>}</span>
<span id="cb64-24"><a href="第六章-计数资料的统计描述.html#cb64-24"></a><span class="co">#案例6-14</span></span>
<span id="cb64-25"><a href="第六章-计数资料的统计描述.html#cb64-25"></a><span class="kw">posi_twosamplecom_uAsym</span>(n1,n2,x1,x2)</span>
<span id="cb64-26"><a href="第六章-计数资料的统计描述.html#cb64-26"></a><span class="co"># [1] 0.5464936</span></span>
<span id="cb64-27"><a href="第六章-计数资料的统计描述.html#cb64-27"></a></span>
<span id="cb64-28"><a href="第六章-计数资料的统计描述.html#cb64-28"></a><span class="co">#案例6-15</span></span>
<span id="cb64-29"><a href="第六章-计数资料的统计描述.html#cb64-29"></a><span class="kw">posi_twosamplecom_uAsym</span>(<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">32</span>,<span class="dv">12</span>)</span>
<span id="cb64-30"><a href="第六章-计数资料的统计描述.html#cb64-30"></a><span class="co"># [1] 0.02845974</span></span></code></pre></div>
<p>根据计算结果，案例6-14的p值为0.5464936&gt;0.05，按照α=0.05的检验水准，不拒绝原假设<span class="math inline">\(H_0\)</span>。</p>
<p>根据计算结果，案例6-15的p值为0.02845974&lt;0.05，按照α=0.05的检验水准，拒绝原假设<span class="math inline">\(H_0\)</span>，接受<span class="math inline">\(H_1H_1\)</span>。</p>
</div>
</div>
</div>
<div id="负二项分布" class="section level2">
<h2><span class="header-section-number">6.3</span> 负二项分布</h2>
<p>负二项分布是统计学上一种描述在一系列独立同分布的伯努利试验中，
“成功”(或“失败”)次数到达指定次数（记为r）时“失败”(或“成功”)的次数(记为k)的离散概率分布。
根据参数r是否为整数，负二项分布有两种，当r为整数时，也称为帕斯卡分布(Pascal distribution)；
当r为延申到非整数时，也称为波利亚分布(Polya distribution)。
这里仅考虑r为整数时，也就是帕斯卡分布的情况，其定义有下面两种形式：</p>
<ol style="list-style-type: decimal">
<li>在一系列伯努利试验中，失败次数到达指定次数时，成功次数的离散概率分布</li>
<li>在一系列伯努利试验中，成功次数到达指定次数（指定值，记为r）时，失败次数（观察变量，记为k）的离散概率分布</li>
</ol>
<p>这两种定义只是将“成功”和“失败”对调，其本质上没差别。一般的，为方便与之前的分布概念保持一直，便于理解，
都采用第二种形式。记r是成功的次数，为固定值；k是失败的次数，为自变量；p是伯努利试验成功的概率，失败概率则为1-p；因此下面将以第二种形式为例。
其概率质量函数为：
<span class="math display">\[\begin{aligned}
f(k,r,p)=P(k,r,p)=p(x=k) &amp; = \binom{k+r-1}{r-1}p^r(1-p)^k\\
&amp; = \frac{(k+r-1)!}{k!(r-1)!}p^r(1-p)^k ,k=0,1,2,\dots\\
&amp; = (-1)^k\binom{-r}{k}p^r(1-p)^k
\end{aligned}\]</span>
该表达式可以写成带负值参数<span class="math inline">\((-1)^k\)</span>的二项系数的形式，解释了“负二项”名称的来源。</p>
<p><strong>注意</strong>
有些资料对负二项分布的定义可能与这里的资料略有不同。最常见的变化是随机变量X计算不同的东西。
这些变化可以在这里的<a href="https://en.wikipedia.org/wiki/Negative_binomial_distribution#Alternative_formulations">表格</a>中看到。</p>
<div id="负二项分布的性质" class="section level3">
<h3><span class="header-section-number">6.3.1</span> 负二项分布的性质</h3>
<div id="均数与标准差-2" class="section level4">
<h4><span class="header-section-number">6.3.1.1</span> 均数与标准差</h4>
<p>负二项分布的概率分布依赖参数p和r，其总体的均值和方差，标准差为：</p>
<p>X的总体均数：
<span class="math display">\[μ=r\frac{1-p}{p}\]</span>
X的方差：
<span class="math display">\[σ^2=r\frac{1-p}{p^2}=\frac{μ}{p}=μ+μ^2/r\]</span>
X的标准差：
<span class="math display">\[σ=\frac{\sqrt{r(1-p)}}{p}\]</span></p>
</div>
<div id="负二项分布的图像" class="section level4">
<h4><span class="header-section-number">6.3.1.2</span> 负二项分布的图像</h4>
<ol style="list-style-type: decimal">
<li>负二项分布的图像偏态主要由p和n决定：</li>
<li>负二项分布 与 二项分布 的区别在于：“二项分布”是固定试验总次数N的独立试验中，成功次数k的分布；而“负二项分布”是所有到r次成功时即终止的独立试验中，失败次数k的分布。</li>
<li>正态近似 如果n足够大，那么分布的偏度就比较小</li>
</ol>
</div>
<div id="与其他分布的关系-1" class="section level4">
<h4><span class="header-section-number">6.3.1.3</span> 与其他分布的关系</h4>
<ol style="list-style-type: decimal">
<li>负二项分布 与 二项分布 的区别在于：“二项分布”是固定试验总次数N的独立试验中，成功次数k的分布；而“负二项分布”是所有到r次成功时即终止的独立试验中，失败次数k的分布。</li>
<li>当r=1时，负二项分布退化为<a href="https://zh.wikipedia.org/zh-cn/%E5%B9%BE%E4%BD%95%E5%88%86%E4%BD%88">几何分布</a></li>
</ol>
</div>
</div>
<div id="负二项分布的参数估计" class="section level3">
<h3><span class="header-section-number">6.3.2</span> 负二项分布的参数估计</h3>
<p>负二项分布有两个参数即u和r。r值越大，分布的方差与均数的比值就越接近 1；
而r值越小，分布的方差与均数的比值就越大。为此，可以用r值的大小来衡量
分布的离散程度即聚集 趋向的程度，常称为聚集指数(Cluster index)。</p>
<p>负二项分布的参数一般可用样本均数<span class="math inline">\(\bar{k}\)</span>作为其估计值，即<span class="math inline">\(u=\bar{k}\)</span>，
但参数r的估计就复杂一些。关于r的估计方法常用的有矩法、零频数法和最大似然法等。</p>
<p><strong>矩法</strong>
用样本的均数<span class="math inline">\(\bar{k}\)</span>和方差<span class="math inline">\(S^2\)</span>分别作为负二项分布的均数μ和方差<span class="math inline">\(\sigma^2\)</span>的估计值，
可以利用公式：
<span class="math display">\[\bar{r}=\frac{\bar{k}^2}{S^2-\bar{k}}, \bar{k}=\sum{fk}/N, S^2=(\sum{fk^2}-(\sum{fk})^2/N)/(N-1)\]</span>
式子中的<span class="math inline">\(f\)</span>为样本观察到的“失败”数k所对应的频数，N为观察但总数。</p>
<p>使用《医学统计学》中的 案例6-16 的数据在R中进行矩法估计聚集指数r(Cluster index)分析测试。</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="第六章-计数资料的统计描述.html#cb65-1"></a>arr1&lt;-<span class="kw">array</span>(<span class="dt">dim=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">7</span>))</span>
<span id="cb65-2"><a href="第六章-计数资料的统计描述.html#cb65-2"></a>arr1[<span class="dv">1</span>,]&lt;-<span class="dv">0</span><span class="op">:</span><span class="dv">6</span></span>
<span id="cb65-3"><a href="第六章-计数资料的统计描述.html#cb65-3"></a>arr1[<span class="dv">2</span>,]&lt;-<span class="kw">c</span>(<span class="dv">30</span>,<span class="dv">14</span>,<span class="dv">8</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb65-4"><a href="第六章-计数资料的统计描述.html#cb65-4"></a></span>
<span id="cb65-5"><a href="第六章-计数资料的统计描述.html#cb65-5"></a>negbino_jufa_restim&lt;-<span class="cf">function</span>(k_val,freq){</span>
<span id="cb65-6"><a href="第六章-计数资料的统计描述.html#cb65-6"></a>  N&lt;-<span class="kw">sum</span>(freq)</span>
<span id="cb65-7"><a href="第六章-计数资料的统计描述.html#cb65-7"></a>  sum_fk&lt;-<span class="kw">sum</span>(k_val <span class="op">*</span><span class="st"> </span>freq)</span>
<span id="cb65-8"><a href="第六章-计数资料的统计描述.html#cb65-8"></a>  sum_fkk&lt;-<span class="kw">sum</span>(k_val<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>freq)</span>
<span id="cb65-9"><a href="第六章-计数资料的统计描述.html#cb65-9"></a>  mean_val&lt;-sum_fk<span class="op">/</span>N</span>
<span id="cb65-10"><a href="第六章-计数资料的统计描述.html#cb65-10"></a>  var_val&lt;-(sum_fkk<span class="op">-</span>sum_fk<span class="op">^</span><span class="dv">2</span><span class="op">/</span>N)<span class="op">/</span>(N<span class="dv">-1</span>)</span>
<span id="cb65-11"><a href="第六章-计数资料的统计描述.html#cb65-11"></a>  <span class="co">#print(paste(N, mean_val ,var_val, sep = &quot;   &quot;))</span></span>
<span id="cb65-12"><a href="第六章-计数资料的统计描述.html#cb65-12"></a>  r_estim&lt;-mean_val<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(var_val<span class="op">-</span>mean_val)</span>
<span id="cb65-13"><a href="第六章-计数资料的统计描述.html#cb65-13"></a>  <span class="kw">return</span>(r_estim)</span>
<span id="cb65-14"><a href="第六章-计数资料的统计描述.html#cb65-14"></a>}</span>
<span id="cb65-15"><a href="第六章-计数资料的统计描述.html#cb65-15"></a></span>
<span id="cb65-16"><a href="第六章-计数资料的统计描述.html#cb65-16"></a><span class="kw">negbino_jufa_restim</span>(arr1[<span class="dv">1</span>,],arr1[<span class="dv">2</span>,])</span>
<span id="cb65-17"><a href="第六章-计数资料的统计描述.html#cb65-17"></a><span class="co"># [1] 1.033333</span></span></code></pre></div>
<p><strong>零频数法</strong></p>
<p>零频法(Zero frequency method)是利用样本计数k=0时，所对应的频数<span class="math inline">\(f_0\)</span>占观察单位总数的比例，即
<span class="math inline">\(f_0/N\)</span>来估计r值，即求解满足下面的方程的r值：
<span class="math display">\[r\lg(1+\bar{k}/r)=\lg(N/f_0)\]</span>
<em>使用此方法要注意满足适当的条件。</em>
- <span class="math inline">\(\frac{f_0}{N}＞\frac{1}{3}\)</span>
- 当<span class="math inline">\(\bar{r}&lt;10\)</span>时，还必须有充分的<span class="math inline">\(f_0\)</span>项，以满足不等式：<span class="math inline">\((\bar{r}_0.17)(\frac{f_0}{N}-0.32)＞0.20\)</span>
- 往往需要使用线性内插法(Linear interpolation method)才能求得r的估计值。</p>
<p><strong>最大似然法</strong></p>
<p>最大似然法(Maximum likelihood method)是满足下面是指的z=0的r值：
<span class="math display">\[z=\sum_{k=0}^m\frac{A_k}{r+k}-N\ln(1+\bar{k}/r)\]</span>
公式中<span class="math inline">\(m=k_max\)</span>，即样本计数k所取得的最大值；<span class="math inline">\(A_k=\sum_{i=k+1}^mf_i\)</span>，即样本中所有计数发育k的频数之和。</p>
<p>需要使用线性内插法(Linear interpolation method)才能求得r的估计值，该方法的估计更为精确，但是计算很复杂。</p>
</div>
<div id="负二项分布的应用" class="section level3">
<h3><span class="header-section-number">6.3.3</span> 负二项分布的应用</h3>
<p>R语言中的二项分布相关的函数与之前介绍的连续性分布(u分布，t分布和f分布)类似，主要有
<a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/NegBinomial.html">dnbinom(),pnbinom(),qnbinom()和rnbinom()</a>。</p>
<div id="拟合优度检验" class="section level4">
<h4><span class="header-section-number">6.3.3.1</span> 拟合优度检验</h4>
<p>是通过理论频数和实际频数的比较，对样本分布拟合负二项分布的适合情况进行检验。类似二项分布。此方法需要先进行r值估计，然后计算出
不同样本频数的理论概率和理论频数，因此比较麻烦。目前在R语言中在那时没找到相应的包和函数可以比较好作者部分处理，后期看能否自己开发相应的工具代码吧。</p>
<p>具体案例和内容请先参考<b>《医学统计学》P92页</b>的内容。
<!--
```r 
arr1<-array(dim=c(3,7))
arr1[1,]<-0:6
arr1[2,]<-c(30,14,8,4,2,0,2)
k_val<-arr1[1,]
freq<-arr1[2,]
negbino_ml_restim<-function(k_val,freq){
  N<-sum(freq)
  p_vals<-freq/N
  freqsum_uder5<-sum(freq[which(freq<=5)])
  p_vals_frequder5<-sum(p_vals[which(freq<=5)])

  x<-c(freq[which(freq>5)],freqsum_uder5)
  p<-c(p_vals[which(freq>5)],p_vals_frequder5)
  chisq.test( x, p)

  sum_fk<-sum(k_val * freq)
  sum_fkk<-sum(k_val^2 * freq)
  mean_val<-sum_fk/N
  var_val<-(sum_fkk-sum_fk^2/N)/(N-1)
  #print(paste(N, mean_val ,var_val, sep = "   "))
  r_estim<-mean_val^2/(var_val-mean_val)
  return(r_estim)
}

negbino_ml_restim(arr1[1,],arr1[2,])
```
!--></p>
</div>
<div id="两样本均数比较" class="section level4">
<h4><span class="header-section-number">6.3.3.2</span> 两样本均数比较</h4>
<p>对服从负二项分布的两个样本均数的比较，以推断其所代表的两个总体有无差别。先将两个样本的原始观察数据按公式：
<span class="math display">\[Y_i=\ln(k_i+0.5r_c)\]</span>
进行转换，然后再对所得到两组转换数据做<a href="第三章-总体均数的估计与假设检验.html#单样本t检验"><em>T</em>检验</a>。公式中，<span class="math inline">\(k_i\)</span>为每一组独立试验的样本计数，
<span class="math inline">\(r_c\)</span>代表两样本的负二项分布的参数<span class="math inline">\(r_1\)</span>和<span class="math inline">\(r_2\)</span>的合并至，采用矩法估计的公式为：
<span class="math display">\[r_c=\frac{\bar{k1}^2(S_1^2-\bar{k1})+\bar{k2}^2(S_2^2-\bar{k2})}{(S_1^2-\bar{k1})^2+(S_2^2-\bar{k2})^2}\]</span>
公式中，<span class="math inline">\(\bar{k1}，S_1\)</span>分别是第一个样本计数的均数和方差；<span class="math inline">\(\bar{k2}，S_2\)</span>分别是第二个样本计数的均数和方差。</p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="第五章-计数资料的统计描述.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="第七章-chi2检验.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "Sepia",
"family": "serif",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/05-Discretedistribution.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"search": true,
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
