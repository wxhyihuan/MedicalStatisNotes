<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 第七章 \(\chi^2\)检验 | MedicalStatisNotes.utf8</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content=" 第七章 \(\chi^2\)检验 | MedicalStatisNotes.utf8" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 第七章 \(\chi^2\)检验 | MedicalStatisNotes.utf8" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="第六章-计数资料的统计描述.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://wxhyihuan.github.io/">医学统计学笔记与R语言</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> 简介与传送门</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#简介"><i class="fa fa-check"></i><b>1.1</b> 简介</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#软件准备"><i class="fa fa-check"></i><b>1.1.1</b> 软件准备</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#传送门"><i class="fa fa-check"></i><b>1.2</b> 传送门</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#致谢"><i class="fa fa-check"></i><b>1.3</b> 致谢</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#声明"><i class="fa fa-check"></i><b>1.4</b> 声明</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html"><i class="fa fa-check"></i><b>2</b> 第二章 计量资料的统计描述</a><ul>
<li class="chapter" data-level="2.1" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#描述统计"><i class="fa fa-check"></i><b>2.1</b> 描述统计</a></li>
<li class="chapter" data-level="2.2" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#测试数据"><i class="fa fa-check"></i><b>2.2</b> 测试数据</a></li>
<li class="chapter" data-level="2.3" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#数据输入和频率统计"><i class="fa fa-check"></i><b>2.3</b> 数据输入和频率统计</a><ul>
<li class="chapter" data-level="2.3.1" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#读取数据并将数据转换成单列形式"><i class="fa fa-check"></i><b>2.3.1</b> 读取数据，并将数据转换成单列形式</a></li>
<li class="chapter" data-level="2.3.2" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#计算极差-maxminrange"><i class="fa fa-check"></i><b>2.3.2</b> 计算极差, max()/min()/range()</a></li>
<li class="chapter" data-level="2.3.3" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#确定组段数和组距"><i class="fa fa-check"></i><b>2.3.3</b> 确定组段数和组距</a></li>
<li class="chapter" data-level="2.3.4" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#计算频数分布"><i class="fa fa-check"></i><b>2.3.4</b> 计算频数分布</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#描述性统计的度量"><i class="fa fa-check"></i><b>2.4</b> 描述性统计的度量</a><ul>
<li class="chapter" data-level="2.4.1" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#算术平均值"><i class="fa fa-check"></i><b>2.4.1</b> 算术平均值</a></li>
<li class="chapter" data-level="2.4.2" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#几何平均值"><i class="fa fa-check"></i><b>2.4.2</b> 几何平均值</a></li>
<li class="chapter" data-level="2.4.3" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#中位数与百分位数"><i class="fa fa-check"></i><b>2.4.3</b> 中位数与百分位数</a></li>
<li class="chapter" data-level="2.4.4" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#极差"><i class="fa fa-check"></i><b>2.4.4</b> 极差</a></li>
<li class="chapter" data-level="2.4.5" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#四分位间距"><i class="fa fa-check"></i><b>2.4.5</b> 四分位间距</a></li>
<li class="chapter" data-level="2.4.6" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#方差与标准差"><i class="fa fa-check"></i><b>2.4.6</b> 方差与标准差</a></li>
<li class="chapter" data-level="2.4.7" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#变异系数"><i class="fa fa-check"></i><b>2.4.7</b> 变异系数</a></li>
<li class="chapter" data-level="2.4.8" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#其他的描述统计"><i class="fa fa-check"></i><b>2.4.8</b> 其他的描述统计</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#正态分布和标准正态分布"><i class="fa fa-check"></i><b>2.5</b> 正态分布和标准正态分布</a><ul>
<li class="chapter" data-level="2.5.1" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#概率密度函数dnorm"><i class="fa fa-check"></i><b>2.5.1</b> 概率密度函数dnorm()</a></li>
<li class="chapter" data-level="2.5.2" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#概率累积分布函数pnorm"><i class="fa fa-check"></i><b>2.5.2</b> 概率累积分布函数pnorm()</a></li>
<li class="chapter" data-level="2.5.3" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#正态分位函数qnorm"><i class="fa fa-check"></i><b>2.5.3</b> 正态分位函数qnorm()</a></li>
<li class="chapter" data-level="2.5.4" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#生成正态分布函数rnorm"><i class="fa fa-check"></i><b>2.5.4</b> 生成正态分布函数rnorm()</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#正态分布检验"><i class="fa fa-check"></i><b>2.6</b> 正态分布检验</a><ul>
<li class="chapter" data-level="2.6.1" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#直方图"><i class="fa fa-check"></i><b>2.6.1</b> 直方图</a></li>
<li class="chapter" data-level="2.6.2" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#概率密度图"><i class="fa fa-check"></i><b>2.6.2</b> 概率密度图</a></li>
<li class="chapter" data-level="2.6.3" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#qq-plot"><i class="fa fa-check"></i><b>2.6.3</b> QQ-plot</a></li>
<li class="chapter" data-level="2.6.4" data-path="第二章-计量资料的统计描述.html"><a href="第二章-计量资料的统计描述.html#正态检验"><i class="fa fa-check"></i><b>2.6.4</b> 正态检验</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html"><i class="fa fa-check"></i><b>3</b> 第三章 总体均数的估计与假设检验</a><ul>
<li class="chapter" data-level="3.1" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#推论统计"><i class="fa fa-check"></i><b>3.1</b> 推论统计</a><ul>
<li class="chapter" data-level="3.1.1" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#参数估计与假设检验"><i class="fa fa-check"></i><b>3.1.1</b> 参数估计与假设检验</a></li>
<li class="chapter" data-level="3.1.2" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#统计量与标准误"><i class="fa fa-check"></i><b>3.1.2</b> 统计量与标准误</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#t-分布"><i class="fa fa-check"></i><b>3.2</b> <em>t</em> 分布</a><ul>
<li class="chapter" data-level="3.2.1" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#概率密度函数dt"><i class="fa fa-check"></i><b>3.2.1</b> 概率密度函数dt()</a></li>
<li class="chapter" data-level="3.2.2" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#概率累积分布函数pt"><i class="fa fa-check"></i><b>3.2.2</b> 概率累积分布函数pt()</a></li>
<li class="chapter" data-level="3.2.3" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#求置信区间的qt"><i class="fa fa-check"></i><b>3.2.3</b> 求置信区间的qt()</a></li>
<li class="chapter" data-level="3.2.4" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#指定t分布函数rt"><i class="fa fa-check"></i><b>3.2.4</b> 指定t分布函数rt()</a></li>
<li class="chapter" data-level="3.2.5" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#参数估计"><i class="fa fa-check"></i><b>3.2.5</b> 参数估计</a></li>
<li class="chapter" data-level="3.2.6" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#假设检验"><i class="fa fa-check"></i><b>3.2.6</b> 假设检验</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#t-检验的分类及应用"><i class="fa fa-check"></i><b>3.3</b> <em>t</em> 检验的分类及应用</a><ul>
<li class="chapter" data-level="3.3.1" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#t检验与z检验"><i class="fa fa-check"></i><b>3.3.1</b> <em>t</em>检验与Z检验</a></li>
<li class="chapter" data-level="3.3.2" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#单样本t检验"><i class="fa fa-check"></i><b>3.3.2</b> 单样本<em>t</em>检验</a></li>
<li class="chapter" data-level="3.3.3" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#配对样本t检验"><i class="fa fa-check"></i><b>3.3.3</b> 配对样本<em>t</em>检验</a></li>
<li class="chapter" data-level="3.3.4" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#两种独立样本t检验"><i class="fa fa-check"></i><b>3.3.4</b> 两种独立样本t检验</a></li>
<li class="chapter" data-level="3.3.5" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#两样本方差齐性检验"><i class="fa fa-check"></i><b>3.3.5</b> 两样本方差齐性检验</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#变量转换"><i class="fa fa-check"></i><b>3.4</b> 变量转换</a><ul>
<li class="chapter" data-level="3.4.1" data-path="第三章-总体均数的估计与假设检验.html"><a href="第三章-总体均数的估计与假设检验.html#对数变换"><i class="fa fa-check"></i><b>3.4.1</b> 对数变换</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html"><i class="fa fa-check"></i><b>4</b> 第四章 多个样本均数比较的方差分析</a><ul>
<li class="chapter" data-level="4.1" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#f分布"><i class="fa fa-check"></i><b>4.1</b> <em>F</em>分布</a></li>
<li class="chapter" data-level="4.2" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#f检验的分类原理及应用"><i class="fa fa-check"></i><b>4.2</b> <em>F</em>检验的分类、原理及应用</a><ul>
<li class="chapter" data-level="4.2.1" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#分类"><i class="fa fa-check"></i><b>4.2.1</b> 分类</a></li>
<li class="chapter" data-level="4.2.2" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#原理"><i class="fa fa-check"></i><b>4.2.2</b> 原理</a></li>
<li class="chapter" data-level="4.2.3" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#单因子方差分析"><i class="fa fa-check"></i><b>4.2.3</b> 单因子方差分析</a></li>
<li class="chapter" data-level="4.2.4" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#双因子方差分析"><i class="fa fa-check"></i><b>4.2.4</b> 双因子方差分析</a></li>
<li class="chapter" data-level="4.2.5" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#拉丁方设计资料的方差分析"><i class="fa fa-check"></i><b>4.2.5</b> 拉丁方设计资料的方差分析</a></li>
<li class="chapter" data-level="4.2.6" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#两阶段交叉设计资料的方差分析"><i class="fa fa-check"></i><b>4.2.6</b> 两阶段交叉设计资料的方差分析</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#方差分析的诊断图"><i class="fa fa-check"></i><b>4.3</b> 方差分析的诊断图</a></li>
<li class="chapter" data-level="4.4" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#多个样本均数间的多重比较"><i class="fa fa-check"></i><b>4.4</b> 多个样本均数间的多重比较</a></li>
<li class="chapter" data-level="4.5" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#多样本方差齐性检验"><i class="fa fa-check"></i><b>4.5</b> 多样本方差齐性检验</a><ul>
<li class="chapter" data-level="4.5.1" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#bartletts-检验"><i class="fa fa-check"></i><b>4.5.1</b> Bartlett’s 检验</a></li>
<li class="chapter" data-level="4.5.2" data-path="第四章-多个样本均数比较的方差分析.html"><a href="第四章-多个样本均数比较的方差分析.html#levenes-检验"><i class="fa fa-check"></i><b>4.5.2</b> Levene’s 检验</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html"><i class="fa fa-check"></i><b>5</b> 第五章 计数资料的统计描述</a><ul>
<li class="chapter" data-level="5.1" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#常用相对数"><i class="fa fa-check"></i><b>5.1</b> 常用相对数</a><ul>
<li class="chapter" data-level="5.1.1" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#强度相对数"><i class="fa fa-check"></i><b>5.1.1</b> 强度相对数</a></li>
<li class="chapter" data-level="5.1.2" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#结构相对数"><i class="fa fa-check"></i><b>5.1.2</b> 结构相对数</a></li>
<li class="chapter" data-level="5.1.3" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#相对比"><i class="fa fa-check"></i><b>5.1.3</b> 相对比</a></li>
<li class="chapter" data-level="5.1.4" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#应用相对数的注意点"><i class="fa fa-check"></i><b>5.1.4</b> 应用相对数的注意点</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#率的标准化"><i class="fa fa-check"></i><b>5.2</b> 率的标准化</a><ul>
<li class="chapter" data-level="5.2.1" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#标准化率的计算"><i class="fa fa-check"></i><b>5.2.1</b> 标准化率的计算</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#动态数列及其指标分析"><i class="fa fa-check"></i><b>5.3</b> 动态数列及其指标分析</a><ul>
<li class="chapter" data-level="5.3.1" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#绝对增长量"><i class="fa fa-check"></i><b>5.3.1</b> 绝对增长量</a></li>
<li class="chapter" data-level="5.3.2" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#发展速度与增长速度"><i class="fa fa-check"></i><b>5.3.2</b> 发展速度与增长速度</a></li>
<li class="chapter" data-level="5.3.3" data-path="第五章-计数资料的统计描述.html"><a href="第五章-计数资料的统计描述.html#平均发展速度与平均增长速度"><i class="fa fa-check"></i><b>5.3.3</b> 平均发展速度与平均增长速度</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html"><i class="fa fa-check"></i><b>6</b> 第六章 计数资料的统计描述</a><ul>
<li class="chapter" data-level="6.1" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#二项分布"><i class="fa fa-check"></i><b>6.1</b> 二项分布</a><ul>
<li class="chapter" data-level="6.1.1" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#二项分布的性质"><i class="fa fa-check"></i><b>6.1.1</b> 二项分布的性质</a></li>
<li class="chapter" data-level="6.1.2" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#二项分布的应用"><i class="fa fa-check"></i><b>6.1.2</b> 二项分布的应用</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#泊松分布"><i class="fa fa-check"></i><b>6.2</b> 泊松分布</a><ul>
<li class="chapter" data-level="6.2.1" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#泊松分布的性质"><i class="fa fa-check"></i><b>6.2.1</b> 泊松分布的性质</a></li>
<li class="chapter" data-level="6.2.2" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#泊松分布的应用"><i class="fa fa-check"></i><b>6.2.2</b> 泊松分布的应用</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#负二项分布"><i class="fa fa-check"></i><b>6.3</b> 负二项分布</a><ul>
<li class="chapter" data-level="6.3.1" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#负二项分布的性质"><i class="fa fa-check"></i><b>6.3.1</b> 负二项分布的性质</a></li>
<li class="chapter" data-level="6.3.2" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#负二项分布的参数估计"><i class="fa fa-check"></i><b>6.3.2</b> 负二项分布的参数估计</a></li>
<li class="chapter" data-level="6.3.3" data-path="第六章-计数资料的统计描述.html"><a href="第六章-计数资料的统计描述.html#负二项分布的应用"><i class="fa fa-check"></i><b>6.3.3</b> 负二项分布的应用</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html"><i class="fa fa-check"></i><b>7</b> 第七章 <span class="math inline">\(\chi^2\)</span>检验</a><ul>
<li class="chapter" data-level="7.1" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#卡方分布"><i class="fa fa-check"></i><b>7.1</b> 卡方分布</a><ul>
<li class="chapter" data-level="7.1.1" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#概率密度函数"><i class="fa fa-check"></i><b>7.1.1</b> 概率密度函数</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#卡方检验"><i class="fa fa-check"></i><b>7.2</b> 卡方检验</a><ul>
<li class="chapter" data-level="7.2.1" data-path="第七章-chi2检验.html"><a href="第七章-chi2检验.html#卡方检验的基本思想"><i class="fa fa-check"></i><b>7.2.1</b> 卡方检验的基本思想</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="第七章-chi2检验" class="section level1">
<h1><span class="header-section-number"></span> 第七章 <span class="math inline">\(\chi^2\)</span>检验</h1>
<p>日期: 2020-11-28
作者：wxhyihuan</p>
<p>在十九世纪，统计分析方法主要被用于生物数据分析。当时主流意见认为正态分布普遍适用于此类数据，例如乔治·比德尔·艾里以及梅里曼教授，
而卡尔·皮尔森在他1900年的论文中就针对了他们的研究数据作出了指正。</p>
<p>直到十九世纪末期，皮尔森指出了部分数据具有明显的偏态，正态分布并不是普遍适用。为了更好地对这些观察数据进行建模，皮尔森在1893年
至1916年发表的系列文章中提出了一个包含正态分布以及众多偏态分布的连续概率分布族——皮尔森分布族。同时，他指出数据统计分析的步
骤应该是在从皮尔森分布族中选取合适的分布来进行建模后，使用拟合优度检验技术来评价模型和实验数据
间的<a href="https://en.wikipedia.org/wiki/Goodness_of_fit">拟合优度(Goodness of fit)</a>。</p>
<p>两个样本率的比较可用前章介绍的<a href="#两样本率的比较(正态近似)">u检验</a>，但实际工作中往往更多地应
用<a href="https://zh.wikipedia.org/wiki/%E5%8D%A1%E6%96%B9%E6%A3%80%E9%AA%8C">卡方检验(Chi-square test)</a>。
检验是以<a href="https://zh.wikipedia.org/wiki/%E5%8D%A1%E6%96%B9%E5%88%86%E4%BD%88">卡方分布</a>为理论依据，用途颇广的
假设检验方法。它在计数资料中的应用主要包括推断两个总体率或构成比之间有无差别、多个总体率或构成比之间有无差别、
多个样本率间的多重比较、两个分类变量之间有无关联性、多维列联表的分析和频数分布拟合优度的检验。</p>
<div id="卡方分布" class="section level2">
<h2><span class="header-section-number">7.1</span> 卡方分布</h2>
<p>若n个相互独立的随机变量Z₁，Z₂，…,Zv ，均服从标准正态分布，则这n个服从标准正态分布的随机变量的平方和
构成一新的随机变量X，其分布规律称为卡方分布(Chi-square distribution)，记作:
<span class="math display">\[X=\sum_{i=1}^vZ_i^2\]</span>
对应卡方分布被称为服从自由度为n的卡方分布，记作：<span class="math inline">\(X \sim X^2(v)\)</span>。</p>
<p>卡方分布(Chi-square distribution)是一种连续型分布，它只有一个参数，即自由度v。按卡方分布的密度函数f(X)可给出自由度v= 1， 2，3，…的族/分布曲线，
且分布的形状依赖于自由度v的大小：</p>
<ol style="list-style-type: decimal">
<li>当自由度v≤2 时，曲线呈L形；</li>
<li>随着v的增加，曲线逐渐趋于对称；</li>
<li>当自由度V趋近无穷时，卡方分布趋近正态分布。</li>
</ol>
<div class="figure" style="text-align: center"><span id="fig:chisquaredfig"></span>
<img src="MedicalStatisNotes_files/figure-html/chisquaredfig-1.png" alt="不同自由度情况下的卡方分布概率密度曲线图" width="55%" />
<p class="caption">
Figure 7.1: 不同自由度情况下的卡方分布概率密度曲线图
</p>
</div>
<div id="概率密度函数" class="section level3">
<h3><span class="header-section-number">7.1.1</span> 概率密度函数</h3>
<p>卡方分布的概率密度函数为：
<span class="math display">\[f(x,v)=\frac{x^{v/2-1}e^{-x/2}}{2^{v/2}\Gamma(v/2)}\]</span>
注意的是，当x≤0时，<span class="math inline">\(f(x,v)=0\)</span>；<span class="math inline">\(\Gamma\)</span>代表Gamma函数，因此卡方分布也是一种特别的Gamma函数。</p>
<p>卡方分布的均值和方差分别为v，和2v，及自由度和自由度的2倍。</p>
<p>卡方分布的一个基本性质就是可加性，即独立卡方变量之和同样服从卡方分布。如两个独立的卡方分布，<span class="math inline">\(X_1 \sim X^2(v_1)\)</span>与<span class="math inline">\(X_2 \sim X^2(v_2)\)</span>，那么有
<span class="math inline">\((X_1+X_2) \sim X^2(v_1+v_2)\)</span></p>
<p>在R语言中。卡方分布也有几个与Z分布，t分布基本函数类似的工具函数，分别是<a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/Chisquare">dchisq()，pchisq()，qchisq()和rchisq()</a>，
对应的检验函数主要是<a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/chisq.test">chisq.test()</a>。</p>
</div>
</div>
<div id="卡方检验" class="section level2">
<h2><span class="header-section-number">7.2</span> 卡方检验</h2>
<p>卡方检验(Chi-Squared Test)是一种统计量的分布在零假设成立时近似服从卡方分布的假设检验。在没有其他的限定条件或说明时，
卡方检验一般指代的是<strong>皮尔森卡方检验</strong>。在卡方检验的一般运用中，研究人员将观察量的值划分成若干互斥的分类，
且使用一套理论（或零假设）尝试去说明观察量的值落入不同分类的概率分布的模型。
而卡方检验的目的就在于去衡量这个假设对观察结果所反映的程度。卡方检验就是统计样本的实际观测值与理论推断值之间的偏离程度，
实际观测值与理论推断值之间的偏离程度就决定卡方值的大小，如果卡方值越大，二者偏差程度越大；
反之，二者偏差越小；若两个值完全相等时，卡方值就为0，表明理论值完全符合。</p>
<!--
卡方检验属于非参数检验，由于非参检验不存在具体参数和总体正态分布的假设，所以也被称为自由分布检验。
参数和非参数检验最明显的区别是它们使用数据的类型。
非参检验通常将被试分类，如民主党和共和党，这些分类涉及名义量表或顺序量表，无法计算平均数和方差。
!-->
<p>卡方检验分为<strong>拟合度的卡方检验</strong>和<strong>卡方独立性检验</strong>。</p>
<div id="卡方检验的基本思想" class="section level3">
<h3><span class="header-section-number">7.2.1</span> 卡方检验的基本思想</h3>
<div id="四格资料表的卡方检验" class="section level4">
<h4><span class="header-section-number">7.2.1.1</span> 四格资料表的卡方检验</h4>
<p>这里使用《医学统计学》中的 案例07-01 的数据，即两样本率比较的<span class="math inline">\(\chi^2\)</span>检验为例，
介绍<span class="math inline">\(\chi^2\)</span>检验的基本思想。</p>
<table style='width:70%; font-family: "Arial Narrow", "Source Sans Pro", sans-serif; margin-left: auto; margin-right: auto;' class=" lightable-classic">
<caption>
<span id="tab:chisqtab">Table 7.1: </span>案例07-01 四格资料表
</caption>
<thead>
<tr>
<th style="text-align:center;">
组别
</th>
<th style="text-align:center;">
有效
</th>
<th style="text-align:center;">
无效
</th>
<th style="text-align:center;">
合计
</th>
<th style="text-align:center;">
有效率%
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
试验组
</td>
<td style="text-align:center;">
99(90.48)a
</td>
<td style="text-align:center;">
5(13.52)b
</td>
<td style="text-align:center;">
104(a+b)
</td>
<td style="text-align:center;">
95.20(a/(a+b))
</td>
</tr>
<tr>
<td style="text-align:center;">
对照组
</td>
<td style="text-align:center;">
75(83.52)c
</td>
<td style="text-align:center;">
21(12.48)d
</td>
<td style="text-align:center;">
96(c+d)
</td>
<td style="text-align:center;">
78.13(c/(c+d)))
</td>
</tr>
<tr>
<td style="text-align:center;">
合计
</td>
<td style="text-align:center;">
174(a+c)
</td>
<td style="text-align:center;">
26(b+d)
</td>
<td style="text-align:center;">
200(n)
</td>
<td style="text-align:center;">
87.00((a+c)/n)
</td>
</tr>
</tbody>
</table>
<p>案例07-01 的四格资料表有a=99，b=5，c=75和d=21四个基本数据，其余数据都是根据它们计算出来的。现在想知道处理组与对照组两组样本代表总体有无差别，
即为两样本率比较的资料，既可以使用二项分布里面的<a href="#两样本率的比较(正态近似)"><strong>u检验</strong></a>，也可以利用卡方检验。
我们设计的原假设<span class="math inline">\(H_0:\)</span> 处理组与对照组是来自同一总体，即<span class="math inline">\(P_{treatment}=P_{control}\)</span>。</p>
<p><strong>u检验方法</strong></p>
<p>下面是用u检验的代码，根据计算结果，P值=0.0003362066&lt;0.01&lt;0.05，所以根据u检验结果，表明拒绝<span class="math inline">\(H_0\)</span>，接受备择假设<span class="math inline">\(H_1\)</span>，
即可以认为两种处理有显著性差异。</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="第七章-chi2检验.html#cb66-1"></a>n5&lt;-<span class="dv">104</span></span>
<span id="cb66-2"><a href="第七章-chi2检验.html#cb66-2"></a>n6&lt;-<span class="dv">96</span></span>
<span id="cb66-3"><a href="第七章-chi2检验.html#cb66-3"></a>x5&lt;-<span class="dv">99</span></span>
<span id="cb66-4"><a href="第七章-chi2检验.html#cb66-4"></a>x6&lt;-<span class="dv">75</span></span>
<span id="cb66-5"><a href="第七章-chi2检验.html#cb66-5"></a><span class="kw">binom_twosamplecomp_uAsym</span>(n5,x5,n6,x6)</span>
<span id="cb66-6"><a href="第七章-chi2检验.html#cb66-6"></a><span class="co"># [1] 0.0006442179</span></span>
<span id="cb66-7"><a href="第七章-chi2检验.html#cb66-7"></a>binom_twosamplecomp_uAsym&lt;-<span class="cf">function</span>(n1,x1,n2,x2){</span>
<span id="cb66-8"><a href="第七章-chi2检验.html#cb66-8"></a>     p1&lt;-x1<span class="op">/</span>n1</span>
<span id="cb66-9"><a href="第七章-chi2检验.html#cb66-9"></a>     p2&lt;-x2<span class="op">/</span>n2</span>
<span id="cb66-10"><a href="第七章-chi2检验.html#cb66-10"></a>     S_val&lt;-<span class="kw">sqrt</span>((x1<span class="op">+</span>x2)<span class="op">/</span>(n1<span class="op">+</span>n2)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>(x1<span class="op">+</span>x2)<span class="op">/</span>(n1<span class="op">+</span>n2))<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>n1<span class="op">+</span><span class="dv">1</span><span class="op">/</span>n2))</span>
<span id="cb66-11"><a href="第七章-chi2检验.html#cb66-11"></a>     p_val&lt;-<span class="kw">pnorm</span>((p1<span class="op">-</span>p2)<span class="op">/</span>S_val,<span class="dt">lower.tail =</span> F)<span class="op">*</span><span class="dv">2</span></span>
<span id="cb66-12"><a href="第七章-chi2检验.html#cb66-12"></a>     <span class="kw">return</span>( p_val)</span>
<span id="cb66-13"><a href="第七章-chi2检验.html#cb66-13"></a>}</span></code></pre></div>
<p><strong>卡方检验方法</strong></p>
<p>卡方检验设计的原假设用u检验的一样，即<span class="math inline">\(H_0:\)</span> 处理组与对照组是来自同一总体，<span class="math inline">\(P_{treatment}=P_{control}\)</span>。</p>
<p>卡方检验的统计量计算的是<span class="math inline">\(\chi^2\)</span>，其计算公式和对应的卡方分布自由度计算方法为：
<span class="math display">\[\chi^2=\sum{\frac{(A-T)^2}{T}} \\
v=(行数-1)(列数-1)\]</span>
此公式也叫做皮尔森卡方检验(Pearson <span class="math inline">\(\chi^2\)</span>)，其中的A代表实际观察频数(Actual frequency)，
即上面表格中的abcd四个值；T代表的<span class="math inline">\(H_0\)</span>成立时的理论频数(Theoretical frequency)，即假设处理组和对照组是来自同一总体，
且总体的有效率的P值根据观察值计算得到为<span class="math inline">\(p_0=174/200=87%\)</span>和<span class="math inline">\(q=1-p_0\)</span>，然后用p，q与处理组和对照组的样本数
分别计算有效，无效的理论频数，计算公式可以换算为：
<span class="math display">\[T_{rc}=\frac{n_r*n_c}{n}\]</span>
其中，<span class="math inline">\(T_{rc}\)</span>为第r行第c列的理论频数，<span class="math inline">\(n_{r}\)</span>和<span class="math inline">\(n_{c}\)</span>分别是相应第r行的合计样本数，
和第c列的合计样本数；n为的行列的总样本数。</p>
<p>对于四格表资料的<span class="math inline">\(\chi^2\)</span>检验的卡方值，也可以使用下面专用公式计算：
<span class="math display">\[\chi^2=\frac{(ad-bc)^2n}{(a+b)(c+d)(a+c)(b+d)}\]</span></p>
<p>下面是采用卡方检验的代码，根据计算结果，P值=0.0003362066&lt;0.01&lt;0.05， 表明拒绝<span class="math inline">\(H_0\)</span>，接受备择假设<span class="math inline">\(H_1\)</span>，
即可以认为两种处理有显著性差异，同u检验的结论一致。</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="第七章-chi2检验.html#cb67-1"></a>a&lt;-<span class="dv">99</span></span>
<span id="cb67-2"><a href="第七章-chi2检验.html#cb67-2"></a>b&lt;-<span class="dv">5</span></span>
<span id="cb67-3"><a href="第七章-chi2检验.html#cb67-3"></a>c&lt;-<span class="dv">75</span></span>
<span id="cb67-4"><a href="第七章-chi2检验.html#cb67-4"></a>d&lt;-<span class="dv">21</span></span>
<span id="cb67-5"><a href="第七章-chi2检验.html#cb67-5"></a></span>
<span id="cb67-6"><a href="第七章-chi2检验.html#cb67-6"></a>actual_matrix &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> <span class="kw">c</span>(a,b,c,d), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">2</span>,<span class="dt">byrow =</span> T)</span>
<span id="cb67-7"><a href="第七章-chi2检验.html#cb67-7"></a></span>
<span id="cb67-8"><a href="第七章-chi2检验.html#cb67-8"></a>chisquare_fourfoldtable_test&lt;-<span class="cf">function</span>(actual_matrix){</span>
<span id="cb67-9"><a href="第七章-chi2检验.html#cb67-9"></a>     n&lt;-<span class="kw">sum</span>(actual_matrix)</span>
<span id="cb67-10"><a href="第七章-chi2检验.html#cb67-10"></a>     df&lt;-(<span class="kw">dim</span>(actual_matrix)[<span class="dv">1</span>]<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="kw">dim</span>(actual_matrix)[<span class="dv">2</span>]<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb67-11"><a href="第七章-chi2检验.html#cb67-11"></a>     chi_val&lt;-<span class="dv">0</span></span>
<span id="cb67-12"><a href="第七章-chi2检验.html#cb67-12"></a>     newmatrix&lt;-<span class="kw">matrix</span>(<span class="dt">nrow =</span> <span class="kw">dim</span>(actual_matrix)[<span class="dv">1</span>],<span class="dt">ncol =</span> <span class="kw">dim</span>(actual_matrix)[<span class="dv">2</span>])</span>
<span id="cb67-13"><a href="第七章-chi2检验.html#cb67-13"></a>     <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(actual_matrix)[<span class="dv">1</span>]){</span>
<span id="cb67-14"><a href="第七章-chi2检验.html#cb67-14"></a>          <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(actual_matrix)[<span class="dv">2</span>]){</span>
<span id="cb67-15"><a href="第七章-chi2检验.html#cb67-15"></a>          newmatrix[i,j]=(<span class="kw">sum</span>(actual_matrix[i,])<span class="op">*</span><span class="kw">sum</span>(actual_matrix[,j]))<span class="op">/</span>n</span>
<span id="cb67-16"><a href="第七章-chi2检验.html#cb67-16"></a>          chi_val=chi_val<span class="op">+</span>(actual_matrix[i,j]<span class="op">-</span>newmatrix[i,j])<span class="op">^</span><span class="dv">2</span><span class="op">/</span>newmatrix[i,j]</span>
<span id="cb67-17"><a href="第七章-chi2检验.html#cb67-17"></a>          }</span>
<span id="cb67-18"><a href="第七章-chi2检验.html#cb67-18"></a>     }</span>
<span id="cb67-19"><a href="第七章-chi2检验.html#cb67-19"></a>     <span class="co">#print(chi_val)</span></span>
<span id="cb67-20"><a href="第七章-chi2检验.html#cb67-20"></a>     <span class="co"># [1] 12.85707</span></span>
<span id="cb67-21"><a href="第七章-chi2检验.html#cb67-21"></a>    p_val&lt;-<span class="kw">pchisq</span>(chi_val,df,,<span class="dt">lower.tail =</span> F)</span>
<span id="cb67-22"><a href="第七章-chi2检验.html#cb67-22"></a>     <span class="kw">return</span> (p_val)</span>
<span id="cb67-23"><a href="第七章-chi2检验.html#cb67-23"></a>}</span>
<span id="cb67-24"><a href="第七章-chi2检验.html#cb67-24"></a><span class="kw">chisquare_fourfoldtable_test</span>(actual_matrix)</span>
<span id="cb67-25"><a href="第七章-chi2检验.html#cb67-25"></a><span class="co"># [1] 0.0001796643</span></span>
<span id="cb67-26"><a href="第七章-chi2检验.html#cb67-26"></a></span>
<span id="cb67-27"><a href="第七章-chi2检验.html#cb67-27"></a><span class="co">###四格资料卡方检验的专用公式函数</span></span>
<span id="cb67-28"><a href="第七章-chi2检验.html#cb67-28"></a>chisquare_fourfoldtable_test1&lt;-<span class="cf">function</span>(actual_matrix){</span>
<span id="cb67-29"><a href="第七章-chi2检验.html#cb67-29"></a>     n&lt;-<span class="kw">sum</span>(actual_matrix)</span>
<span id="cb67-30"><a href="第七章-chi2检验.html#cb67-30"></a>     df&lt;-(<span class="kw">dim</span>(actual_matrix)[<span class="dv">1</span>]<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="kw">dim</span>(actual_matrix)[<span class="dv">2</span>]<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb67-31"><a href="第七章-chi2检验.html#cb67-31"></a>     chi_val&lt;-(actual_matrix[<span class="dv">1</span>,<span class="dv">1</span>]<span class="op">*</span>actual_matrix[<span class="dv">2</span>,<span class="dv">2</span>]<span class="op">-</span>actual_matrix[<span class="dv">1</span>,<span class="dv">2</span>]<span class="op">*</span>actual_matrix[<span class="dv">2</span>,<span class="dv">1</span>])<span class="op">^</span><span class="dv">2</span><span class="op">*</span>n<span class="op">/</span>((actual_matrix[<span class="dv">1</span>,<span class="dv">1</span>]<span class="op">+</span>actual_matrix[<span class="dv">1</span>,<span class="dv">2</span>])<span class="op">*</span>(actual_matrix[<span class="dv">2</span>,<span class="dv">1</span>]<span class="op">+</span>actual_matrix[<span class="dv">2</span>,<span class="dv">2</span>])<span class="op">*</span>(actual_matrix[<span class="dv">1</span>,<span class="dv">1</span>]<span class="op">+</span>actual_matrix[<span class="dv">2</span>,<span class="dv">1</span>])<span class="op">*</span>(actual_matrix[<span class="dv">1</span>,<span class="dv">2</span>]<span class="op">+</span>actual_matrix[<span class="dv">2</span>,<span class="dv">2</span>]))</span>
<span id="cb67-32"><a href="第七章-chi2检验.html#cb67-32"></a>     <span class="co">#print(chi_val)</span></span>
<span id="cb67-33"><a href="第七章-chi2检验.html#cb67-33"></a>     <span class="co"># [1] 12.85707</span></span>
<span id="cb67-34"><a href="第七章-chi2检验.html#cb67-34"></a>     p_val&lt;-<span class="kw">pchisq</span>(chi_val,df,,<span class="dt">lower.tail =</span> F)</span>
<span id="cb67-35"><a href="第七章-chi2检验.html#cb67-35"></a>     <span class="kw">return</span> (p_val)</span>
<span id="cb67-36"><a href="第七章-chi2检验.html#cb67-36"></a>}</span>
<span id="cb67-37"><a href="第七章-chi2检验.html#cb67-37"></a><span class="kw">chisquare_fourfoldtable_test1</span>(actual_matrix)</span></code></pre></div>
</div>
<div id="四格资料表的卡方检验的校正公式" class="section level4">
<h4><span class="header-section-number">7.2.1.2</span> 四格资料表的卡方检验的校正公式</h4>
<p>计数资料中的实际频数A为分类资料，是非连续的，由此使用卡方检验的统计量计算的<span class="math inline">\(\chi^2\)</span>值也是非连续的，
当自由度v特别小，尤其是四格表这样只有1的时候，计算出的卡方值会偏小，导致p值偏大，导致第一类错误的概率增大。
为此，美国统计学家F. Yates在1934年提出了一个计算卡方值的连续性校正公式：
<span class="math display">\[\chi^2=\sum\frac{(|A-T|-0.5)^2}{T}\]</span>
或者修正后的专用公式计算为：
<span class="math display">\[\chi^2=\frac{(|ad-bc|-n/2)^2n}{(a+b)(c+d)(a+c)(b+d)}\]</span></p>
<p>在实际工作中，对四格表资料使用卡方检验的规定是：</p>
<ol style="list-style-type: decimal">
<li>当n≥40且T≥5时，用<span class="math inline">\(\chi^2\)</span>检验的基本公式或专用公式计算；当P值≈α时，改用四格资料的卡方检验的<a href="#Fisher确切概率法">Fisher确切概率法</a>；</li>
<li>当n≥40且5&gt;T≥1时，用<span class="math inline">\(\chi^2\)</span>检验的校正公式或校正后的专用公式计算；或改用四格资料的卡方检验的<a href="#Fisher确切概率法">Fisher确切概率法</a>；</li>
<li>当n&lt;40或1&gt;T时，用卡方检验的<a href="#Fisher确切概率法">Fisher确切概率法</a>；</li>
</ol>
<p>使用《医学统计学》中的 案例07-02 的数据，即两样本率比较的<span class="math inline">\(\chi^2\)</span>检验为例，</p>
<table style='width:70%; font-family: "Arial Narrow", "Source Sans Pro", sans-serif; margin-left: auto; margin-right: auto;' class=" lightable-classic">
<caption>
<span id="tab:chisqtab1">Table 7.2: </span>案例07-02 四格资料表
</caption>
<thead>
<tr>
<th style="text-align:center;">
组别
</th>
<th style="text-align:center;">
有效
</th>
<th style="text-align:center;">
无效
</th>
<th style="text-align:center;">
合计
</th>
<th style="text-align:center;">
有效率%
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
胞磷胆碱组
</td>
<td style="text-align:center;">
46
</td>
<td style="text-align:center;">
18
</td>
<td style="text-align:center;">
64
</td>
<td style="text-align:center;">
88.46
</td>
</tr>
<tr>
<td style="text-align:center;">
神经节苷脂组
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
14
</td>
<td style="text-align:center;">
69.23
</td>
</tr>
<tr>
<td style="text-align:center;">
合计
</td>
<td style="text-align:center;">
52
</td>
<td style="text-align:center;">
26
</td>
<td style="text-align:center;">
78
</td>
<td style="text-align:center;">
82.05
</td>
</tr>
</tbody>
</table>
<p>在R总的实现代码可以参考下面，采用了经典的计算方法和校正后的计算方法做对比。经典的计算结果显示<span class="math inline">\(\chi^2\)</span>值为4.352679，
对应的P值为0.03695079&lt;0.05；校正后的计算结果显示<span class="math inline">\(\chi^2\)</span>值为3.1448，对应的P值为0.07616886&gt;0.05，两者结果相反。</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="第七章-chi2检验.html#cb68-1"></a>a&lt;-<span class="dv">46</span></span>
<span id="cb68-2"><a href="第七章-chi2检验.html#cb68-2"></a>b&lt;-<span class="dv">6</span></span>
<span id="cb68-3"><a href="第七章-chi2检验.html#cb68-3"></a>c&lt;-<span class="dv">18</span></span>
<span id="cb68-4"><a href="第七章-chi2检验.html#cb68-4"></a>d&lt;-<span class="dv">8</span></span>
<span id="cb68-5"><a href="第七章-chi2检验.html#cb68-5"></a></span>
<span id="cb68-6"><a href="第七章-chi2检验.html#cb68-6"></a>actual_matrix &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> <span class="kw">c</span>(a,b,c,d), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">2</span>,<span class="dt">byrow =</span> T)</span>
<span id="cb68-7"><a href="第七章-chi2检验.html#cb68-7"></a><span class="co">##print(&quot;校正后的卡方检验&quot;)</span></span>
<span id="cb68-8"><a href="第七章-chi2检验.html#cb68-8"></a><span class="kw">chisquare_fourfoldtable_test</span>(actual_matrix)</span>
<span id="cb68-9"><a href="第七章-chi2检验.html#cb68-9"></a><span class="co"># [1] 0.07616886</span></span>
<span id="cb68-10"><a href="第七章-chi2检验.html#cb68-10"></a></span>
<span id="cb68-11"><a href="第七章-chi2检验.html#cb68-11"></a><span class="co">##print(&quot;经典的卡方检验&quot;)</span></span>
<span id="cb68-12"><a href="第七章-chi2检验.html#cb68-12"></a><span class="kw">chisquare_fourfoldtable_classical</span>(actual_matrix)</span>
<span id="cb68-13"><a href="第七章-chi2检验.html#cb68-13"></a><span class="co"># [1] 4.352679</span></span>
<span id="cb68-14"><a href="第七章-chi2检验.html#cb68-14"></a><span class="kw">pchisq</span>(<span class="kw">chisquare_fourfoldtable_classical</span>(actual_matrix),<span class="dv">1</span>,<span class="dt">lower.tail =</span> F)</span>
<span id="cb68-15"><a href="第七章-chi2检验.html#cb68-15"></a><span class="co"># [1] 0.03695079</span></span>
<span id="cb68-16"><a href="第七章-chi2检验.html#cb68-16"></a></span>
<span id="cb68-17"><a href="第七章-chi2检验.html#cb68-17"></a>chisquare_fourfoldtable_test&lt;-<span class="cf">function</span>(actual_matrix){</span>
<span id="cb68-18"><a href="第七章-chi2检验.html#cb68-18"></a>     n&lt;-<span class="kw">sum</span>(actual_matrix)</span>
<span id="cb68-19"><a href="第七章-chi2检验.html#cb68-19"></a>     df&lt;-(<span class="kw">dim</span>(actual_matrix)[<span class="dv">1</span>]<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="kw">dim</span>(actual_matrix)[<span class="dv">2</span>]<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb68-20"><a href="第七章-chi2检验.html#cb68-20"></a>     chi_val&lt;-<span class="dv">0</span></span>
<span id="cb68-21"><a href="第七章-chi2检验.html#cb68-21"></a>     theoretical_matrix&lt;-<span class="kw">matrix</span>(<span class="dt">nrow =</span> <span class="kw">dim</span>(actual_matrix)[<span class="dv">1</span>],<span class="dt">ncol =</span> <span class="kw">dim</span>(actual_matrix)[<span class="dv">2</span>])</span>
<span id="cb68-22"><a href="第七章-chi2检验.html#cb68-22"></a>     <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(actual_matrix)[<span class="dv">1</span>]){</span>
<span id="cb68-23"><a href="第七章-chi2检验.html#cb68-23"></a>          <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(actual_matrix)[<span class="dv">2</span>]){</span>
<span id="cb68-24"><a href="第七章-chi2检验.html#cb68-24"></a>          theoretical_matrix[i,j]=(<span class="kw">sum</span>(actual_matrix[i,])<span class="op">*</span><span class="kw">sum</span>(actual_matrix[,j]))<span class="op">/</span>n</span>
<span id="cb68-25"><a href="第七章-chi2检验.html#cb68-25"></a>          <span class="co">#chi_val=chi_val+(actual_matrix[i,j]-theoretical_matrix[i,j])^2/newmatrix[i,j]</span></span>
<span id="cb68-26"><a href="第七章-chi2检验.html#cb68-26"></a>          }</span>
<span id="cb68-27"><a href="第七章-chi2检验.html#cb68-27"></a>     }</span>
<span id="cb68-28"><a href="第七章-chi2检验.html#cb68-28"></a>     <span class="cf">if</span>(<span class="kw">length</span>(<span class="kw">which</span>(theoretical_matrix<span class="op">&lt;</span><span class="dv">1</span>))<span class="op">&gt;=</span><span class="dv">1</span> <span class="op">||</span><span class="st"> </span>n<span class="op">&lt;</span><span class="dv">40</span>){</span>
<span id="cb68-29"><a href="第七章-chi2检验.html#cb68-29"></a>          <span class="kw">print</span>(<span class="st">&quot;Fisher 确切检验&quot;</span>)</span>
<span id="cb68-30"><a href="第七章-chi2检验.html#cb68-30"></a>          <span class="co">#chisquare_fourfoldtable_fisher()</span></span>
<span id="cb68-31"><a href="第七章-chi2检验.html#cb68-31"></a>     }<span class="cf">else</span> <span class="cf">if</span>(<span class="kw">length</span>(<span class="kw">which</span>(theoretical_matrix<span class="op">&lt;=</span><span class="dv">5</span>))<span class="op">&gt;=</span><span class="dv">1</span> <span class="op">&amp;&amp;</span><span class="st"> </span>n<span class="op">&gt;=</span><span class="dv">40</span>){</span>
<span id="cb68-32"><a href="第七章-chi2检验.html#cb68-32"></a>          <span class="kw">print</span>(<span class="st">&quot;校正后的卡方检验&quot;</span>)</span>
<span id="cb68-33"><a href="第七章-chi2检验.html#cb68-33"></a>          chi_val&lt;-chi_val<span class="op">+</span><span class="kw">chisquare_fourfoldtable_updated</span>(actual_matrix,n)</span>
<span id="cb68-34"><a href="第七章-chi2检验.html#cb68-34"></a>     }<span class="cf">else</span> <span class="cf">if</span>(<span class="kw">length</span>(<span class="kw">which</span>(theoretical_matrix<span class="op">&lt;</span><span class="dv">5</span>))<span class="op">==</span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span>n<span class="op">&gt;=</span><span class="dv">40</span>){</span>
<span id="cb68-35"><a href="第七章-chi2检验.html#cb68-35"></a>          <span class="kw">print</span>(<span class="st">&quot;经典的卡方检验&quot;</span>)</span>
<span id="cb68-36"><a href="第七章-chi2检验.html#cb68-36"></a>          chi_val&lt;-chi_val<span class="op">+</span><span class="kw">chisquare_fourfoldtable_classical</span>(actual_matrix,n)</span>
<span id="cb68-37"><a href="第七章-chi2检验.html#cb68-37"></a>     }</span>
<span id="cb68-38"><a href="第七章-chi2检验.html#cb68-38"></a>     p_val&lt;-<span class="kw">pchisq</span>(chi_val,df,<span class="dt">lower.tail=</span>F)</span>
<span id="cb68-39"><a href="第七章-chi2检验.html#cb68-39"></a>     <span class="kw">cat</span>(<span class="kw">paste</span>(<span class="st">&quot;chi_val&quot;</span>,chi_val,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">p_val&quot;</span>,p_val,<span class="dt">sep=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>))</span>
<span id="cb68-40"><a href="第七章-chi2检验.html#cb68-40"></a>     <span class="kw">return</span> (p_val)</span>
<span id="cb68-41"><a href="第七章-chi2检验.html#cb68-41"></a>}</span>
<span id="cb68-42"><a href="第七章-chi2检验.html#cb68-42"></a></span>
<span id="cb68-43"><a href="第七章-chi2检验.html#cb68-43"></a>chisquare_fourfoldtable_classical&lt;-<span class="cf">function</span>(actual_matrix,n){</span>
<span id="cb68-44"><a href="第七章-chi2检验.html#cb68-44"></a>     n&lt;-<span class="kw">sum</span>(actual_matrix)</span>
<span id="cb68-45"><a href="第七章-chi2检验.html#cb68-45"></a>     df&lt;-(<span class="kw">dim</span>(actual_matrix)[<span class="dv">1</span>]<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="kw">dim</span>(actual_matrix)[<span class="dv">2</span>]<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb68-46"><a href="第七章-chi2检验.html#cb68-46"></a>     chi_val&lt;-(actual_matrix[<span class="dv">1</span>,<span class="dv">1</span>]<span class="op">*</span>actual_matrix[<span class="dv">2</span>,<span class="dv">2</span>]<span class="op">-</span>actual_matrix[<span class="dv">1</span>,<span class="dv">2</span>]<span class="op">*</span>actual_matrix[<span class="dv">2</span>,<span class="dv">1</span>])<span class="op">^</span><span class="dv">2</span><span class="op">*</span>n<span class="op">/</span>((actual_matrix[<span class="dv">1</span>,<span class="dv">1</span>]<span class="op">+</span>actual_matrix[<span class="dv">1</span>,<span class="dv">2</span>])<span class="op">*</span>(actual_matrix[<span class="dv">2</span>,<span class="dv">1</span>]<span class="op">+</span>actual_matrix[<span class="dv">2</span>,<span class="dv">2</span>])<span class="op">*</span>(actual_matrix[<span class="dv">1</span>,<span class="dv">1</span>]<span class="op">+</span>actual_matrix[<span class="dv">2</span>,<span class="dv">1</span>])<span class="op">*</span>(actual_matrix[<span class="dv">1</span>,<span class="dv">2</span>]<span class="op">+</span>actual_matrix[<span class="dv">2</span>,<span class="dv">2</span>]))</span>
<span id="cb68-47"><a href="第七章-chi2检验.html#cb68-47"></a>     <span class="co">#p_val&lt;-dchisq(chi_val,df)</span></span>
<span id="cb68-48"><a href="第七章-chi2检验.html#cb68-48"></a>     <span class="kw">return</span> (chi_val)</span>
<span id="cb68-49"><a href="第七章-chi2检验.html#cb68-49"></a>}</span>
<span id="cb68-50"><a href="第七章-chi2检验.html#cb68-50"></a></span>
<span id="cb68-51"><a href="第七章-chi2检验.html#cb68-51"></a>chisquare_fourfoldtable_updated&lt;-<span class="cf">function</span>(actual_matrix,n){</span>
<span id="cb68-52"><a href="第七章-chi2检验.html#cb68-52"></a>     n&lt;-<span class="kw">sum</span>(actual_matrix)</span>
<span id="cb68-53"><a href="第七章-chi2检验.html#cb68-53"></a>     df&lt;-(<span class="kw">dim</span>(actual_matrix)[<span class="dv">1</span>]<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="kw">dim</span>(actual_matrix)[<span class="dv">2</span>]<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb68-54"><a href="第七章-chi2检验.html#cb68-54"></a>     chi_val&lt;-((<span class="kw">abs</span>((actual_matrix[<span class="dv">1</span>,<span class="dv">1</span>]<span class="op">*</span>actual_matrix[<span class="dv">2</span>,<span class="dv">2</span>]<span class="op">-</span>actual_matrix[<span class="dv">1</span>,<span class="dv">2</span>]<span class="op">*</span>actual_matrix[<span class="dv">2</span>,<span class="dv">1</span>]))<span class="op">-</span>n<span class="op">/</span><span class="dv">2</span>)<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>n<span class="op">/</span></span>
<span id="cb68-55"><a href="第七章-chi2检验.html#cb68-55"></a><span class="st">     </span>((actual_matrix[<span class="dv">1</span>,<span class="dv">1</span>]<span class="op">+</span>actual_matrix[<span class="dv">1</span>,<span class="dv">2</span>])<span class="op">*</span>(actual_matrix[<span class="dv">2</span>,<span class="dv">1</span>]<span class="op">+</span>actual_matrix[<span class="dv">2</span>,<span class="dv">2</span>])<span class="op">*</span>(actual_matrix[<span class="dv">1</span>,<span class="dv">1</span>]<span class="op">+</span>actual_matrix[<span class="dv">2</span>,<span class="dv">1</span>])<span class="op">*</span>(actual_matrix[<span class="dv">1</span>,<span class="dv">2</span>]<span class="op">+</span>actual_matrix[<span class="dv">2</span>,<span class="dv">2</span>]))</span>
<span id="cb68-56"><a href="第七章-chi2检验.html#cb68-56"></a>     <span class="co">#p_val&lt;-dchisq(chi_val,df)</span></span>
<span id="cb68-57"><a href="第七章-chi2检验.html#cb68-57"></a>     <span class="kw">return</span> (chi_val)</span>
<span id="cb68-58"><a href="第七章-chi2检验.html#cb68-58"></a>}</span></code></pre></div>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="第六章-计数资料的统计描述.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "Sepia",
"family": "serif",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/06-ChiSquaredistribution.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"search": true,
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
